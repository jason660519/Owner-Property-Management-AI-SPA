# 本案開發環境快速啟動指南

> **創建日期**: 2026-01-31  
> **創建者**: Project Team  
> **最後修改**: 2026-01-31  
> **修改者**: Project Team  
> **版本**: 1.0  
> **文件類型**: 開發指南

---


## 🚀 5 分鐘快速啟動

### 前置要求

- macOS 11+
- Docker Desktop
- Node.js 18+

### 快速步驟

```bash
# 1. 進入專案目錄
cd "/Volumes/KLEVV-4T-1/Real Estate Management Projects/Owner Property Management AI SPA"

# 2. 啟動 Docker Desktop（如未運行）
open -a Docker

# 3. 啟動本地 Supabase
supabase start

# 4. 安裝所有依賴 (Turborepo)
npm install

# 5. 同時啟動所有前端應用 (Web + Mobile)
npm run dev

# 6. 訪問服務
# 公司官網 (Next.js): http://localhost:3000
# 房東 App (Expo):   http://localhost:8081
```

## 📋 專案結構 (Monorepo)

```
├── apps/
│   ├── web/            # Next.js 15 公司官網 (產品介紹 + 登入入口)
│   └── mobile/         # Expo 54 房東管理 App
├── packages/           # 共用套件 (UI, Utils)
├── supabase/           # 本地資料庫配置
│   └── migrations/     # 資料庫遷移檔
├── docs/               # 專案文件與規劃
└── turbo.json          # Turborepo 配置
```

## 🌐 本地服務位址

### 前端應用 (需執行 `npm run dev` 啟動)

| 服務                  | 位址                  | 說明                              |
| :-------------------- | :-------------------- | :-------------------------------- |
| **公司官網 (Web)**    | http://localhost:3000 | 產品介紹 + 多用戶登入入口         |
| **房東 App (Mobile)** | http://localhost:8081 | 房東管理應用 (支援 Expo Go / Web) |

### Supabase 後端服務 (執行 `supabase start` 後自動運行)

| 服務                       | 位址                                | 說明                  |
| :------------------------- | :---------------------------------- | :-------------------- |
| **API Gateway**            | http://localhost:54321              | 統一 API 入口         |
| **REST API**               | http://localhost:54321/rest/v1      | RESTful API           |
| **GraphQL API**            | http://localhost:54321/graphql/v1   | GraphQL 查詢          |
| **Edge Functions**         | http://localhost:54321/functions/v1 | 伺服器端函數          |
| **MCP Server**             | http://localhost:54321/mcp          | Model Context Protocol|
| **Storage (S3)**           | http://localhost:54321/storage/v1/s3| 物件儲存服務          |
| **PostgreSQL Database**    | postgresql://127.0.0.1:54322        | 主資料庫              |
| **Supabase Studio**        | http://localhost:54323              | 資料庫管理後台        |
| **Mailpit (郵件測試)**     | http://localhost:54324              | 本地郵件測試工具      |

💡 **提示**: Supabase 相關服務啟動後即可直接訪問，無需額外配置。

## 📚 更多資訊

- **環境檢測報告**: [開發環境檢測報告_2026-01-31.md](./docs/開發環境檢測報告_2026-01-31.md) - 詳細的服務狀態與可訪問端點清單
- 部署與環境說明：[三階段部署說明](./docs/開發環境+測試環境+上線部署指南/三階段部署說明.md)
- 部署進度與檢查清單：[三階段進度檢測報告](./docs/開發環境+測試環境+上線部署指南/三階段進度檢測報告.md)
- 設計系統規範：[DESIGN.md](./docs/專案架構說明/DESIGN.md) - Figma 設計實作指南

## 💻 常用命令

```bash
# Supabase 服務管理
supabase start      # 啟動所有後端服務
supabase stop       # 停止所有後端服務
supabase status     # 查看服務狀態與訪問地址
supabase db reset   # 重置資料庫

# Monorepo 前端開發
npm run dev                 # 同時啟動所有前端應用 (Web + Mobile)
npm run dev --filter=web    # 僅啟動公司官網
npm run dev --filter=mobile # 僅啟動房東 App

# 開發環境檢測
supabase status             # 檢查後端服務狀態
lsof -iTCP -sTCP:LISTEN | grep -E ":(3000|8081)" # 檢查前端服務端口

# 測試與檢查
npm run test                # 執行測試
npm run lint                # 代碼檢查
npm run build               # 構建生產版本
```

## 🔧 故障排查

若遇到問題，請先依序確認：

1. Supabase 是否已成功啟動（`supabase status`）。
2. 是否已在根目錄執行 `npm install` 安裝所有依賴。
3. 若 Web 端啟動失敗，清除所有快取：
   ```bash
   cd apps/web && rm -rf .next node_modules/.cache
   ```
4. 若遇到「Failed to open database」或「invalid digit found in string」錯誤：
   - 停止所有進程：`pkill -f "turbo dev" && pkill -f "next dev"`
   - 清除快取後重新啟動
5. 若 Mobile 端啟動失敗，檢查 `apps/mobile/.env.local` 配置。
6. 若端口被佔用（3000, 8081），執行：
   ```bash
   lsof -ti:3000,8081 | xargs kill -9 2>/dev/null || true
   ```

仍無法排除時，請參考 [三階段進度檢測報告](./docs/開發環境+測試環境+上線部署指南/三階段進度檢測報告.md) 中的故障排查段落。

---

## ✅ 最新測試狀態（2026-01-31 更新）

### 開發環境服務狀態 (完整檢測報告見 [這裡](./docs/開發環境檢測報告_2026-01-31.md))

**整體狀態**: 🟡 部分運行 (9/11 服務可用，82%)

#### 前端應用 (需手動啟動)

| 項目              | 狀態       | 訪問地址                       |
| :---------------- | :--------- | :----------------------------- |
| 公司官網 (Web)    | ⚠️ 待啟動  | http://localhost:3000          |
| 房東 App (Mobile) | ⚠️ 待啟動  | http://localhost:8081          |

#### Supabase 後端服務 (已運行)

| 項目                     | 狀態    | 訪問地址                             |
| :----------------------- | :------ | :----------------------------------- |
| API Gateway              | ✅ 正常 | http://localhost:54321               |
| REST API                 | ✅ 正常 | http://localhost:54321/rest/v1       |
| GraphQL API              | ✅ 正常 | http://localhost:54321/graphql/v1    |
| Edge Functions           | ✅ 正常 | http://localhost:54321/functions/v1  |
| MCP Server               | ✅ 正常 | http://localhost:54321/mcp           |
| Storage (S3)             | ✅ 正常 | http://localhost:54321/storage/v1/s3 |
| PostgreSQL Database      | ✅ 正常 | postgresql://127.0.0.1:54322         |
| Supabase Studio (管理後台)| ✅ 正常 | http://localhost:54323               |
| Mailpit (郵件測試)       | ✅ 正常 | http://localhost:54324               |

### 資料庫現有表格

- ✅ `building_title_records` - 建物權狀記錄
- ✅ `land_title_records` - 土地權狀記錄
- ✅ `property_appointments` - 物件預約
- ✅ `property_photos` - 物件照片
- ✅ `clients` - 客戶資料
- ✅ `owner` - 房東資料

### 已測試功能

- ✅ Monorepo 架構遷移 (Turborepo)
- ✅ 雙端同時啟動 (Web + Mobile)
- ✅ Supabase 本地服務整合
- ✅ 首頁設計系統對齊 (Inter 字體、12px 圓角、1440px 最大寬度)
- ✅ 圖片最佳化配置 (WebP、遠程圖片支援)

---

**當前版本**：2.0.0 (Phase 1 - Monorepo Migration - Verified)

## 版本修訂記錄

- **2026-01-31**：完成開發環境服務全面檢測，建立詳細的服務清單與狀態報告。更新服務位址表格，新增 9 個 Supabase 後端服務端點說明。優化命令列表與故障排查指引。
- **2026-01-30 (晚間更新)**：完成首頁設計系統對齊修正，加入 Turbopack 快取清除故障排查步驟，驗證雙端服務穩定運行。更新圖片配置支援遠程圖片載入。將"租客網站"更名為"公司官網"以準確反映其作為產品介紹與多用戶登入入口的功能。
- **2026-01-30**：升級為 Monorepo 架構快速啟動指南，更新啟動指令 (Turborepo) 與專案結構說明，確認雙端服務同時運行正常。
- **2026-01-22**：完成前後端連線測試，更新為實際測試通過的啟動步驟與專案路徑，添加測試狀態記錄。
- **2026-01-17**：將文件定位為房東物件管理專案之本地開發快速啟動指南，統一為繁體中文說明，並修正部署相關文件連結與故障排查指引。
