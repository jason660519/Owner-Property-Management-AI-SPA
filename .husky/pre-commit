#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” åŸ·è¡Œ pre-commit æª¢æŸ¥..."

# 1. åŸ·è¡Œ lint-staged (ç¾æœ‰)
npx lint-staged --allow-empty 2>/dev/null || true

# 2. TypeScript å‹åˆ¥æª¢æŸ¥ (ç¾æœ‰)
if [ -f "tsconfig.json" ]; then
  echo "ğŸ”· æª¢æŸ¥ TypeScript å‹åˆ¥..."
  npx tsc --noEmit 2>/dev/null || true
fi

# 3. æª”æ¡ˆè¦ç¯„æª¢æŸ¥ (æ–°å¢)
echo "ğŸ“ æª¢æŸ¥æª”æ¡ˆè¦ç¯„..."
if [ -f "scripts/check-file-compliance.sh" ]; then
  if ! ./scripts/check-file-compliance.sh; then
    echo ""
    echo "âŒ æª”æ¡ˆè¦ç¯„æª¢æŸ¥å¤±æ•—ï¼è«‹ä¿®æ­£å¾Œé‡æ–°æäº¤ã€‚"
    exit 1
  fi
fi

echo "âœ… Pre-commit æª¢æŸ¥é€šéï¼"
