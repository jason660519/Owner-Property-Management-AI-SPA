import{r as h,j as e,bp as Y,a9 as ie,F as T,B as O,u as de,aI as hn,k as S,aU as vi,aE as G,L as pe,v as ae,aV as Ea,s as ee,aC as ge,w as ye,a4 as ne,at as _,a8 as Ze,ab as Ke,p as In,t as $t,al as Rn,I as se,ak as nt,i as Ve,as as wt,W as ki,o as fi,aO as bi,ar as yi,ae as He,ad as Vt,a3 as wa,ag as ct,aw as Ne,aa as Ni,b as Mn,b7 as ma,bj as Ra,bJ as Rt,af as La,aF as Si,P as xi,bo as Ti,S as Ii,R as tt,aJ as ji}from"./TownhouseColor--VjQBVqd.js";import{cC as qn,gi as Ci,l as Sn,aS as je,aR as dt,aQ as Yn,bJ as R,jK as _e,bk as Z,o as M,h as oe,n as K,c as en,aW as gn,k9 as Ai,lZ as Oi,jM as Kn,dw as bt,aP as _a,jz as Ba,hS as Fi,l_ as Ma,b_ as Pa,bn as Di,eB as Ua,bc as Ei,eA as wi,aK as Ri,cG as nn,cI as Li,cJ as at,aX as _i,e3 as $a,jL as Jt,l$ as Bi,cr as ke,dT as Mi,m0 as Pi,co as yt,eF as zn,eG as ut,B as it,cs as Lt,ef as Ui,y as $i,F as Vi,cB as Ji,gF as zi}from"./main-dumNSXg9.js";import{E as qi}from"./ExpensesPage-DKNRgk8-.js";import{A as Yi}from"./AccountingPage-C2DP-JWy.js";import{f as mt,u as zt,a as Gi,T as Wi}from"./useSetScopeBasedOnJournal-PP4Ts0v-.js";import{A as qt}from"./StyledTable-BvuuAZaN.js";import{a as Nt,A as _t,Y as pa,b as ha,_ as Va,T as pt,c as Hi,d as Ki}from"./createAccount-retFqBLt.js";import{r as xn,f as Ln}from"./removeCommasFromNumber-TXsqgSgj.js";import{p as Ye}from"./preventNonNumericCharsOnInput-egT6peCW.js";import{b as tn,C as z,T as j,J as Ie,Y as wn,A as P,a as Te,R as ht,G as Nn,c as We,_ as St,d as Xi,e as mn,f as Qi,g as Fn}from"./Combobox-Xn4TjqaT.js";import{u as fe,_ as Zi}from"./updateAccount-Be5-UCsl.js";import{C as Ct}from"./Checklist-CbTzPKDC.js";import{R as xt,_ as eo}from"./getUnmatchedTransactions-zdlIdSLx.js";import{a as no}from"./amountGreaterThenZero-DRjlJHup.js";import{M as to}from"./MobileHeaderDropdown-BnfW6Csr.js";import{U as ao}from"./UnlockAccountingModalWrapper-CrxupuPy.js";import"./string-to-snake-case-g6W1NcXQ.js";import"./ListItemWithIcon-By1rHi9p.js";import"./ExportCSVModal-0PisjjZp.js";import"./expenseCategoryEnum-BEP8x9f-.js";import"./groupAndSortListings-CLoD2org.js";import"./PaymentsTableRow-NoMG3AT3.js";import"./ExportButton-DL4kRba5.js";import"./InfoModal-D5RMBJJI.js";import"./AccountingPromoOffer-B6HWWLkC.js";import"./convert-to-number-DDDLCOuG.js";function io(){const n=new Map;function t({root:a,rootMargin:o,threshold:i}){let r=n.get(a);r||(r=new Map,n.set(a,r));const d=JSON.stringify({rootMargin:o,threshold:i});let l=r.get(d);if(!l){const u=new Map;l={observer:new IntersectionObserver(s=>{s.forEach(m=>{u.get(m.target)?.(m)})},{root:a,rootMargin:o,threshold:i}),entryCallbacks:u},r.set(d,l)}return{observe:(u,c)=>{l.entryCallbacks.set(u,c),l.observer.observe(u)},unobserve:u=>{l.entryCallbacks.delete(u),l.observer.unobserve(u)}}}return{getObserver:t}}var oo="0px",so=[0],lo=io();function ro(n){const t=n?.rootMargin??oo,a=n?.threshold??so,o=h.useRef(null),i=h.useRef(null),r=h.useRef(null),[d,l]=h.useState(),u=h.useCallback(({newNode:m,newRoot:p})=>{function v(){const g=r.current,f=o.current;f&&(g?.unobserve(f),l(void 0)),r.current=null}function k(){if(!m)return;const g=lo.getObserver({root:p,rootMargin:t,threshold:a});g.observe(m,f=>{l(f)}),r.current=g,o.current=m,i.current=p}v(),k()},[t,a]),c=h.useCallback(m=>(u({newNode:m,newRoot:i.current}),()=>{u({newNode:null,newRoot:i.current})}),[u]),s=h.useCallback(m=>(u({newNode:o.current,newRoot:m}),()=>{u({newNode:o.current,newRoot:null})}),[u]);return[c,{entry:d,rootRef:s}]}var co=ro;function uo(n){const{once:t,...a}=n??{},[o,i]=co(a),r=!!i.entry?.isIntersecting,[d,l]=h.useState(r);return t&&r&&!d&&l(!0),[o,{...i,isVisible:t?d:r}]}var mo=uo,po=100;function ho({loading:n,hasNextPage:t,onLoadMore:a,rootMargin:o,disabled:i,delayInMs:r=po}){const d=h.useRef(a),[l,{rootRef:u,isVisible:c}]=mo({rootMargin:o});h.useEffect(()=>{d.current=a},[a]);const s=!i&&!n&&c&&t;return h.useEffect(()=>{if(s){const m=setTimeout(()=>{d.current()},r);return()=>{clearTimeout(m)}}},[s,r]),[l,{rootRef:u}]}var Ja=ho;const Gn="data:image/svg+xml,%3csvg%20viewBox='0%200%20960%2072'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='960'%20height='72'%20rx='4'%20fill='white'/%3e%3crect%20x='21'%20y='24'%20width='24'%20height='24'%20rx='4'%20fill='%23E6E9F0'/%3e%3crect%20width='179.6'%20height='72'%20transform='translate(54)'%20fill='black'%20fill-opacity='0.01'/%3e%3crect%20x='78'%20y='24'%20width='131.6'%20height='24'%20rx='4'%20fill='%23E6E9F0'/%3e%3crect%20width='179.6'%20height='72'%20transform='translate(233.6)'%20fill='black'%20fill-opacity='0.01'/%3e%3crect%20x='257.6'%20y='24'%20width='131.6'%20height='24'%20rx='4'%20fill='%23E6E9F0'/%3e%3crect%20width='179.6'%20height='72'%20transform='translate(413.2)'%20fill='black'%20fill-opacity='0.01'/%3e%3crect%20x='437.2'%20y='24'%20width='131.6'%20height='24'%20rx='4'%20fill='%23E6E9F0'/%3e%3crect%20width='179.6'%20height='72'%20transform='translate(592.8)'%20fill='black'%20fill-opacity='0.01'/%3e%3crect%20x='616.8'%20y='24'%20width='131.6'%20height='24'%20rx='4'%20fill='%23E6E9F0'/%3e%3crect%20x='796.4'%20y='24'%20width='131.6'%20height='24'%20rx='4'%20fill='%23E6E9F0'/%3e%3c/svg%3e",Wn="data:image/svg+xml,%3csvg%20viewBox='0%200%20361%2056'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='361'%20height='56'%20rx='4'%20fill='white'/%3e%3crect%20width='203'%20height='56'%20fill='black'%20fill-opacity='0.01'/%3e%3crect%20x='16'%20y='16'%20width='187'%20height='24'%20rx='4'%20fill='%23E6E9F0'/%3e%3crect%20x='219'%20y='16'%20width='84'%20height='24'%20rx='4'%20fill='%23E6E9F0'/%3e%3crect%20x='319'%20y='16'%20width='22'%20height='24'%20rx='4'%20fill='%23E6E9F0'/%3e%3c/svg%3e",go=()=>e.jsx(e.Fragment,{children:Array.from({length:14}).map((n,t)=>e.jsx(qn,{skeleton:Gn,skeletonMobile:Wn},`${String(t+1)}-skeleton`))});function za(n){if(!n)return"";const t=n.toString().replace(/,/g,"");return Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2,style:"decimal"}).format(Number(t))}function Xe(n){return{amount:n?.toString()??null,key:Ci()}}function gt(n){return n.reduce((a,o)=>{const i=Number(o.amount);return Number.isFinite(i)?a+Math.round(i*100):a},0)/100}const vo="-SSpr",ko="jloZS",fo="-xf7E",bo="wJqO8",yo="_9z2Ly",No="zOwGV",So="_1Oyxj",yn={container:vo,splitLine:ko,splitLineControls:fo,splitLineInput:bo,footer:yo,errorMessage:No,totalAmount:So},qa=({errorMessage:n,splitLines:t,updateSplitLines:a})=>{const{values:o}=Y({subscription:{values:!0}}),i=()=>{a([...t,Xe()])},r=d=>{a(t.filter(l=>l.key!==d))};return e.jsxs("ul",{className:yn.container,children:[t.map((d,l)=>e.jsxs("li",{className:yn.splitLine,children:[e.jsx(ie,{size:"large",children:`Transaction ${(l+1).toString()}`}),e.jsxs("div",{className:yn.splitLineControls,children:[e.jsx(T,{className:yn.splitLineInput,component:je,formatOnBlur:!0,format:mt,icon:"dollar",name:`splitLines.${l.toString()}.amount`,parse:xn,placeholder:"0.00",step:".01",pattern:"[0-9]*",inputMode:"decimal",type:"number",onKeyDown:Ye,validate:Sn(Yn,dt)}),t.length>2&&e.jsx(O,{"aria-label":"Delete split line",icon:"delete",type:"danger",variant:"ghost",onClick:()=>{r(d.key)}})]})]},d.key)),e.jsxs("li",{className:yn.footer,children:[e.jsx(O,{icon:"plus",iconPosition:"start",type:"secondary",onClick:i,children:"Add Line"}),e.jsxs("div",{children:[!!n&&e.jsx(ie,{className:yn.errorMessage,children:n}),e.jsxs(ie,{className:yn.totalAmount,children:["Total Assigned: $",za(gt(o.splitLines??t).toString())||"0"]})]})]})]})};function ce({prefixOption:n,skip:t,variables:a}){const{data:o,loading:i}=de(tn,{skip:t,variables:a});return{accountOptions:h.useMemo(()=>{if(!o?.accounts)return n?[n]:[];const d=new Map,l=[];o.accounts.forEach(p=>{if(p.parentAccountId){const v=p.parentAccountId.toString();d.has(v)||d.set(v,[]);const k=d.get(v);k&&k.push(p)}}),o.accounts.forEach(p=>{const v=!!p.parentAccountId,k=R(p.id),g=k?d.has(k):!1;!v&&!g&&l.push(p)});const u=l.map(p=>({default:p.default,label:p.name,type2:p.type2,value:R(p.id)??""})),c=[],s=[];Array.from(d.entries()).forEach(([p,v])=>{const k=o.accounts.find(g=>R(g.id)===p);k?c.push({default:k.default,label:k.name,type2:k.type2,options:[{default:k.default,isHidden:!0,label:k.name,type2:k.type2,value:R(k.id)??""},...v.map(g=>({default:g.default,isGrouped:!0,label:g.name,type2:g.type2,value:R(g.id)??""}))]}):v.forEach(g=>{s.push({default:g.default,label:g.name,type2:g.type2,value:R(g.id)??""})})});const m=[...u,...s,...c].sort((p,v)=>p.label.localeCompare(v.label));return[...n?[n]:[],...m]},[o,n]),isLoading:i}}const xo=`query getFixedAssets($propertyId: ID, $entityId: ID) {
  fixedAssets(propertyId: $propertyId, entityId: $entityId) {
    id
    name
    type
    lifespan
    placedInServiceDate
    inactive
    organizationId
    entityId
    propertyId
    createdAt
    updatedAt
    property {
      address1
      address2
    }
  }
}
`,To={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getFixedAssets"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fixedAssets"},arguments:[{kind:"Argument",name:{kind:"Name",value:"propertyId"},value:{kind:"Variable",name:{kind:"Name",value:"propertyId"}}},{kind:"Argument",name:{kind:"Name",value:"entityId"},value:{kind:"Variable",name:{kind:"Name",value:"entityId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lifespan"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"placedInServiceDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inactive"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entityId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"propertyId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"property"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"address1"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address2"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:362,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:xo}}};function Yt({isAddNewIncluded:n=!1,skip:t}){const{data:a,loading:o,refetch:i}=de(To,{skip:t});return{fixedAssetOptions:h.useMemo(()=>(n?[{label:"+ Add new",value:""}]:[]).concat(a?.fixedAssets.map(d=>({label:d.name,value:R(d.id)??""}))??[]),[a,n]),isLoading:o,refetch:i}}const Io=`query getVendors {
  vendors {
    id
    name
    email
    phone
    address1
    address2
    city
    state
    zip
    is1099
    tin
    w9
    notes
    organizationId
    createdAt
    updatedAt
  }
}
`,Ya={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getVendors"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vendors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"phone"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address1"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address2"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"city"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"zip"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is1099"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tin"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"w9"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:247,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Io}}};function Tt(){const{organization:n}=_e(),{data:t,loading:a,refetch:o}=de(Ya,{skip:!n?.vendorTracking}),i=h.useMemo(()=>t?.vendors.map(r=>({label:r.name,value:R(r.id)??""}))??[],[JSON.stringify(t?.vendors)]);return{isLoading:a,refetch:o,vendorOptions:i}}const[V,Ga]=hn("ImportFeed"),jo="_5KKej",Co="HzEeH",Ao="ntqaA",Oo="_0XqgV",ot={container:jo,label:Co,optionsContainer:Ao,option:Oo},Wa=({className:n,selectedTransactionTypeOption:t,onTransactionTypeOptionChange:a,shouldHideLabel:o,transactionTypeOptions:i,...r})=>{const d=Z(),l=i,u=h.useContext(Ga);return e.jsx("div",{className:S(ot.container,n),...r,children:d?e.jsx(z,{labelId:"transaction-type",label:o?void 0:"Transaction type*",options:l,placeholder:"Select one",required:!0,value:t,onChange:c=>{a(c),u?.setShouldCreateRule(!1)}}):e.jsxs(e.Fragment,{children:[!o&&e.jsx(ie,{className:ot.label,children:"Transaction type*"}),e.jsx("div",{className:ot.optionsContainer,children:l.map(c=>e.jsx(vi,{className:ot.option,color:c.value===t?.value?"navyBlue":"outline",tabIndex:0,onClick:()=>{a(c),u?.setShouldCreateRule(!1)},children:c.label},c.value))})]})})},[Hn,Fo]=hn("AddRuleModal"),Do=[{label:"Expense",value:j.EXPENSE},{label:"Fixed asset purchase",value:j.FIXED_ASSET_PURCHASE},{label:"Revenue",value:j.REVENUE},{label:"Transfer to",value:j.TRANSFER_TO},{label:"Transfer from",value:j.TRANSFER_FROM}];function Eo(n){return typeof n=="object"&&"value"in n}function wo({journal:n}){return n?n.type===j.CREDIT_CARD_PAYMENT||n.type===j.TRANSFER?n.journal_lines?.find(a=>a.type===Ie.DEBIT)?.yodleeTransactionId?{label:"Transfer From",value:"Transfer From"}:{label:"Transfer To",value:"Transfer To"}:{label:n.type,value:n.type}:null}function Ro({fixedAssetOptions:n,journal:t}){const a=t?.fixedAssetId?.toString();if(a){const o=n.find(i=>i.value===a);if(o)return o}return n.length===1?n[0]:null}function Lo({destinationAccountOptions:n,journal:t,yodleeType:a}){let o=null;if(t){const i=t.journal_lines?.find(c=>c.type===Ie.CREDIT),r=n.find(c=>c.value===i?.accountId.toString()),d=t.journal_lines?.find(c=>c.type===Ie.DEBIT),l=n.find(c=>c.value===d?.accountId.toString());i?.yodleeTransactionId&&d?.yodleeTransactionId?o=a===wn.CREDIT?r??null:l??null:d?.yodleeTransactionId?o=r??null:o=l??null}return o||(n.length===1?n[0]:null)}function _o({journal:n,vendorOptions:t}){const a=n?.vendorId?.toString();if(a){const o=t.find(i=>i.value===a);if(o)return o}return null}function Bo({entityId:n,propertyId:t,scopeOptions:a}){let o=null;const i=[];return a.forEach(r=>{i.push(r),Eo(r)||r.options.forEach(d=>{i.push(d)})}),t?o=i.find(r=>r.propertyId===t)??null:n&&(o=i.find(r=>r.entityId===n)??null),o||(i.length>0?i[0]:null)}function Mo({unitId:n,unitOptions:t}){if(n){const a=t.find(o=>o.value===n);if(a)return a}return t.length>0?t[0]:null}const Po="pGA7E",Uo="eID7U",At={container:Po,errorMessage:Uo};function ga(n){return n?.value}const $o=({fieldsErrors:n,hasSubmitted:t})=>{const{organization:a}=_e(),{transaction:o,transactionJournal:i}=Hn(),{values:r}=Y(),{change:d}=G(),l=ga(r.transactionTypeOption),u=ce({skip:l!==j.EXPENSE,variables:{filters:{type:j.EXPENSE}}}),c=ce({skip:l!==j.REVENUE,variables:{filters:{type:j.REVENUE}}}),s=ce({skip:l!==j.FIXED_ASSET_PURCHASE,variables:{filters:{type2:P.FIXED_ASSET}}}),{fixedAssetOptions:m,isLoading:p}=Yt({skip:l!==j.FIXED_ASSET_PURCHASE}),v=ce({skip:l!==j.TRANSFER_TO&&l!==j.TRANSFER_FROM,variables:{filters:{idNot:o?.accountId,typeIn:[Te.ASSET,Te.EQUITY,Te.LIABILITY]}}}),{vendorOptions:k,isLoading:g}=Tt(),{isLoading:f,scopeOptions:b,unitOptions:y}=fe({scopeOption:r.scopeOption,unitOption:r.unitOption,handleUnitOptionChange:x=>{d("unitOption",x)}}),I=u.isLoading||c.isLoading||s.isLoading||v.isLoading||p||f||g,{activeAccountOptions:C,destinationLabel:E}=h.useMemo(()=>{switch(ga(r.transactionTypeOption)){case j.EXPENSE:return{activeAccountOptions:u.accountOptions,destinationLabel:"Expense account*"};case j.REVENUE:return{activeAccountOptions:c.accountOptions,destinationLabel:"Revenue account*"};case j.FIXED_ASSET_PURCHASE:return{activeAccountOptions:s.accountOptions,destinationLabel:"Asset account*"};case j.TRANSFER_TO:return{activeAccountOptions:v.accountOptions,destinationLabel:"Transfer to account*"};case j.TRANSFER_FROM:return{activeAccountOptions:v.accountOptions,destinationLabel:"Transfer from account*"};default:return{activeAccountOptions:[],destinationLabel:"Account*"}}},[r.transactionTypeOption,u.accountOptions,c.accountOptions,s.accountOptions,v.accountOptions]),D=a?.vendorTracking&&(r.transactionTypeOption?.value===j.EXPENSE||r.transactionTypeOption?.value===j.FIXED_ASSET_PURCHASE);return h.useEffect(()=>{if(!I&&r.transactionTypeOption===null){const x=wo({journal:i});x&&d("transactionTypeOption",x)}},[I,r.transactionTypeOption,i?.type,o?.yodleeType,d]),h.useEffect(()=>{if(!I&&r.fixedAssetOption===null){const x=Ro({fixedAssetOptions:m,journal:i});x&&d("fixedAssetOption",x)}},[I,r.fixedAssetOption,m,i,d]),h.useEffect(()=>{if(!I&&r.destinationAccountOption===null){const x=Lo({destinationAccountOptions:C,journal:i,yodleeType:o?.yodleeType});x&&d("destinationAccountOption",x)}},[I,r.destinationAccountOption,C,i,o?.yodleeType,d]),h.useEffect(()=>{if(!I&&a?.vendorTracking&&r.vendorOption===null){const x=_o({vendorOptions:k,journal:i});x&&d("vendorOption",x)}},[I,a?.vendorTracking,r.vendorOption,k,i,d]),h.useEffect(()=>{if(!I&&r.scopeOption===null){const x=Bo({scopeOptions:b,entityId:i?.entityId,propertyId:i?.propertyId});x&&d("scopeOption",x)}},[I,r.scopeOption,b,i?.entityId,i?.propertyId,d]),h.useEffect(()=>{if(!I&&r.unitOption===null){const x=Mo({unitOptions:y,unitId:i?.unitId});x&&d("unitOption",x)}},[I,r.unitOption,y,i?.unitId,d]),e.jsxs(pe,{className:At.container,loading:I,children:[e.jsxs("div",{children:[e.jsx(Wa,{shouldHideLabel:!0,"data-qa":"book-transaction-type-select",transactionTypeOptions:Do,selectedTransactionTypeOption:r.transactionTypeOption??void 0,onTransactionTypeOptionChange:x=>{d("transactionTypeOption",x),d("destinationAccountOption",null)}}),t&&!!n.transactionTypeOption&&e.jsx(ie,{className:At.errorMessage,children:n.transactionTypeOption})]}),r.transactionTypeOption&&e.jsxs(e.Fragment,{children:[l===j.FIXED_ASSET_PURCHASE&&e.jsx(T,{component:z,name:"fixedAssetOption",labelId:"fixed-asset",label:"Fixed Asset*",options:m,placeholder:"Select one",validate:M}),e.jsx(T,{component:z,name:"destinationAccountOption",className:At.field,labelId:"destination-account",label:E,options:C,placeholder:"Select one","data-qa":"book-destination-account",validate:M}),D&&e.jsx(T,{component:z,name:"vendorOption",hint:"(Optional)",labelId:"vendor",label:"Vendor",options:k,placeholder:"Select one"}),e.jsx(T,{name:"scopeOption",component:z,labelId:"portfolio-property",label:"Portfolio/Property*",options:b,placeholder:"Select one",validate:M}),y.length>0&&e.jsx(T,{name:"unitOption",component:z,labelId:"unit",label:"Unit*",options:y,placeholder:"Select one",validate:M})]})]})},Vo=()=>e.jsx(oe,{className:"mt-8",children:"All transactions that match will still exist in TurboTenant but be ignored from any calculations in your books."}),Bt={Book:{label:"Book as",value:"Book"},Ignore:{label:"Ignore it",value:"Ignore"},Split:{label:"Split into",value:"Split"}},Qe={SPLIT_LINES:"splitLines",TRANSACTION_AMOUNT:"transactionAmount",TRANSACTION_TYPE_OPTION:"transactionTypeOption"};function va(n){return n?Bt[n]:Bt.Book}function Jo(n,t){const a=n.find(o=>o.value===t);return a||(n.length===1?n[0]:null)}function zo(n,t){return n?n==="Book"&&t?t:n:ht.BOOK}function qo(n){return{analysisAccountId:n.accountOption?.label==="Any account"?null:n.accountOption?.value??"",autobookMatchingTransactions:!0,descriptionContains:n.descriptionContains.trim(),destinationAccountId:n.ruleTypeOption?.value==="Book"&&n.destinationAccountOption?n.destinationAccountOption.value:null,entityId:n.ruleTypeOption?.value==="Book"&&n.scopeOption?.entityId?n.scopeOption.entityId:null,fixedAssetId:n.ruleTypeOption?.value==="Book"&&n.fixedAssetOption?.value?n.fixedAssetOption.value:null,propertyId:n.ruleTypeOption?.value==="Book"&&n.scopeOption?.propertyId?n.scopeOption.propertyId:null,splitAmounts:n.ruleTypeOption?.value==="Split"?n.splitLines.map(t=>Number(t.amount)):null,transactionAmount:n.isAmountEnabled?Number(n.transactionAmount):null,type:zo(n.ruleTypeOption?.value,n.transactionTypeOption?.value),unitId:n.ruleTypeOption?.value==="Book"&&n.unitOption?.value!=="all"?n.unitOption?.value:null,vendorId:n.ruleTypeOption?.value==="Book"&&n.vendorOption?.value?n.vendorOption.value:null}}function Yo(n){const t={[Qe.SPLIT_LINES]:"",[Qe.TRANSACTION_AMOUNT]:"",[Qe.TRANSACTION_TYPE_OPTION]:""};if(n.ruleTypeOption?.value==="Split"){n.transactionAmount||(t[Qe.TRANSACTION_AMOUNT]="Amount is required");const a=gt(n.splitLines),o=Number(n.transactionAmount);if(a!==o){const i=o-a;t[Qe.SPLIT_LINES]=`$${za(Math.abs(i).toString())} ${i>0?"remaining":"over"}`}}return n.ruleTypeOption?.value==="Book"&&(n.transactionTypeOption||(t[Qe.TRANSACTION_TYPE_OPTION]="Transaction type is required")),t}const Go=`mutation runAutomations($input: runAutomationsInput!) {
  runAutomations(input: $input) {
    automationType
    autobookedTransactionsCount
    ok
  }
}
`,Ha={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"runAutomations"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"runAutomationsInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"runAutomations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"automationType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"autobookedTransactionsCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:192,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Go}}},Wo=`mutation createImportedTransactionRule(
  $input: createImportedTransactionRuleInput!
) {
  createImportedTransactionRule(input: $input) {
    ok
    importedTransactionRule {
      analysisAccountId
      autobookMatchingTransactions
      createdAt
      descriptionContains
      destinationAccountId
      entityId
      fixedAssetId
      id
      organizationId
      propertyId
      splitAmounts
      transactionAmount
      type
      unitId
      updatedAt
      vendorId
    }
  }
}
`,Ho={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"createImportedTransactionRule"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"createImportedTransactionRuleInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createImportedTransactionRule"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"importedTransactionRule"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"analysisAccountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"autobookMatchingTransactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"descriptionContains"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"destinationAccountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entityId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fixedAssetId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"propertyId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"splitAmounts"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"transactionAmount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unitId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vendorId"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:533,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Wo}}};function Ko(){const[n,{loading:t}]=ae(Ho);return{createImportedTransactionRule:n,isSubmitting:t}}const[jn,Xo]=hn("AllTransactions");function Qo(){const[n,t]=h.useState(!1),[a,o]=h.useState(!1),{transaction:i}=Hn(),{onRuleAdded:r}=Hn(),{values:d}=Y(),{isSubmitting:l,createImportedTransactionRule:u}=Ko(),c=Ea(),s=h.useMemo(()=>Yo(d),[d]),{variables:m,totalTransactionsCount:p,updateJournalsCelebration:v}=jn(),[k,{loading:g}]=ae(Ha,{refetchQueries:[{query:Nt,variables:{...m,first:p}}]}),f=I=>{switch(I){case"Book":return"booked";case"Ignore":return"ignored";default:return I}},b=I=>{const C="Rule added!";return I===0?C:`${C} ${I.toString()} ${I===1?"transaction":"transactions"} matched and were ${f(d.ruleTypeOption?.value??"")} automatically.`};return{fieldsErrors:s,hasSubmitted:a,isRunningAutomations:g||n,isSubmitting:l,handleSubmit:async I=>{if(I.preventDefault(),ee("create_rule clicked ",{location:"Rule Modal"}),o(!0),t(!0),!Object.values(s).some(Boolean))try{const C=qo(d),E=await u({variables:{input:C}}),D=await k({variables:{input:{organizationId:i?.organizationId.toString()??"",automationType:C.type,analysisAccounts:C.analysisAccountId?[C.analysisAccountId]:null,ruleId:R(E.data?.createImportedTransactionRule.importedTransactionRule.id)}}});ge(b(D.data.runAutomations.autobookedTransactionsCount)),await v(),t(!1),D.data.runAutomations.autobookedTransactionsCount&&D.data.runAutomations.autobookedTransactionsCount>0&&C.type===ht.SPLIT&&await c.refetchQueries({include:["getImportedTransactions"]}),r()}catch(C){ye("Failed to create rule"),t(!1),console.error(C)}}}}function Zo(){const{transaction:n}=Hn(),{accountOptions:t,isLoading:a}=ce({prefixOption:{label:"Any account",value:""},variables:{filters:{type2In:[P.BANK,P.CREDIT_CARD]}}}),{change:o}=G(),{values:i}=Y();return h.useEffect(()=>{if(!a&&i.accountOption===null){const r=Jo(t,n?.accountId);r&&o("accountOption",r)}},[a,i.accountOption,t,n?.accountId,o]),{isLoading:a,accountOptions:t}}const es="mo-ko",ns="-dOsO",ts="ukEu4",as="cNuzV",is="YtdBE",os="FhRCB",ss="UCC3o",ls="AY3dB",ln={content:es,amountContainer:ns,amountInput:ts,errorMessage:as,ruleTypeContainer:is,footer:os,createButton:ss,cancelButton:ls},rs=()=>{const{onModalClosed:n}=Hn(),{isLoading:t,accountOptions:a}=Zo(),{change:o}=G(),{values:i}=Y(),{fieldsErrors:r,hasSubmitted:d,isRunningAutomations:l,isSubmitting:u,handleSubmit:c}=Qo(),s=p=>{o("splitLines",p)},m=()=>{ee("create_rule clicked",{location:"rule_modal tt"})};return h.useEffect(()=>{i.ruleTypeOption?.value==="Split"&&o("isAmountEnabled",!0)},[i.ruleTypeOption?.value,o]),e.jsx(_,{isDismissible:!1,isOpen:!0,onClose:n,size:"lg",children:e.jsx(pe,{loading:t,children:e.jsxs("form",{onSubmit:c,children:[e.jsx(_.Header,{children:"Add Rule"}),e.jsxs(_.Content,{className:ln.content,children:[e.jsxs("div",{children:[e.jsx(Ze,{className:"mb-8",children:"When a transaction from"}),e.jsx(T,{name:"accountOption",component:z,label:"Account*",options:a,placeholder:"Select one",validate:M})]}),e.jsxs("div",{children:[e.jsx(Ze,{className:"mb-8",children:"includes the following"}),e.jsx(T,{className:"mb-0",component:K,label:"Description containing*",name:"descriptionContains",placeholder:"Description",required:!0})]}),e.jsxs("div",{children:[e.jsxs("div",{className:ln.amountContainer,children:[e.jsx(T,{className:"mb-0",component:en,disabled:i.ruleTypeOption?.value==="Split",label:"and the amount equals",name:"isAmountEnabled",type:"checkbox"}),e.jsx(T,{className:ln.amountInput,component:je,disabled:!i.isAmountEnabled,format:Ln,inputProps:{icon:"dollar"},name:"transactionAmount",parse:xn,placeholder:"0.00",type:"text",onKeyDown:Ye})]}),d&&!!r[Qe.TRANSACTION_AMOUNT]&&e.jsx(ie,{className:ln.errorMessage,children:r[Qe.TRANSACTION_AMOUNT]})]}),e.jsxs("div",{className:ln.ruleTypeContainer,children:[e.jsx(Ze,{className:"mb-0",children:"then"}),e.jsx(T,{name:"ruleTypeOption",component:z,options:Object.values(Bt),placeholder:"Select one",validate:M}),i.ruleTypeOption?.value==="Ignore"&&e.jsx(Vo,{}),i.ruleTypeOption?.value==="Book"&&e.jsx($o,{fieldsErrors:r,hasSubmitted:d}),i.ruleTypeOption?.value==="Split"&&e.jsx(qa,{errorMessage:d?r[Qe.SPLIT_LINES]:void 0,splitLines:i.splitLines,updateSplitLines:s})]})]}),e.jsxs(_.Footer,{className:ln.footer,children:[e.jsx(O,{className:ln.cancelButton,disabled:u||l,variant:"outline",onClick:n,children:"Cancel"}),e.jsx(O,{className:ln.createButton,disabled:u||l,htmlType:"submit",loading:u||l,onClick:m,children:"Create rule"})]})]})})})},cs=({ruleData:n,transaction:t,transactionJournal:a,onModalClosed:o,onRuleAdded:i})=>{const[r,d]=h.useState({accountOption:null,descriptionContains:a?.description??t?.description??"",destinationAccountOption:null,fixedAssetOption:null,isAmountEnabled:!1,ruleTypeOption:va(n?.type??t?.ruleType),scopeOption:null,splitLines:n?.splitAmounts?.map(u=>Xe(u))??[Xe(),Xe()],transactionAmount:a?.amount??(typeof t?.amount=="number"?Math.abs(t.amount):null),transactionTypeOption:null,unitOption:null,vendorOption:null});h.useEffect(()=>{d({accountOption:null,descriptionContains:a?.description??t?.description??"",destinationAccountOption:null,fixedAssetOption:null,isAmountEnabled:!1,ruleTypeOption:va(n?.type??t?.ruleType),scopeOption:null,splitLines:n?.splitAmounts?.map(u=>Xe(u))??[Xe(),Xe()],transactionAmount:a?.amount??(typeof t?.amount=="number"?Math.abs(t.amount):null),transactionTypeOption:null,unitOption:null,vendorOption:null})},[n,t,a]);const l=h.useMemo(()=>({ruleData:n,transaction:t,transactionJournal:a,onRuleAdded:i,onModalClosed:o,setFormValues:d}),[t,a,i,o,d]);return e.jsx(Fo.Provider,{value:l,children:e.jsx(ne,{initialValues:r,keepDirtyOnReinitialize:!0,onSubmit:()=>{},children:()=>e.jsx(rs,{})})})},Ka={definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"GetStartedChecklistFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GetStartedChecklist"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"addProperty"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"importTransaction"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"trackLoans"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bookTransactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"visitInsights"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subscribe"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"completedAt"},arguments:[],directives:[]}]}}]},ds=`#import "../../fragments/accounting/getStartedChecklist.fragment.graphql"

mutation updateGetStartedChecklist($input: updateGetStartedChecklistInput!) {
  updateGetStartedChecklist(input: $input) {
    getStartedChecklist {
      ...GetStartedChecklistFragment
    }
  }
}
`,vt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateGetStartedChecklist"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"updateGetStartedChecklistInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateGetStartedChecklist"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getStartedChecklist"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"GetStartedChecklistFragment"},directives:[]}]}}]}}]}}],loc:{start:0,end:311,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:ds}}},us=n=>{const t={};return n.filter(function(a){if(a.kind!=="FragmentDefinition")return!0;const o=a.name.value;return t[o]?!1:(t[o]=!0,!0)})};vt.definitions=us(vt.definitions.concat(Ka.definitions));const ms=(n,t)=>{const a=(s,m)=>{if(s.kind==="FragmentSpread")m.add(s.name.value);else if(s.kind==="VariableDefinition"){const p=s.type;p.kind==="NamedType"&&m.add(p.name.value)}return s&&"selectionSet"in s&&s.selectionSet&&s.selectionSet.selections.forEach(p=>{a(p,m)}),s&&"variableDefinitions"in s&&s.variableDefinitions&&s.variableDefinitions.forEach(p=>{a(p,m)}),s&&"definitions"in s&&s.definitions&&s.definitions.forEach(p=>{a(p,m)}),m},o=s=>{const m={};return s.definitions.forEach(function(p){"name"in p&&p.name&&(m[p.name.value]=a(p,new Set))}),m},i=(s,m)=>{for(let p=0;p<s.definitions.length;p++){const v=s.definitions[p];if(v&&"name"in v&&v.name&&v.name.value==m)return v}},r=o(n),d=Object.assign({},n,{definitions:[i(n,t)]}),l=r[t]||new Set,u=new Set;let c=new Set;for(l.forEach(s=>{c.add(s)});c.size>0;){const s=c;c=new Set,s.forEach(m=>{u.has(m)||(u.add(m),(r[m]||new Set).forEach(v=>{c.add(v)}))})}return u.forEach(s=>{const m=i(n,s);m&&d.definitions.push(m)}),d};ms(vt,"updateGetStartedChecklist");const ps=`#import "../../fragments/accounting/getStartedChecklist.fragment.graphql"
query getGetStartedChecklist {
  getStartedChecklist {
    ...GetStartedChecklistFragment
  }
}
`,kt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getGetStartedChecklist"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getStartedChecklist"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"GetStartedChecklistFragment"},directives:[]}]}}]}}],loc:{start:0,end:208,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:ps}}},hs=n=>{const t={};return n.filter(function(a){if(a.kind!=="FragmentDefinition")return!0;const o=a.name.value;return t[o]?!1:(t[o]=!0,!0)})};kt.definitions=hs(kt.definitions.concat(Ka.definitions));const gs=(n,t)=>{const a=(s,m)=>{if(s.kind==="FragmentSpread")m.add(s.name.value);else if(s.kind==="VariableDefinition"){const p=s.type;p.kind==="NamedType"&&m.add(p.name.value)}return s&&"selectionSet"in s&&s.selectionSet&&s.selectionSet.selections.forEach(p=>{a(p,m)}),s&&"variableDefinitions"in s&&s.variableDefinitions&&s.variableDefinitions.forEach(p=>{a(p,m)}),s&&"definitions"in s&&s.definitions&&s.definitions.forEach(p=>{a(p,m)}),m},o=s=>{const m={};return s.definitions.forEach(function(p){"name"in p&&p.name&&(m[p.name.value]=a(p,new Set))}),m},i=(s,m)=>{for(let p=0;p<s.definitions.length;p++){const v=s.definitions[p];if(v&&"name"in v&&v.name&&v.name.value==m)return v}},r=o(n),d=Object.assign({},n,{definitions:[i(n,t)]}),l=r[t]||new Set,u=new Set;let c=new Set;for(l.forEach(s=>{c.add(s)});c.size>0;){const s=c;c=new Set,s.forEach(m=>{u.has(m)||(u.add(m),(r[m]||new Set).forEach(v=>{c.add(v)}))})}return u.forEach(s=>{const m=i(n,s);m&&d.definitions.push(m)}),d};gs(kt,"getGetStartedChecklist");const Xa=(n,t,a)=>{try{n.modify({id:n.identify({__typename:"Transaction",id:t}),fields:a})}catch(o){console.error("Failed to update transaction cache:",o)}},Qa=(n,t,a)=>{try{n.modify({id:n.identify({__typename:"GetStartedChecklist",id:t}),fields:a})}catch(o){console.error("Failed to update get started checklist cache:",o)}},vs="/assets/accounting-checklist-booking-Bdizn8vf.gif",ks="_1eTYt",fs="f6uD5",bs="IKvrJ",ys="zF-zq",st={imageContainer:ks,closeIcon:fs,contentContainer:bs,bodyText:ys},Ns=({onClose:n})=>{const t=()=>{ee("let's_book clicked",{location:"Checklist"}),n(),setTimeout(()=>{const a=document.querySelector('[data-qa="all-transactions-table"]');if(!a)return;const o=a.getBoundingClientRect();window.scrollTo({top:window.scrollY+o.top,behavior:"smooth"})},100)};return e.jsxs(_,{isOpen:!0,size:"md",children:[e.jsxs("div",{className:st.imageContainer,children:[e.jsx(O,{variant:"ghost",type:"reverse",icon:"close",className:st.closeIcon,onClick:n}),e.jsx("img",{src:vs,alt:"Checklist Booking"})]}),e.jsx(_.Content,{children:e.jsxs("div",{className:st.contentContainer,children:[e.jsx(Ke,{children:"Booking starts with choosing the right transaction type"}),e.jsx("span",{className:st.bodyText,children:"Selecting a transaction type categorizes your payment. Most are income or expenses, but some may be transfers or loan payments. Accurate choices keep your books tax-ready."}),e.jsx(O,{onClick:t,width:176,children:"Let's book"})]})})]})},Ss="Vv8Rz",xs="CXP8m",Ts="RSG24",Is="_4Ll-6",js="nmqh2",Cs="hjBaU",As="_5DneY",Os="SwB4u",Fs="_0mPbx",Ds="Do9Nm",qe={checklistItem:Ss,disabled:xs,checklistItemContent:Ts,checklistTitleRow:Is,checklistTitle:js,completed:Cs,timeEstimate:As,checklistDescription:Os,checklistPostStepAlert:Fs,checklistAction:Ds},Ot=({title:n,description:t,timeEstimate:a,isCompleted:o=!1,buttonText:i="",isDisabled:r=!1,shouldUseREIHubRedirectButton:d=!1,redirectPage:l,shouldDisplayPostStepAlert:u=!1,postStepAlertText:c="",onButtonClick:s})=>{const m=gn();return e.jsxs(Ct,{open:!0,completed:o,inProgress:!1,className:S(qe.checklistItem,{[qe.disabled]:r}),children:[e.jsxs("div",{className:qe.checklistItemContent,children:[e.jsxs("div",{className:qe.checklistTitleRow,children:[e.jsx(Ct.Title,{title:"",className:qe.checklistTitle}),e.jsx("span",{className:S(qe.checklistTitle,{[qe.completed]:o}),children:n}),!o&&e.jsx("span",{className:qe.timeEstimate,children:a?`~${a} min`:""})]}),!o&&e.jsx(Ct.Content,{children:e.jsx(ie,{className:qe.checklistDescription,children:t})}),o&&u&&e.jsx(oe,{type:"info",className:qe.checklistPostStepAlert,children:e.jsx(ie,{children:c})})]}),!o&&e.jsx("div",{className:qe.checklistAction,children:d?e.jsx("div",{onClick:s,children:e.jsx(xt,{label:i,icon:"new-window",redirectPage:l,segmentLocation:"get-started-checklist",width:m?"block":232})}):e.jsx(O,{variant:"fill",size:"md",width:m?"block":232,onClick:s,children:i})})]})},Es="_3geDi",ws="s2zpT",Rs="VoUt2",Ls="_8oEo8",_s="_4Wljr",Bs="RF36u",Dn={card:Es,header:ws,headerIcon:Rs,progressBarContainer:Ls,progressBar:_s,checklistContainer:Bs},lt=3,Ms=()=>{const n=In(),t=$t(),a=de(kt),o=!!a.data?.getStartedChecklist,{updateGetStartedChecklistId:i,totalTransactionsCount:r}=jn(),[d]=ae(vt,{update:y=>{Qa(y,a.data?.getStartedChecklist.id??"",{visitInsights:()=>Nn.COMPLETED})}}),[l,u]=h.useState(!0),s=new URLSearchParams(t.search).get("openChecklistBookingModal")==="true",[m,p]=h.useState(s),v=()=>{ee("add_transactions clicked",{location:"Checklist"}),n("/owners/accounting/link")},k=()=>{p(!1)},g=()=>{ee("explore clicked",{location:"Checklist"}),d({variables:{input:{visitInsights:Nn.COMPLETED}}}),n("/owners/accounting/insights")};if(h.useEffect(()=>{o&&a.data?.getStartedChecklist.id&&i(a.data.getStartedChecklist.id)},[a.data?.getStartedChecklist]),!o)return null;const f={isLinkAccountCompleted:a.data?.getStartedChecklist.importTransaction===Nn.COMPLETED||a.data?.getStartedChecklist.importTransaction===Nn.SKIPPED,isBookTransactionCompleted:a.data?.getStartedChecklist.bookTransactions===Nn.COMPLETED,isVisitInsightsCompleted:a.data?.getStartedChecklist.visitInsights===Nn.COMPLETED},b=Object.values(f).filter(Boolean).length;return b===lt?null:e.jsxs(e.Fragment,{children:[m&&e.jsx(Ns,{onClose:k}),e.jsxs(Rn,{className:Dn.card,children:[e.jsxs("div",{className:Dn.header,children:[!l&&e.jsx(Ai,{percentage:b/lt*100,shouldShowCount:!0,current:b,max:lt}),e.jsx(Ze,{children:"Set up Accounting"}),f.isLinkAccountCompleted&&e.jsx(O,{variant:"ghost",size:"lg",className:Dn.headerIcon,onClick:()=>{u(!l)},children:l?e.jsx(se,{name:"chevron-arrow-up",size:"lg"}):e.jsx(se,{name:"chevron-arrow-down",size:"lg"})})]}),l&&e.jsxs("div",{className:Dn.checklistContainer,children:[e.jsx(nt,{value:b,max:lt,type:"rounded",children:e.jsxs(nt.Container,{className:Dn.progressBarContainer,children:[e.jsx(nt.Bar,{className:Dn.progressBar}),e.jsx(nt.Counter,{})]})}),e.jsx(Ot,{title:"Step 1: Start importing your transactions",description:"Let's start importing your transactions to keep your books up to date. Connect your bank and transactions will automatically sync to TurboTenant.",timeEstimate:"3",isCompleted:f.isLinkAccountCompleted,shouldUseREIHubRedirectButton:!1,redirectPage:void 0,buttonText:"Add Transactions",onButtonClick:v,shouldDisplayPostStepAlert:!r,postStepAlertText:"Your transactions are still syncing from your bank and will appear on this page once we receive them."}),e.jsx(Ot,{title:"Step 2: Book your first transaction",description:"Keep your books accurate by categorizing transactions and setting up automation with matching rules.",timeEstimate:"1",isCompleted:f.isBookTransactionCompleted,buttonText:"Book",isDisabled:!f.isLinkAccountCompleted||r===0,onButtonClick:()=>{ee("book_transaction clicked",{location:"Checklist"}),p(!0)}}),e.jsx(Ot,{title:"Step 3: Explore Insights",description:"Here's where you'll track cash flow, property performance, and get tax-ready reports.",timeEstimate:"1",isCompleted:f.isVisitInsightsCompleted,buttonText:"Explore",onButtonClick:g,isDisabled:!f.isBookTransactionCompleted})]})]})]})},Ps=`#import "../../fragments/accounting/organization.fragment.graphql"

mutation updateOrganization($input: updateOrganizationInput!) {
  updateOrganization(input: $input) {
    ok
    organization {
      ...OrganizationFragment
    }
  }
}
`,_n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateOrganization"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"updateOrganizationInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateOrganization"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organization"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"OrganizationFragment"},directives:[]}]}}]}}]}}],loc:{start:0,end:276,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Ps}}},Us=n=>{const t={};return n.filter(function(a){if(a.kind!=="FragmentDefinition")return!0;const o=a.name.value;return t[o]?!1:(t[o]=!0,!0)})};_n.definitions=Us(_n.definitions.concat(Oi.definitions));const $s=(n,t)=>{const a=(s,m)=>{if(s.kind==="FragmentSpread")m.add(s.name.value);else if(s.kind==="VariableDefinition"){const p=s.type;p.kind==="NamedType"&&m.add(p.name.value)}return s&&"selectionSet"in s&&s.selectionSet&&s.selectionSet.selections.forEach(p=>{a(p,m)}),s&&"variableDefinitions"in s&&s.variableDefinitions&&s.variableDefinitions.forEach(p=>{a(p,m)}),s&&"definitions"in s&&s.definitions&&s.definitions.forEach(p=>{a(p,m)}),m},o=s=>{const m={};return s.definitions.forEach(function(p){"name"in p&&p.name&&(m[p.name.value]=a(p,new Set))}),m},i=(s,m)=>{for(let p=0;p<s.definitions.length;p++){const v=s.definitions[p];if(v&&"name"in v&&v.name&&v.name.value==m)return v}},r=o(n),d=Object.assign({},n,{definitions:[i(n,t)]}),l=r[t]||new Set,u=new Set;let c=new Set;for(l.forEach(s=>{c.add(s)});c.size>0;){const s=c;c=new Set,s.forEach(m=>{u.has(m)||(u.add(m),(r[m]||new Set).forEach(v=>{c.add(v)}))})}return u.forEach(s=>{const m=i(n,s);m&&d.definitions.push(m)}),d};$s(_n,"updateOrganization");const an=(n,t)=>n===_t.ASSET&&(t===pa.DEBIT||t===ha.DEBIT)||n===_t.LIABILITY&&(t===pa.CREDIT||t===ha.CREDIT),Ge=n=>Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),Za=n=>{const t=R(n.id),a=n.journal.journal_lines.filter(o=>o.yodleeTransactionId!==t);return`${n.journal.type}${a.length!==1?"":`: ${a[0].account.name}`}`},Vs=(n,t)=>n?`Split - ${t.description}`:t.description,Js="At3ct",zs="F8oeL",qs="gTfre",Ys="_6JCoy",Gs="Jl80p",Ws="wAR8N",Hs="j65VM",Ks="GpIsu",Xs="WQ8ZA",Qs="vAGQ4",Zs="_4U1sI",el="_2sbLo",be={header:Js,title:zs,contentContainer:qs,table:Ys,dateColumn:Gs,descriptionColumn:Ws,subTitle:Hs,amountColumn:Ks,negativeAmount:Xs,noBorderFooter:Qs,checkboxContainer:Zs,checkbox:el},nl=({onClose:n})=>{Kn("overflow: hidden;");const t=Z(),[a,o]=h.useState(!1),{updateIsAddRuleModalVisible:i,descriptionMatches:r}=jn(),[d]=ae(_n),l=async()=>{await d({variables:{input:{settings:{shouldHideSuggestRule:!0}}},onCompleted:()=>{i(!0)}})},u=async()=>{a&&await l(),n()},c=async()=>{a&&await l(),i(!0),n()};return e.jsxs(_,{isOpen:!0,onClose:u,backdrop:"opaque",isDismissible:!0,placement:"top",scrollBehavior:"inside",size:"lg",hideCloseButton:t,children:[e.jsx(_.Header,{children:"Add rule"}),e.jsxs("div",{className:be.header,children:[e.jsx("span",{className:be.title,children:`Auto book ${r.length.toString()} similar transactions?`}),e.jsx(oe,{type:"info",children:e.jsx(ie,{children:"Rules are ideal for repeat transactions that have the same type, account, and applicable property or portfolio."})})]}),e.jsx(_.Content,{className:be.contentContainer,children:e.jsx(qt,{className:be.table,headers:[e.jsx("span",{className:be.dateColumn,children:"Date"},"date"),e.jsx("span",{className:be.descriptionColumn,children:"Description"},"description"),e.jsx("span",{className:be.amountColumn,children:"Amount"},"amount")],children:r.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:be.dateColumn,children:Ve(s.date).format("M/DD/YYYY")}),e.jsxs("td",{className:be.descriptionColumn,children:[e.jsx("span",{children:s.description}),e.jsx("span",{className:be.subTitle,children:s.account.name})]}),e.jsx("td",{className:S(be.amountColumn,{[be.negativeAmount]:an(s.account.type,s.yodleeType)}),children:an(s.account.type,s.yodleeType)?`-${Ge(s.amount)}`:Ge(s.amount)})]},s.id))})}),e.jsx(_.Footer,{className:be.noBorderFooter,children:e.jsx("div",{className:be.checkboxContainer,children:e.jsx(en,{className:be.checkbox,label:"Don't ask me again",wholeContainerClickable:!0,checked:a,onChange:()=>{o(!a)}})})}),e.jsxs(_.Footer,{children:[e.jsx(_.SecondaryAction,{onClick:u,children:"Not Right Now"}),e.jsx(_.PrimaryAction,{onClick:c,children:"Continue"})]})]})},tl=`mutation deleteJournal($input: deleteJournalInput!) {
  deleteJournal(input: $input) {
    ok
  }
}
`,ei={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"deleteJournal"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"deleteJournalInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteJournal"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:138,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:tl}}},al=`mutation splitTransaction($input: splitTransactionInput!) {
  splitTransaction(input: $input) {
    ok
    splitChildren {
      id
      split
      splitParentId
      amount
      description
    }
  }
}
`,il={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"splitTransaction"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"splitTransactionInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"splitTransaction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"splitChildren"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"split"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"splitParentId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:245,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:al}}},ol=`mutation unsplitTransaction($input: unsplitTransactionInput!) {
  unsplitTransaction(input: $input) {
    ok
  }
}
`,sl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"unsplitTransaction"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"unsplitTransactionInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"unsplitTransaction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:153,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:ol}}},ll=`mutation updateTransaction($input: updateTransactionInput!) {
  updateTransaction(input: $input) {
    ok
    transaction {
      id
      split
      splitParentId
    }
  }
}
`,rl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateTransaction"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"updateTransactionInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateTransaction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"transaction"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"split"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"splitParentId"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:215,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:ll}}},ni=({children:n,transaction:t,batchTargets:a,updateBatchTargets:o})=>{const i=!!t.journal,r=t.ignored,d=t.split,l=!!t.splitParentId,u=i&&t.journal?.attachmentURL!=="",c=!!t.journal?.autobooked,s=!i&&!d&&!r,[m,p]=h.useState(!1),[v,k]=h.useState(!1),[g,f]=h.useState(!1),[b,y]=h.useState(!1),[I,C]=h.useState(!1),[E,D]=h.useState(!1),[x,A]=h.useState(!1),[F,U]=h.useState(!1),[q,X]=h.useState(!1),[w,J]=h.useState(!1),[re,ze]=h.useState(!1),{updateIsAddRuleModalVisible:Se,updateCurrentTransaction:vn,updateCurrentTransactionJournal:kn,updateCurrentRuleData:W,updateDescriptionMatches:Ee,updateIsSuggestRuleModalVisible:Cn}=jn(),fn=Ea(),[Qn]=bt(Nt),{organization:Zn}=_e(),Q=($,we,Re)=>{try{$.modify({id:$.identify({__typename:"Transaction",id:we}),fields:Re})}catch(ue){console.error("Failed to update transaction cache:",ue)}},[sn,{loading:An}]=ae(ei,{update:$=>{Q($,t.id,{journal:()=>null})},onCompleted:()=>{ge("Transaction unbooked successfully")},onError:()=>{ye("Failed to unbook transaction")}}),[On,{loading:Ht}]=ae(rl),[Kt]=ae(il),[Xt]=ae(sl),Qt=h.useCallback(($,we)=>{(s&&!m&&$.target.type!=="checkbox"||we&&$.target.type!=="checkbox")&&($.stopPropagation(),p(!0))},[s,m]),Zt=h.useCallback(async()=>{let $=t.description;for(let ue=$.length-1;ue>0&&$[ue]==="\\";ue--)$=$.slice(0,ue);const Re=(await Qn({variables:{description:$,yodleeType:t.yodleeType,transactionStatus:We.UNBOOKED,accountIds:[t.account.id],first:100,includeAccount:!0}})).data?.transactions.edges.map(ue=>ue.node).filter(ue=>ue.yodleeType===t.yodleeType);Re?.length&&Re.length>0&&(Ee(Re),Cn(!0))},[t,Qn,Ee,Cn]),ea=h.useCallback(($,we)=>{$?.stopPropagation();const Re=Zn?.settings?.shouldHideUnsavedFormModal===!0;if(!we&&!Re&&v){f(!0);return}p(!1),b&&!i&&(W(null),Se(!0))},[v,b]),na=h.useCallback($=>{k($)},[]),ta=h.useCallback($=>{f($)},[]),aa=h.useCallback(async()=>{if(!t.journal?.id)return;const $=Number(R(String(t.journal.id)));await sn({variables:{input:{id:$}}}),C(!1)},[t.journal?.id,sn]),ia=h.useCallback(async $=>{if(!$||$.length===0){D(!0);return}const we=$.reduce((ue,et)=>ue+et,0),Re=Math.abs(t.amount);if(Number(we.toFixed(2))!==Number(Re.toFixed(2))){ye("Split amounts must total the original amount");return}try{ze(!0);const ue=Number(R(String(t.id)));await Kt({variables:{input:{transactionId:ue,splitAmounts:$}}}),await fn.refetchQueries({include:["getImportedTransactions"]}),ge("Transaction split successfully"),b&&(W({splitAmounts:$,type:ht.SPLIT}),vn(t),t.journal&&kn(t.journal),Se(!0))}catch{ye("Failed to split transaction")}finally{D(!1),ze(!1)}},[t,Kt,b,vn,kn,Se,fn]),oa=s?[{label:"Split",icon:"expand-horizontal",type:"split"},{label:"Ignore",icon:"block",type:"ignore"},{label:"Edit",icon:"edit",type:"edit"}]:[{label:"Unbook",icon:"cancel",type:"unbook"}],bn=$=>{ee(`${$} clicked`,{location:"kebob"})},sa=h.useCallback($=>{switch($){case"split":bn("Split"),D(!0);break;case"ignore":bn("Ignore"),U(!0);break;case"edit":bn("Edit"),A(!0);break;case"delete":bn("Delete");break;case"duplicate":bn("Duplicate");break;case"unbook":bn("Unbook"),C(!0);break;default:console.warn(`No such action - ${$} found`)}},[bn,D,U,A,C]),la=h.useCallback(async $=>{try{const we=Number($.amount);let Re=we,ue=t.yodleeType;we<0&&(Re=Math.abs(we),ue=t.yodleeType==="DEBIT"?"CREDIT":"DEBIT");const et=Ve($.date).format("MM-DD-YYYY");await On({variables:{input:{id:Number(R(String(t.id))),date:et,amount:Re,description:$.description??null,yodleeType:ue,organizationId:Number(t.organizationId)}},update:gi=>{Q(gi,t.id,{date:()=>et,amount:()=>Re,description:()=>$.description??void 0,yodleeType:()=>ue})}}),ge("Transaction saved successfully")}catch{ye("Failed to save transaction")}finally{A(!1)}},[t,On,b]),ra=h.useCallback(async()=>{try{await On({variables:{input:{id:Number(R(String(t.id))),ignored:!0,organizationId:Number(t.organizationId)}},update:$=>{Q($,t.id,{ignored:()=>!0})}}),ge("Transaction ignored successfully"),b&&(W({type:ht.IGNORE}),vn(t),t.journal&&kn(t.journal),Se(!0))}catch{ye("Failed to ignore transaction")}finally{U(!1)}},[t,On,b]),ca=h.useCallback(async()=>{J(!0);try{await Xt({variables:{input:{id:Number(R(String(t.id)))}},update:$=>{Q($,t.id,{split:()=>!1,splitParentId:()=>null})}}),await fn.refetchQueries({include:["getImportedTransactions"]}),ge("Transaction successfully unsplit."),X(!1)}catch{ye("Failed to unsplit transaction.")}finally{J(!1)}},[t.id,Xt,fn,Q,X,J]),da=h.useMemo(()=>t.split&&Array.isArray(t.splitChildren)?t.splitChildren.length:0,[t.split,t.splitChildren]),ua=h.useCallback(async()=>{ee("unignore clicked",{location:"Import Feed"});try{await On({variables:{input:{id:Number(R(String(t.id))),ignored:!1,organizationId:Number(t.organizationId)}},update:$=>{Q($,t.id,{ignored:()=>!1})}}),ge("Transaction unignored successfully")}catch{ye("Failed to unignore transaction")}},[t,On]),hi=h.useMemo(()=>({canBeBooked:s,hasAttachment:u,isAutoBooked:!!c,isBooked:i,isIgnored:r,isInlineBookingVisible:m,isSplitChild:l,isSplitParent:d,isUnsavedFormModalVisible:g,transaction:t,batchTargets:a,shouldCreateRule:b,closeInlineBooking:ea,handleIsTemplateFormDirtyChange:na,handleIsUnsavedFormModalVisibleChange:ta,openInlineBooking:Qt,updateBatchTargets:o,setShouldCreateRule:y,isUnbookConfirmationModalVisible:I,setIsUnbookConfirmationModalVisible:C,kebobActions:oa,handleKebobAction:sa,unbookTransaction:aa,isSplitTransactionModalVisible:E,setIsSplitTransactionModalVisible:D,splitTransaction:ia,isEditTransactionModalVisible:x,setIsEditTransactionModalVisible:A,isIgnoreTransactionModalVisible:F,setIsIgnoreTransactionModalVisible:U,editTransaction:la,ignoreTransaction:ra,isUpdatingTransaction:Ht,isDeletingJournal:An,unsplitTransaction:ca,isUnsplitConfirmationModalVisible:q,setIsUnsplitConfirmationModalVisible:X,isUnsplitting:w,isSplittingTransactions:re,splitChildrenCount:da,segmentTracking:ee,unignoreTransaction:ua,handleSuggestRule:Zt}),[s,u,c,i,r,m,l,d,g,t,a,b,ea,na,ta,Qt,o,I,C,oa,sa,aa,E,D,ia,x,A,F,U,la,ra,Ht,An,ca,q,X,w,re,da,ee,ua,Zt]);return e.jsx(Ga.Provider,{value:hi,children:n})},cl="ucarecdn",Bn=(n,t)=>{const a=n.includes(cl),o=n.replace("~1/","~1/nth/0/");return t?a?o:n.split("/").pop()??"":a?o:n},dl=[{label:"Expense",value:j.EXPENSE},{label:"Transfer between accounts",value:j.TRANSFER},{label:"Loan payment",value:j.LOAN_PAYMENT},{label:"Fixed asset purchase",value:j.FIXED_ASSET_PURCHASE},{label:"Credit card payment",value:j.CREDIT_CARD_PAYMENT},{label:"Owner distribution",value:j.DISTRIBUTION},{label:"Security deposit refund",value:j.SECURITY_DEPOSIT_REFUND},{label:"Issued refund",value:j.REFUND_ISSUED}],ul=[{label:"Partner deposit",value:j.PARTNER_DEPOSIT},{label:"Revenue",value:j.REVENUE},{label:"Net income",value:j.NET_INCOME},{label:"Owner contribution",value:j.CONTRIBUTION},{label:"Security deposit",value:j.SECURITY_DEPOSIT_RECEIVED},{label:"Transfer between accounts",value:j.TRANSFER},{label:"Refund received",value:j.REFUND}],ml=[{label:"Loan payment",value:j.LOAN_PAYMENT},{label:"Escrow expense",value:j.ESCROW_EXPENSE}],pl=[{label:"Escrow expense",value:j.ESCROW_EXPENSE},{label:"Loan payment",value:j.LOAN_PAYMENT}],hl=[{label:"Credit card payment",value:j.CREDIT_CARD_PAYMENT},{label:"Refund received",value:j.REFUND},{label:"Revenue",value:j.REVENUE}],gl=[{label:"Expense",value:j.EXPENSE},{label:"Fixed asset purchase",value:j.FIXED_ASSET_PURCHASE},{label:"Transfer between accounts",value:j.TRANSFER}],vl=2500,Ce={CASH_IN:"cash in",CASH_OUT:"cash out"},ft={SECURITY_DEPOSIT_OUT:"Security deposit out",SECURITY_DEPOSIT_IN:"Security deposit in"};function Ft(n,t){return n.map(a=>Object.keys(t).includes(a.label)?{...a,label:t[a.label]}:a)}function kl({accountType:n,accountType2:t,yodleeType:a}){return h.useMemo(()=>{if(n===Te.ASSET)return a===wn.CREDIT?Ft(ul,{"Partner Deposit":"TurboTenant Deposit","Transfer Between Accounts":"Transfer","Owner Contribution":"Contribution"}):Ft(dl,{"Owner Distribution":"Distribution","Refund Issued":"Issued Refund",Refund:"Refund Received","Security Deposit Refund":"Security Deposit Return","Security Deposit Received":"Security Deposit","Transfer Between Accounts":"Transfer"});const o=new Set([P.MORTGAGE,P.HELOC,P.HARD_MONEY_LOAN,P.LOAN]);return n===Te.LIABILITY&&o.has(t)?a===wn.CREDIT?ml:pl:n===Te.LIABILITY&&t===P.CREDIT_CARD?a===wn.CREDIT?hl:Ft(gl,{"Transfer Between Accounts":"Transfer"}):[]},[n,t,a])}function fl({recommendedTransactionType:n,selectedTransactionTypeOption:t,transactionAmount:a,transactionTypeOptions:o,handleTransactionTypeOptionChange:i}){const{transaction:r}=V(),d=h.useCallback(()=>{switch(r.journal?.type){case ft.SECURITY_DEPOSIT_IN:return j.SECURITY_DEPOSIT_RECEIVED;case ft.SECURITY_DEPOSIT_OUT:return j.SECURITY_DEPOSIT_REFUND;case j.TRANSFER:return r.journal.journal_lines?.find(l=>!l.yodleeTransactionId)?.account.name.toLowerCase().includes("turbotenant")?j.PARTNER_DEPOSIT:r.journal.type;case j.TRANSFER_FROM:case j.TRANSFER_TO:return j.TRANSFER;default:return r.journal?.type}},[r.journal?.type]);h.useEffect(()=>{if(r.journal?.type&&!t){const c=d(),s=o?.find(m=>m.value===c);s&&i(s);return}const l=o?.find(c=>c.label==="TurboTenant Deposit");if(a>100&&l&&!t){i(l);return}const u=o?.find(c=>c.value===n);if(u&&!t){i(u);return}if(!t&&o?.length){const c=o.find(m=>m.label==="Expense"),s=o.find(m=>m.label==="Revenue");i(c??s??o[0])}},[n,i])}const[on,bl]=hn("InlineBooking"),yl="xqac-",Nl="_1EWhn",Sl="T293-",rt={container:yl,createRuleCheckbox:Nl,button:Sl},Ae=({canCreateRule:n,submitting:t,disabled:a})=>{const{shouldCreateRule:o,closeInlineBooking:i,setShouldCreateRule:r,transaction:d}=V(),l=Z(),u=!!d.journal,c=()=>{ee("save clicked",{location:"import_feed tt"})};return e.jsxs("div",{className:rt.container,children:[n&&!u&&e.jsx(en,{className:rt.createRuleCheckbox,input:{value:o,onChange:s=>{r(s.target.checked)}},label:"Create rule after saving",wholeContainerClickable:!0}),e.jsx(O,{className:rt.button,htmlType:"submit",loading:t,disabled:a,onClick:c,children:"Save"}),l&&e.jsx(O,{className:rt.button,variant:"outline",onClick:i,disabled:t,children:"Cancel"})]})};function Be(){const{handleIsTemplateFormDirtyChange:n}=V(),{dirty:t}=Y();h.useEffect(()=>{n(t)},[t,n])}const xl=`mutation deleteDraftDocument($id: String!) {
  deleteDraftDocument(input: { id: $id }) {
    documentId
  }
}
`,Tl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"deleteDraftDocument"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteDraftDocument"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"documentId"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:148,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:xl}}},Il="_1Sle2",jl="XkyYG",Cl="-HKyW",Al="nhisX",$n={modalContainer:Il,title:jl,buttonContainer:Cl,button:Al},Ol=({isDeletingDocument:n,onCloseModal:t,onDocumentDeleted:a})=>{const o=async()=>{await a(),t()};return e.jsxs(_a,{autoFocus:!1,className:$n.modalContainer,disableOutsideClick:!0,open:!0,size:"small",onClose:t,children:[e.jsx(Ke,{className:$n.title,children:"Delete Document"}),e.jsx(ie,{children:"Make sure you have a copy saved elsewhere if you need it."}),e.jsxs("div",{className:$n.buttonContainer,children:[e.jsx(O,{className:$n.button,disabled:n,type:"primary",variant:"outline",onClick:t,children:"Cancel"}),e.jsx(O,{className:$n.button,loading:n,onClick:o,children:"Delete"})]})]})},Fl=`mutation updateDraftDocument(
  $documentId: String!
  $sourceType: DraftDocumentSourceTypeEnum
  $sourceId: String
  $title: String
) {
  updateDraftDocument(
    input: {
      documentId: $documentId
      title: $title
      sourceType: $sourceType
      sourceId: $sourceId
    }
  ) {
    updatedDraftDocument {
      id
      path
      title
      source_id
      source_type
    }
  }
}
`,Dl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateDraftDocument"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"documentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sourceType"}},type:{kind:"NamedType",name:{kind:"Name",value:"DraftDocumentSourceTypeEnum"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sourceId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateDraftDocument"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"documentId"},value:{kind:"Variable",name:{kind:"Name",value:"documentId"}}},{kind:"ObjectField",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"ObjectField",name:{kind:"Name",value:"sourceType"},value:{kind:"Variable",name:{kind:"Name",value:"sourceType"}}},{kind:"ObjectField",name:{kind:"Name",value:"sourceId"},value:{kind:"Variable",name:{kind:"Name",value:"sourceId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updatedDraftDocument"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"path"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"source_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"source_type"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:434,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Fl}}},ka={UPLOAD_DOCUMENT:1};function El({documentId:n,sourceId:t,onDraftDocumentUpdated:a,onModalClosed:o}){const[i,r]=h.useState(1),[d,l]=h.useState({}),u=h.useCallback(()=>{l({}),r(ka.UPLOAD_DOCUMENT)},[]),c=h.useCallback(()=>{u(),l({title:""}),r(ka.UPLOAD_DOCUMENT),o()},[u]),s=h.useCallback(g=>{console.error(g),u(),ye(g?.message??"An error occurred")},[u]),m=h.useCallback(()=>{r(g=>g+1)},[]),p=h.useCallback(({droppedFiles:g})=>{const f=g?.[0];if(!f){s(new Error("No file attached."));return}if(!Ba.includes(f.name.split(".").pop()?.toLowerCase()??"")){s(new Error(`File type for ${f.name} is not supported.`));return}if(f.size>Fi){s(new Error("File size exceeds the 20MB limit."));return}l({file:f,title:f.name}),m()},[m,s]),v=h.useCallback(async g=>{try{const f=await Ma({fileName:g.title??""}),b=f.url??f.urls?.[0];if(!b)throw new Error("Missing S3 upload URL");await Pa(b,g.file),await a({documentId:f.id,id:f.id,path:f.url?.params.key,sourceId:t,sourceType:"BOOKING_ATTACHMENT",title:g.title}),ge("Your document was uploaded!")}catch(f){console.error(f),s(new Error("Upload failed. Please try again."))}finally{c()}},[d.file,a,s,c]),k=h.useCallback(async g=>{try{if(!n)throw new Error("Document ID is required");await a({documentId:n,title:g.title}),ge("Your document was updated!")}catch{s(new Error("Update failed. Please try again."))}finally{c()}},[a,n,s,c]);return{formData:d,step:i,closeModal:c,editDraftDocument:k,handleFileDrop:p,resetFlow:u,setFormData:l,setStep:r,uploadDraftDocument:v}}const[Gt,wl]=hn("DocumentUploaderModal"),Rl="wUSYt",Ll="lV2nT",_l="qT-h8",Bl="OzQDD",Ml="U3otT",Pl="P8V65",Ul="CL5Qm",$l="v76IS",Vl="UU9ek",Jl="_4O7eP",zl="_92Pm6",ql="JAF0O",Yl="eMcwZ",Le={hideMobile:Rl,modalContainer:Ll,title:_l,dropZoneDescription:Bl,text:Ml,tooltip:Pl,tooltipText:Ul,mobileDisclaimer:$l,fileContainer:Vl,fileNameWrapper:Jl,fileName:zl,submitButtonWrapper:ql,submitButton:Yl},Gl=()=>{const{formData:n,editDraftDocument:t,resetFlow:a,uploadDraftDocument:o}=Gt(),i=h.useCallback(async r=>{n.file?await o(r):await t(r)},[n.file,o,t]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:Le.fileContainer,children:[e.jsxs("div",{className:Le.fileNameWrapper,children:[e.jsx(se,{name:"document",color:"close-lightbg"}),e.jsx(wt,{className:Le.fileName,children:n.title})]}),e.jsx(Di,{icon:"delete",iconProps:{color:"error"},onClick:a})]}),e.jsx(ne,{onSubmit:i,initialValues:n,children:({handleSubmit:r,submitting:d})=>e.jsxs("form",{onSubmit:r,children:[e.jsx(T,{help:(l="")=>`${l.length.toString()} / 200 characters used`,id:"title",maxLength:200,name:"title",validate:M,children:l=>e.jsx(e.Fragment,{children:e.jsx(K,{label:"Document title",...l})})}),e.jsx("div",{className:Le.submitButtonWrapper,children:e.jsx(O,{className:Le.submitButton,htmlType:"submit",loading:d,children:"Save"})})]})})]})},fa="Files must be 20MB and one of these file types: CSV, DOCX, JPG, PNG, PDF, TXT, XLSX, or ZIP.",Wl=()=>{const{handleFileDrop:n}=Gt(),t=Z();return e.jsxs(e.Fragment,{children:[e.jsx(Ua,{id:"document_upload",name:"document_upload",label:"",description:e.jsxs("div",{className:Le.dropZoneDescription,children:[e.jsx(Ze,{className:Le.text,children:t?"Tap to upload":"Click or drag to upload"}),e.jsx(ki,{icon:"info",className:Le.hideMobile,tooltipClassName:Le.tooltip,tip:e.jsx("span",{className:Le.tooltipText,children:fa})})]}),accept:Ba.map(a=>`.${a}`).join(","),multiple:!1,iconProps:{width:34,height:34},onFileDrop:a=>{n({droppedFiles:a})}}),e.jsx(ie,{className:Le.mobileDisclaimer,children:fa})]})},Hl=()=>{const{step:n}=Gt();switch(n){case 1:return e.jsx(Wl,{});case 2:return e.jsx(Gl,{});default:return null}},Kl=({document:n,sourceId:t,onDocumentSaved:a,onModalClosed:o})=>{const[i,{loading:r}]=ae(Dl),d=h.useCallback(async b=>{const y={...n,...b};await i({variables:y}),await a(y)},[n,i,a]),{formData:l,step:u,handleFileDrop:c,closeModal:s,editDraftDocument:m,resetFlow:p,setFormData:v,setStep:k,uploadDraftDocument:g}=El({documentId:n?.id,sourceId:t,onDraftDocumentUpdated:d,onModalClosed:o}),f=h.useMemo(()=>({formData:l,step:u,editDraftDocument:m,handleFileDrop:c,resetFlow:p,uploadDraftDocument:g}),[l,u,m,c,p,g]);return h.useEffect(()=>{n&&(k(2),v({title:n.title}))},[n,v,k]),e.jsx(_a,{autoFocus:!1,className:Le.modalContainer,disableOutsideClick:!0,open:!0,showCloseIcon:!0,size:"small",onClose:s,children:e.jsx(wl.Provider,{value:f,children:r?e.jsx(Ei,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:Le.title,children:"Upload your document"}),e.jsx(Hl,{})]})})})};function Xl(){const n=fi();return h.useCallback(t=>{if(!n.S3_BUCKET)throw new Error("S3_BUCKET is not defined");const a=new Date().getTime();return`https://${n.S3_BUCKET}.s3.amazonaws.com/${t}?ts=${a.toString()}`},[n.S3_BUCKET])}const Ql="DY5dL",Zl="hLyTZ",er="r8OZJ",nr="fRXzs",tr="tNVCG",ar="M0Tac",ir="Y2ty7",or="UWGji",sr="LTAjF",lr="Qiq-5",rr="_2aCcQ",xe={container:Ql,hasUploadedDocuments:Zl,addNotesButton:er,addAttachmentButton:nr,fullWidthButton:tr,uploadedDocumentsContainer:ar,uploadedDocument:ir,nameWrapper:or,name:sr,buttonsContainer:lr,button:rr},Oe=()=>{const{transaction:n}=on(),[t,a]=h.useState(!1),[o,i]=h.useState(!!n.journal?.notes),[r,d]=h.useState(!1),{input:{value:l,onChange:u}}=bi("uploadedDocuments"),[c,s]=h.useState(),[m,p]=h.useState(!1),[v,{loading:k}]=ae(Tl),g=Xl(),f=()=>{i(!0)},b=h.useMemo(()=>!!n.journal?.attachmentURL,[n.journal?.attachmentURL]),y=h.useCallback(async A=>{if(A.attachmentURL=g(A.path??""),l.some(F=>F.id===A.id)){const F=l.map(U=>U.id===A.id?A:U);u(F)}else if(c&&c.id!==A.id){const F=l.filter(U=>U.id!==c.id);u([...F,A]),await v({variables:{id:c.id}})}else u([...l,A]);s(void 0)},[l,c]),I=(A,F)=>{s(A),F==="edit"?d(!0):p(!0)},C=()=>n.journal?.attachmentURL&&!n.journal.attachmentURL.includes("ucarecdn.com")?(decodeURIComponent(n.journal.attachmentURL).split("/").pop()??"").split("?")[0]:n.journal?.attachmentURL??"",E=h.useCallback(()=>{d(!1),s(void 0)},[]),D=h.useCallback(async()=>{if(b){u([]);return}await v({variables:{id:c?.id}}),u(l.filter(A=>A.id!==c?.id)),s(void 0)},[l,c]),x=h.useCallback(()=>{p(!1),s(void 0)},[]);return h.useEffect(()=>{b&&!t&&(u([{attachmentURL:n.journal?.attachmentURL,title:C()}]),l.length!==0&&a(!0))},[b,u,l,t]),e.jsxs(e.Fragment,{children:[o&&e.jsx(T,{className:xe.inputField,component:K,hint:"(Optional)",label:"Additional notes",name:"notes",placeholder:"Additional notes"}),e.jsxs("div",{className:S(xe.container,{[xe.hasUploadedDocuments]:l.length>0}),children:[!o&&e.jsx(O,{className:S(xe.addNotesButton,{[xe.fullWidthButton]:l.length>0}),icon:"plus",type:"secondary",onClick:f,children:"Add notes"}),l.length>0&&e.jsx("div",{className:xe.uploadedDocumentsContainer,children:l.map(A=>e.jsxs("div",{className:xe.uploadedDocument,children:[e.jsxs("div",{className:xe.nameWrapper,children:[e.jsx(se,{name:"document",color:"close-lightbg"}),e.jsx(yi,{className:xe.name,target:"_blank",to:{pathname:A.path?g(A.path):n.journal?.attachmentURL},children:A.title})]}),e.jsxs("div",{className:xe.buttonsContainer,children:[!b&&e.jsx(O,{className:xe.button,icon:"edit",type:"primary",variant:"ghost",onClick:()=>{I(A,"edit")}}),e.jsx(O,{className:xe.button,icon:"delete",type:"danger",variant:"ghost",onClick:()=>{I(A,"delete")}})]})]},A.id))}),!l.length&&e.jsx(O,{className:S(xe.addAttachmentButton,{[xe.fullWidthButton]:l.length>0}),disabled:k,icon:"attachment",type:"secondary",onClick:()=>{d(!0)},children:"Add attachment"})]}),r&&e.jsx(Kl,{document:c,sourceId:n.id,onModalClosed:E,onDocumentSaved:y}),m&&e.jsx(Ol,{isDeletingDocument:k,onCloseModal:x,onDocumentDeleted:D})]})},cr="igIuw",dr="yd-Zi",ur="ValP8",mr="ZWkPk",pr="Jmr9v",hr="Bn07-",gr="mazKr",vr="fWsuL",kr="HhOqL",fr="dFCoz",br="s2Td9",yr="VOI24",N={form:cr,fields:dr,field:ur,oneThird:mr,twoThirds:pr,twoThirdsSmall:hr,oneThirdLoan:gr,alertEndButton:vr,loanAmountFieldsContainer:kr,amountsTextContainer:fr,amountText:br,error:yr},Me=({scopeOptions:n,unitOptions:t})=>{const a=Z();return e.jsxs("div",{className:N.fields,children:[e.jsx(T,{component:z,name:"scopeOption",className:S(N.field,{[N.oneThird]:!a}),labelId:"portfolio-property",label:"Portfolio/Property*",options:n,placeholder:"Select One",validate:M}),t.length>0&&e.jsx(T,{component:z,name:"unitOption",className:S(N.field,{[N.oneThird]:!a}),labelId:"unit",label:"Unit*",options:t,placeholder:"Select One",validate:M})]})},It=n=>({propertyId:n.scopeOption?.propertyId?Number(n.scopeOption.propertyId):null,entityId:n.scopeOption?.entityId?Number(n.scopeOption.entityId):null,unitId:n.unitOption?.value&&n.unitOption.value!=="all"?Number(n.unitOption.value):null}),Je=(n,t,a,o)=>{const{description:i,notes:r,uploadedDocuments:d}=n,{date:l,amount:u,accountId:c,id:s,organizationId:m}=t,{selectedAccount:p,direction:v,type:k,vendorId:g,fixedAssetId:f}=a,b=It(n),y={type:"credit",credit:null,debit:null,accountId:null,yodleeTransactionId:null},I={type:"debit",credit:null,debit:null,accountId:null,yodleeTransactionId:null};y.credit=u,I.debit=u;const C=p?.value?Number(p.value):null;v===Ce.CASH_OUT?(I.accountId=C,y.accountId=Number(c),y.yodleeTransactionId=Number(R(s))):(y.accountId=C,I.accountId=Number(c),I.yodleeTransactionId=Number(R(s)));const E={organizationId:Number(m),type:k,cash:!0,accrual:!0,date:l,amount:u,description:i,notes:r,vendorId:g??null,fixedAssetId:f??null,attachmentURL:d[0]?.attachmentURL??"",journalLines:[y,I],...b};return o?.hasJournal?{...E,id:Number(R(o.journalId))}:E},ti=n=>{const t=!!n.journal,a=n.journal;return{hasJournal:t,journalValues:{description:a?.description,fixedAssetId:a?.fixedAssetId,vendorId:a?.vendorId,attachmentURL:a?.attachmentURL,notes:a?.notes,type:a?.type,journalLines:a?.journal_lines,unitId:a?.unitId,propertyId:a?.propertyId,entityId:a?.entityId}}},ai={definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"TransactionFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Transaction"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"yodleeType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ignored"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"split"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"splitParentId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recommendedTransactionType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recommendedAccount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"journalId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"journalLineId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"account"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type2"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"journal"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"JournalFragment"},directives:[]}]}}]}}]},ii={definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"JournalFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Journal"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"autobooked"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"attachmentURL"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"propertyId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unitId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fixedAssetId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vendorId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entityId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"property"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address1"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"entity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"journal_lines"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"yodleeTransactionId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"account"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type2"},arguments:[],directives:[]}]}}]}}]}}]},Nr=`#import "../../fragments/accounting/transaction.fragment.graphql"
#import "../../fragments/accounting/journal.fragment.graphql"

mutation createJournal($input: createJournalInput!) {
  createJournal(input: $input) {
    ok
    journal {
      id
      description
      notes
      date
      amount
      type
      cash
      accrual
      attachmentURL
      organizationId
      propertyId
      unitId
      entityId
      vendorId
      fixedAssetId
      createdAt
      updatedAt
      journal_lines {
        id
        type
        debit
        credit
        amount
        reconciled
        accountId
        yodleeTransactionId
      }
    }
    updatedTransaction {
      ...TransactionFragment
    }
  }
}
`,pn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"createJournal"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"createJournalInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createJournal"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"journal"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cash"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accrual"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"attachmentURL"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"propertyId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unitId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entityId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vendorId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fixedAssetId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"journal_lines"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"debit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"credit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reconciled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"yodleeTransactionId"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"updatedTransaction"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TransactionFragment"},directives:[]}]}}]}}]}}],loc:{start:0,end:761,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Nr}}},oi=n=>{const t={};return n.filter(function(a){if(a.kind!=="FragmentDefinition")return!0;const o=a.name.value;return t[o]?!1:(t[o]=!0,!0)})};pn.definitions=oi(pn.definitions.concat(ai.definitions));pn.definitions=oi(pn.definitions.concat(ii.definitions));const Sr=(n,t)=>{const a=(s,m)=>{if(s.kind==="FragmentSpread")m.add(s.name.value);else if(s.kind==="VariableDefinition"){const p=s.type;p.kind==="NamedType"&&m.add(p.name.value)}return s&&"selectionSet"in s&&s.selectionSet&&s.selectionSet.selections.forEach(p=>{a(p,m)}),s&&"variableDefinitions"in s&&s.variableDefinitions&&s.variableDefinitions.forEach(p=>{a(p,m)}),s&&"definitions"in s&&s.definitions&&s.definitions.forEach(p=>{a(p,m)}),m},o=s=>{const m={};return s.definitions.forEach(function(p){"name"in p&&p.name&&(m[p.name.value]=a(p,new Set))}),m},i=(s,m)=>{for(let p=0;p<s.definitions.length;p++){const v=s.definitions[p];if(v&&"name"in v&&v.name&&v.name.value==m)return v}},r=o(n),d=Object.assign({},n,{definitions:[i(n,t)]}),l=r[t]||new Set,u=new Set;let c=new Set;for(l.forEach(s=>{c.add(s)});c.size>0;){const s=c;c=new Set,s.forEach(m=>{u.has(m)||(u.add(m),(r[m]||new Set).forEach(v=>{c.add(v)}))})}return u.forEach(s=>{const m=i(n,s);m&&d.definitions.push(m)}),d};Sr(pn,"createJournal");function Fe(n){const[t,a]=h.useState(!1),{getStartedChecklistId:o,updateCurrentTransactionJournal:i,updateCurrentTransaction:r,updateJournalsCelebration:d}=jn(),[l,u]=ae(pn,{update:(s,{data:m})=>{const p=m?.createJournal.journal;p&&i(p);const v=m?.createJournal.updatedTransaction;v&&(Xa(s,n.id,{journal:()=>v.journal,journalLineId:()=>v.journalLineId,journalId:()=>v.journalId}),Qa(s,o??"",{bookTransactions:()=>Nn.COMPLETED}))},onError:()=>{ye("Failed to book transaction")}});return{createJournalWithCacheUpdate:h.useCallback(async s=>{r(n),a(!0);const m=await l({variables:{input:s}});return ge("Transaction booked successfully"),await d(),a(!1),m},[l]),...u,createJournalSubmitting:u.loading||t}}const xr=`#import "../../fragments/accounting/transaction.fragment.graphql"
#import "../../fragments/accounting/journal.fragment.graphql"

mutation updateJournal($input: updateJournalInput!) {
  updateJournal(input: $input) {
    ok
    journal {
      id
      description
      notes
      date
      amount
      type
      cash
      accrual
      attachmentURL
      organizationId
      propertyId
      unitId
      entityId
      vendorId
      fixedAssetId
      createdAt
      updatedAt
      journal_lines {
        id
        type
        debit
        credit
        amount
        reconciled
        accountId
        yodleeTransactionId
      }
    }
    updatedTransaction {
      ...TransactionFragment
    }
  }
}
`,Tn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateJournal"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"updateJournalInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateJournal"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"journal"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cash"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accrual"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"attachmentURL"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"propertyId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unitId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entityId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vendorId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fixedAssetId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"journal_lines"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"debit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"credit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reconciled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"yodleeTransactionId"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"updatedTransaction"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TransactionFragment"},directives:[]}]}}]}}]}}],loc:{start:0,end:761,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:xr}}},si=n=>{const t={};return n.filter(function(a){if(a.kind!=="FragmentDefinition")return!0;const o=a.name.value;return t[o]?!1:(t[o]=!0,!0)})};Tn.definitions=si(Tn.definitions.concat(ai.definitions));Tn.definitions=si(Tn.definitions.concat(ii.definitions));const Tr=(n,t)=>{const a=(s,m)=>{if(s.kind==="FragmentSpread")m.add(s.name.value);else if(s.kind==="VariableDefinition"){const p=s.type;p.kind==="NamedType"&&m.add(p.name.value)}return s&&"selectionSet"in s&&s.selectionSet&&s.selectionSet.selections.forEach(p=>{a(p,m)}),s&&"variableDefinitions"in s&&s.variableDefinitions&&s.variableDefinitions.forEach(p=>{a(p,m)}),s&&"definitions"in s&&s.definitions&&s.definitions.forEach(p=>{a(p,m)}),m},o=s=>{const m={};return s.definitions.forEach(function(p){"name"in p&&p.name&&(m[p.name.value]=a(p,new Set))}),m},i=(s,m)=>{for(let p=0;p<s.definitions.length;p++){const v=s.definitions[p];if(v&&"name"in v&&v.name&&v.name.value==m)return v}},r=o(n),d=Object.assign({},n,{definitions:[i(n,t)]}),l=r[t]||new Set,u=new Set;let c=new Set;for(l.forEach(s=>{c.add(s)});c.size>0;){const s=c;c=new Set,s.forEach(m=>{u.has(m)||(u.add(m),(r[m]||new Set).forEach(v=>{c.add(v)}))})}return u.forEach(s=>{const m=i(n,s);m&&d.definitions.push(m)}),d};Tr(Tn,"updateJournal");function De(n){const[t,a]=ae(Tn,{update:(i,{data:r})=>{const d=r?.updateJournal.updatedTransaction;d&&Xa(i,n.id,{journal:()=>d.journal})},onCompleted:()=>{ge("Transaction saved successfully")},onError:()=>{ye("Failed to save transaction")}});return{updateJournalWithCacheUpdate:h.useCallback(async i=>await t({variables:{input:i}}),[t]),...a,updateJournalSubmitting:a.loading}}const Pe=({accountOptions:n,accountFieldName:t,isLoading:a,scopeOptions:o,unitOptions:i,vendorOptions:r,fixedAssetOptions:d})=>{const{transaction:l}=V(),{journalValues:u,hasJournal:c}=ti(l),{initialize:s}=G(),{values:m}=Y(),{setScopeOption:p}=zt(o,u.propertyId??null,u.entityId??null),v=h.useCallback(()=>{if(!a)if(c){const k=l.journal?.type===j.LOAN_PAYMENT?u.journalLines?.find(y=>y.account.type===_t.LIABILITY):u.journalLines?.find(y=>!y.yodleeTransactionId),g=p();let f=null,b=null;l.journal?.vendorId&&(f=r?.find(y=>y.value===l.journal?.vendorId?.toString())),l.journal?.fixedAssetId&&(b=d?.find(y=>y.value===l.journal?.fixedAssetId?.toString())),s({...m,[t]:n.find(y=>y.value===R(k?.account.id)),scopeOption:g,description:u.description,notes:u.notes??"",...f&&{vendorOption:f},...b&&{fixedAssetOption:b}})}else{let k=n.find(g=>g.default===l.recommendedAccount)??null;if(k&&"options"in k&&k.options.length>0){const g=k.options.find(f=>f.label===k?.label);g&&(k=g)}s({...m,[t]:n.length===1?n[0]:k,scopeOption:o.length===1?o[0]:null})}},[a,n.length,o.length,t,c]);return h.useEffect(()=>{c&&i.length&&s({...m,unitOption:u.unitId?i.find(k=>k.value===u.unitId?.toString()):i.find(k=>k.value==="all")})},[c,i,u.unitId]),{initializeFormValues:v,hasJournal:c}};function Ir(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{or:[{defaultNot:"autoBalance"},{default:null}],type:"Equity"}}}),{change:a}=G(),{values:o}=Y(),{isLoading:i,scopeOptions:r,unitOptions:d}=fe({scopeOption:o.scopeOption,unitOption:o.unitOption,handleUnitOptionChange:s=>{a("unitOption",s)}}),l=t||i,{initializeFormValues:u,hasJournal:c}=Pe({accountOptions:n,accountFieldName:"equityAccountOption",isLoading:l,scopeOptions:r,unitOptions:d});return h.useEffect(()=>{u()},[u]),{equityAccountOptions:n,isLoading:l,scopeOptions:r,unitOptions:d,hasJournal:c}}const jr=()=>{const{transaction:n,closeInlineBooking:t}=V(),{values:a}=Y(),{isLoading:o,equityAccountOptions:i,scopeOptions:r,unitOptions:d,hasJournal:l}=Ir(),u=Z(),{createJournalWithCacheUpdate:c,createJournalSubmitting:s}=Fe(n),{updateJournalWithCacheUpdate:m,updateJournalSubmitting:p}=De(n),v=G(),k=h.useCallback(async g=>{g.preventDefault(),await v.submit();const{invalid:f}=v.getState();if(f)return;const b={selectedAccount:a.equityAccountOption,direction:Ce.CASH_IN,type:j.CONTRIBUTION},y=Je(a,n,b,l?{hasJournal:l,journalId:n.journal?.id}:void 0);await(l?m(y):c(y)),t(void 0,!0)},[a,n,t]);return Be(),e.jsx(pe,{loading:o,children:e.jsxs("form",{className:N.form,onSubmit:k,children:[e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"equityAccountOption",component:z,className:S(N.field,{[N.oneThird]:!u}),labelId:"equity-account",label:"Equity account *",options:i,placeholder:"Select one",validate:M}),e.jsx(T,{className:S(N.field,{[N.twoThirds]:!u}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})]}),e.jsx(Me,{scopeOptions:r,unitOptions:d}),e.jsx(Oe,{}),e.jsx(Ae,{submitting:s||p})]})})},Cr=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({equityAccountOption:null,description:n.description,notes:"",scopeOption:null,unitOption:null,uploadedDocuments:[]}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(jr,{})})};function Ar(){const[n,t]=h.useState(!1),[a,o]=h.useState(!1),{transaction:i}=on(),{accountOptions:r,isLoading:d}=ce({skip:!n,variables:{filters:{type2:"Credit Card"}}}),{accountOptions:l,isLoading:u}=ce({skip:!a,variables:{filters:{type2In:["Bank","HELOC","Owner Funds"]}}}),c=h.useMemo(()=>i.yodleeType===wn.CREDIT,[i.yodleeType]),{change:s}=G(),{values:m}=Y(),{isLoading:p,scopeOptions:v,unitOptions:k}=fe({scopeOption:m.scopeOption,unitOption:m.unitOption,handleUnitOptionChange:y=>{s("unitOption",y)}}),g=d||u||p,{initializeFormValues:f,hasJournal:b}=Pe({accountOptions:c?l:r,accountFieldName:c?"paymentAccountOption":"creditCardAccountOption",isLoading:g,scopeOptions:v,unitOptions:k});return h.useEffect(()=>{f()},[f]),h.useEffect(()=>{c?(o(!0),t(!1)):(o(!1),t(!0))},[i.yodleeType]),{isLoading:g,creditCardAccountOptions:r,paymentAccountOptions:l,scopeOptions:v,unitOptions:k,hasJournal:b,isCreditType:c}}const Or=()=>{const{transaction:n,closeInlineBooking:t}=V(),{values:a}=Y(),{updateJournalWithCacheUpdate:o,updateJournalSubmitting:i}=De(n),{createJournalWithCacheUpdate:r,createJournalSubmitting:d}=Fe(n),{isLoading:l,creditCardAccountOptions:u,paymentAccountOptions:c,scopeOptions:s,unitOptions:m,isCreditType:p,hasJournal:v}=Ar(),k=Z(),g=G(),f=h.useCallback(async I=>{I.preventDefault(),await g.submit();const{invalid:C}=g.getState();if(C)return;const E={selectedAccount:p?a.paymentAccountOption:a.creditCardAccountOption,direction:Ce.CASH_OUT,type:j.CREDIT_CARD_PAYMENT},D=Je(a,n,E,v?{hasJournal:v,journalId:n.journal?.id}:void 0);await(v?o(D):r(D)),t(void 0,!0)},[a,n,t]);Be();const b=u.length>0,y=!p&&b||p;return e.jsx(pe,{loading:l,children:e.jsxs("form",{className:N.form,onSubmit:f,children:[!b&&!p&&e.jsx(oe,{type:"info",header:"No credit card accounts currently exist.",children:e.jsx(xt,{label:"Add credit card",redirectPage:"accounts/banking?add=1",segmentLocation:"credit-card-payment-template",icon:"new-window",iconPosition:"end",size:"sm",variant:"ghost",className:N.alertEndButton,bypassNewWindow:!0})}),e.jsxs("div",{className:N.fields,children:[b&&e.jsx(T,{name:"creditCardAccountOption",component:z,className:S(N.field,{[N.oneThird]:!k}),labelId:"credit-card-account",label:"Credit card account*",options:u,placeholder:"Select one",validate:M}),c.length>0&&e.jsx(T,{name:"paymentAccountOption",component:z,className:S(N.field,{[N.oneThird]:!k}),labelId:"payment-account",label:"Paid from account*",options:c,placeholder:"Select one",validate:M}),y&&e.jsx(T,{className:S(N.field,{[N.twoThirds]:!k}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})]}),y&&e.jsxs(e.Fragment,{children:[e.jsx(Me,{scopeOptions:s,unitOptions:m}),e.jsx(Oe,{}),e.jsx(Ae,{canCreateRule:!0,submitting:!!(d||i)})]})]})})},Fr=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({creditCardAccountOption:null,description:n.description,notes:"",paymentAccountOption:null,scopeOption:null,unitOption:null,uploadedDocuments:[]}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(Or,{})})};function Dr(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{or:[{defaultNot:"autoBalance"},{default:null}],type:"Equity"}}}),{change:a}=G(),{values:o}=Y(),{isLoading:i,scopeOptions:r,unitOptions:d}=fe({scopeOption:o.scopeOption,unitOption:o.unitOption,handleUnitOptionChange:s=>{a("unitOption",s)}}),l=t||i,{initializeFormValues:u,hasJournal:c}=Pe({accountOptions:n,accountFieldName:"equityAccountOption",isLoading:l,scopeOptions:r,unitOptions:d});return h.useEffect(()=>{u()},[u]),{equityAccountOptions:n,isLoading:l,scopeOptions:r,unitOptions:d,hasJournal:c}}const Er=()=>{const{transaction:n,closeInlineBooking:t}=V(),{values:a}=Y(),{createJournalWithCacheUpdate:o,createJournalSubmitting:i}=Fe(n),{updateJournalWithCacheUpdate:r,updateJournalSubmitting:d}=De(n),{isLoading:l,equityAccountOptions:u,scopeOptions:c,unitOptions:s,hasJournal:m}=Dr(),p=Z(),v=G(),k=h.useCallback(async g=>{g.preventDefault(),await v.submit();const{invalid:f}=v.getState();if(f)return;const b={selectedAccount:a.equityAccountOption,direction:Ce.CASH_OUT,type:j.DISTRIBUTION},y=Je(a,n,b,m?{hasJournal:m,journalId:n.journal?.id}:void 0);await(m?r(y):o(y)),t(void 0,!0)},[a,n,t]);return Be(),e.jsx(pe,{loading:l,children:e.jsxs("form",{className:N.form,onSubmit:k,children:[e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"equityAccountOption",component:z,className:S(N.field,{[N.oneThird]:!p}),labelId:"equity-account",label:"Equity account*",options:u,placeholder:"Select one",validate:M}),e.jsx(T,{className:S(N.field,{[N.twoThirds]:!p}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})]}),e.jsx(Me,{scopeOptions:c,unitOptions:s}),e.jsx(Oe,{}),e.jsx(Ae,{submitting:i||d})]})})},wr=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({description:n.description,equityAccountOption:null,notes:"",scopeOption:null,unitOption:null,uploadedDocuments:[]}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(Er,{})})},Rr=`mutation createVendor($input: createVendorInput!) {
  createVendor(input: $input) {
    ok
    vendor {
      id
      name
      email
      phone
      address1
      address2
      city
      state
      zip
      is1099
      tin
      w9
      notes
      organizationId
      createdAt
      updatedAt
    }
  }
}
`,Lr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"createVendor"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"createVendorInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createVendor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vendor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"phone"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address1"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address2"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"city"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"zip"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is1099"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tin"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"w9"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:358,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Rr}}},_r="VB0K1",Br="jb7uw",Mr="aJcKH",Pr="kXtn3",Ur="X8yzX",$r="SeKxG",Vr="erVZ8",Jr="LQN0J",zr="cW3CU",me={modalContainer:_r,title:Br,inputField:Mr,oneThird:Pr,twoThirds:Ur,last:$r,checkboxField:Vr,cityStateZipContainer:Jr,buttonsContainer:zr},qr=wi.filter(n=>n.value).map(n=>({label:n.title,value:n.value??""})),Yr=({onCloseModal:n,onVendorAdded:t})=>{const[a,o]=h.useState(!1),{organization:i}=_e(),[r]=ae(Lr),d=async l=>{const u={name:l.name,email:l.email,phone:l.phone,organizationId:Number(R(i?.id)??"")};a&&(u.address1=l.address1,u.address2=l.address2,u.city=l.city,u.state=l.stateOption.value,u.zip=l.zip),l.is1099&&(u.tin=l.tin);try{await r({variables:{input:u}}),t(u),ge("Vendor added successfully"),n()}catch(c){console.error(c),ye("Failed to add vendor")}};return e.jsx(_,{className:me.modalContainer,isDismissible:!1,isOpen:!0,size:"sm",onClose:n,autoFocus:!1,children:e.jsx(ne,{onSubmit:d,children:({submitting:l,values:u,handleSubmit:c})=>e.jsxs("form",{onSubmit:c,children:[e.jsx(Ke,{className:me.title,children:"Add Vendor"}),e.jsx(T,{className:me.inputField,component:K,label:"Name*",name:"name",placeholder:"Enter name",validate:M}),e.jsx(T,{className:me.inputField,component:K,hint:"(Optional)",label:"Email",name:"email",placeholder:"Enter email",type:"email"}),e.jsx(T,{className:me.inputField,component:K,hint:"(Optional)",label:"Phone Number",name:"phone",placeholder:"Enter phone"}),e.jsx(en,{className:me.checkboxField,label:"Add address",wholeContainerClickable:!0,input:{value:a,onChange:s=>{o(s.target.checked)}}}),a&&e.jsxs(e.Fragment,{children:[e.jsx(T,{className:me.inputField,component:K,label:"Street Address*",name:"address1",placeholder:"Enter street address",validate:M}),e.jsx(T,{className:me.inputField,component:K,hint:"(Optional)",label:"Apt, Suite, Unit, etc.",name:"address2"}),e.jsxs("div",{className:me.cityStateZipContainer,children:[e.jsx(T,{className:S(me.inputField,me.twoThirds),component:K,label:"City*",name:"city",placeholder:"Enter city",validate:M}),e.jsx(T,{name:"stateOption",component:z,className:S(me.inputField,me.oneThird),id:"stateOption",label:"State*",labelId:"stateOption",options:qr,placeholder:"",validate:M}),e.jsx(T,{className:S(me.inputField,me.oneThird),component:K,label:"Zip*",name:"zip",placeholder:"Enter zip",validate:M})]})]}),e.jsx(T,{className:me.checkboxField,component:en,label:"Track payments for 1099",name:"is1099",type:"checkbox",wholeContainerClickable:!0}),u.is1099&&e.jsx(T,{className:S(me.inputField,me.last),component:K,label:"Tax Identification Number*",name:"tin",placeholder:"Enter tax identification number",validate:M}),e.jsxs("div",{className:me.buttonsContainer,children:[e.jsx(O,{disabled:l,variant:"outline",onClick:n,children:"Cancel"}),e.jsx(O,{loading:l,htmlType:"submit",children:"Save"})]})]})})})},jt=({vendorOptions:n,onVendorAdded:t})=>{const[a,o]=h.useState(!1),i=h.useMemo(()=>[{label:"+ Add new",value:""},...n],[n]),{organization:r}=_e(),d=Z();return r?.vendorTracking?e.jsxs(e.Fragment,{children:[e.jsx(T,{name:"vendorOption",children:({input:l})=>e.jsx(z,{className:S(N.field,{[N.oneThird]:!d}),hint:"(Optional)",labelId:"vendor",label:"Vendor",options:i,placeholder:"Select one",value:l.value,input:l,onChange:u=>{u?.value===""?o(!0):l.onChange(u)}})}),a&&e.jsx(Yr,{onCloseModal:()=>{o(!1)},onVendorAdded:t})]}):null};function Gr(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{type:"Expense"}}}),a=h.useMemo(()=>n.filter(k=>k.label!=="Depreciation"),[JSON.stringify(n)]),{isLoading:o,refetch:i,vendorOptions:r}=Tt(),{change:d}=G(),{values:l}=Y(),{isLoading:u,scopeOptions:c,unitOptions:s}=fe({scopeOption:l.scopeOption,unitOption:l.unitOption,handleUnitOptionChange:k=>{d("unitOption",k)}}),m=t||o||u,{initializeFormValues:p,hasJournal:v}=Pe({accountOptions:n,accountFieldName:"expenseAccountOption",vendorOptions:r,isLoading:m,scopeOptions:c,unitOptions:s});return h.useEffect(()=>{p()},[p]),{isLoading:m,expenseAccountOptions:a,scopeOptions:c,unitOptions:s,vendorOptions:r,refetchVendorOptions:i,hasJournal:v}}const Wr=()=>{const{transaction:n,closeInlineBooking:t,handleSuggestRule:a,shouldCreateRule:o}=V(),{vendorTracking:i}=on(),{change:r}=G(),{values:d}=Y(),{organization:l}=_e(),{isLoading:u,expenseAccountOptions:c,scopeOptions:s,unitOptions:m,vendorOptions:p,refetchVendorOptions:v,hasJournal:k}=Gr(),g=Z(),{createJournalWithCacheUpdate:f,createJournalSubmitting:b}=Fe(n),{updateJournalWithCacheUpdate:y,updateJournalSubmitting:I}=De(n),C=h.useCallback(async x=>{await v();const A={label:x.name,value:R(x.id)??""};r("vendorOption",A)},[r]),E=G(),D=h.useCallback(async x=>{x.preventDefault(),await E.submit();const{invalid:A}=E.getState();if(A)return;const F={selectedAccount:d.expenseAccountOption,direction:Ce.CASH_OUT,type:j.EXPENSE,vendorId:d.vendorOption?.value?Number(d.vendorOption.value):null},U=Je(d,n,F,k?{hasJournal:k,journalId:n.journal?.id}:void 0);await(k?y(U):f(U)),!l?.settings?.shouldHideSuggestRule&&!o&&a(),t(void 0,!0)},[d,n,t]);return Be(),e.jsx(pe,{loading:u,children:e.jsxs("form",{className:N.form,onSubmit:D,children:[i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"expenseAccountOption",component:z,className:S(N.field,{[N.oneThird]:!g}),labelId:"expense-account",label:"Expense account*",options:c,placeholder:"Select one",validate:M}),e.jsx(jt,{vendorOptions:p,onVendorAdded:C})]}),e.jsx("div",{className:N.fields,children:e.jsx(T,{className:S(N.field,{[N.twoThirds]:!g}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})})]}):e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"expenseAccountOption",component:z,className:S(N.field,{[N.oneThird]:!g}),labelId:"expense-account",label:"Expense account*",options:c,placeholder:"Select one",validate:M}),e.jsx(T,{className:S(N.field,{[N.twoThirds]:!g}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})]}),e.jsx(Me,{scopeOptions:s,unitOptions:m}),e.jsx(Oe,{}),e.jsx(Ae,{canCreateRule:!0,submitting:b||I})]})})},Hr=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({description:n.description,expenseAccountOption:null,notes:"",scopeOption:null,unitOption:null,uploadedDocuments:[],vendorOption:null}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(Wr,{})})},[Pn,Kr]=hn("AddFixedAssetModal"),Xr=({children:n,onClose:t,onAddFixedAsset:a})=>{const{transaction:o}=on(),i=de(St),[r,d]=h.useState("assetType"),[l,u]=h.useState({organizationId:o.organizationId,isProperty:"property",propertyType:{label:"Residential Property",value:"Residential Property",lifespan:27.5},name:"",type:"",typeSelect:null,propertyId:null,propertyIdSelect:null,placedInServiceDate:null,lifespan:null}),c=h.useMemo(()=>i.data?.properties.map(m=>({label:m.address1,value:m.id.toString()}))??[],[i.data?.properties]),s=h.useMemo(()=>({key:r,setKey:d,asset:l,setAsset:u,transaction:o,onClose:t,onAddFixedAsset:a,propertiesData:i,propertiesOptions:c}),[r,d,l,u,o,t,a,i,c]);return e.jsx(Kr.Provider,{value:s,children:n})},Qr="hpuhr",Zr="_8khIV",ec="xIYLK",nc="_3Dbcs",tc="-MOwb",ac="dNFa6",ic="S-Jh0",oc="PlB0c",sc="HT1O3",L={header:Qr,body:Zr,radioLabel:ec,fieldContainer:nc,alertContainer:tc,actions:ac,smallScreen:ic,actionButton:oc,dateField:sc},lc=()=>{const{asset:n,setAsset:t,setKey:a,onClose:o}=Pn(),i=Z(),d=de(St).data?.properties.map(u=>({label:u.address1,value:u.id.toString()}))??[],l=h.useMemo(()=>({name:n.name,propertyIdSelect:n.propertyIdSelect}),[n.name,n.propertyIdSelect]);return e.jsx(ne,{initialValues:l,onSubmit:()=>{a("usefulLife")},children:({handleSubmit:u})=>e.jsxs("form",{onSubmit:u,children:[e.jsx("div",{className:L.header,children:e.jsx(He,{children:"Please fill out asset details"})}),e.jsxs("div",{className:L.body,children:[e.jsx("div",{className:L.fieldContainer,children:e.jsx(T,{name:"name",component:K,label:"Asset name *",validate:M,onChange:c=>{t({...n,name:c.target.value})}})}),e.jsx("div",{className:L.fieldContainer,children:e.jsx(T,{component:z,name:"propertyIdSelect",labelId:"property",label:"Select property where asset is located or used (Optional)",options:d,onChange:c=>{t({...n,propertyIdSelect:c,propertyId:c?Number(c.value):null})},placeholder:"Select one"})})]}),e.jsxs("div",{className:S(L.actions,{[L.smallScreen]:i}),children:[e.jsx(O,{className:S(L.actionButton,{[L.smallScreen]:i}),type:"primary",variant:"outline",onClick:o,children:"Cancel"}),e.jsx(O,{className:S(L.actionButton,{[L.smallScreen]:i}),type:"primary",variant:"fill",htmlType:"submit",children:"Next"})]})]})})},rc=[{name:"Appliances",id:"Appliances",lifespan:5},{name:"Carpets and Furniture",id:"Carpets and Furniture",lifespan:5},{name:"Residential Additions and Improvements",id:"Residential Improvements",lifespan:27.5},{name:"Commercial Additions and Improvements",id:"Commercial Improvements",lifespan:39},{name:"Land Improvements",id:"Land Improvements",lifespan:15},{name:"Loan Closing Costs",id:"Loan Closing Costs",lifespan:null},{name:"Other Fixed Assets",id:"Other Fixed Assets",lifespan:7}],cc=[{label:"Residential Property",value:"Residential Property",lifespan:27.5},{label:"Commercial Property",value:"Commercial Property",lifespan:39}],dc=()=>{const n=rc.map(u=>({label:u.name,value:u.id,lifespan:u.lifespan})),{asset:t,setAsset:a,setKey:o,onClose:i}=Pn(),r=Z(),d=u=>async c=>{c.preventDefault(),c.stopPropagation(),await u.submit();const{invalid:s}=u.getState();if(s)return;const m={...t};t.isProperty==="property"?o("selectProperty"):(t.typeSelect&&(m.type=t.typeSelect.value,m.name=t.typeSelect.value,m.lifespan=t.typeSelect.lifespan),a(m),o("assetDetails"))},l=h.useMemo(()=>({isProperty:t.isProperty,typeSelect:t.typeSelect}),[t.isProperty,t.typeSelect]);return e.jsx(ne,{initialValues:l,onSubmit:()=>{},children:({form:u})=>e.jsxs("form",{onSubmit:c=>{d(u)(c)},children:[e.jsx("div",{className:L.header,children:e.jsx(He,{children:"Which type of fixed asset are you adding?"})}),e.jsxs("div",{className:L.body,children:[e.jsx(T,{name:"isProperty",children:()=>e.jsx(Ri,{label:"Fixed asset type *",labelProps:{className:L.radioLabel},options:[{label:"A property",value:"property"},{label:"Something else",value:"other"}],input:{value:t.isProperty,onChange:c=>{a({...t,isProperty:c})},name:"isProperty"},vertical:!0})}),t.isProperty==="other"&&e.jsx("div",{className:L.fieldContainer,children:e.jsx(T,{component:z,name:"typeSelect",labelId:"asset-type",label:"Select asset type *",placeholder:"Select one",options:n,value:t.typeSelect,validate:M,onChange:c=>{a({...t,typeSelect:c})}})}),e.jsx(oe,{type:"info",className:L.alertContainer,children:e.jsx("span",{children:"Fixed assets are used to track the basis of depreciable items on your balance sheet. Each property can have one or more fixed assets, including the property itself."})})]}),e.jsxs("div",{className:S(L.actions,{[L.smallScreen]:r}),children:[e.jsx(O,{className:S(L.actionButton,{[L.smallScreen]:r}),type:"primary",variant:"outline",onClick:i,children:"Cancel"}),e.jsx(O,{className:S(L.actionButton,{[L.smallScreen]:r}),type:"primary",variant:"fill",htmlType:"submit",children:"Next"})]})]})})},uc=`mutation createFixedAsset($input: createFixedAssetInput!) {
  createFixedAsset(input: $input) {
    ok
    fixedAsset {
      id
      name
      type
      lifespan
      placedInServiceDate
      inactive
      organizationId
      entityId
      propertyId
      createdAt
      updatedAt
    }
  }
}
`,mc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"createFixedAsset"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"createFixedAssetInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createFixedAsset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fixedAsset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lifespan"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"placedInServiceDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inactive"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entityId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"propertyId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:342,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:uc}}},pc=()=>{const{asset:n,onClose:t,onAddFixedAsset:a}=Pn(),{values:o}=Y(),i=gn(),[r,{loading:d}]=ae(mc,{onCompleted:s=>{t(),a(s.createFixedAsset.fixedAsset)}}),[l,u]=h.useState(null),c=async()=>{if(!d)try{await r({variables:{input:{organizationId:Number(n.organizationId),name:n.name,type:n.type,propertyId:n.propertyId,placedInServiceDate:o.placedInServiceDate??null,lifespan:n.lifespan}}}),ge("Fixed asset added successfully")}catch(s){u(s);return}};return e.jsx(ne,{initialValues:{placedInServiceDate:n.placedInServiceDate},onSubmit:()=>{c()},children:({handleSubmit:s})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:L.header,children:e.jsx(He,{children:n.isProperty==="property"?"When was this property placed in service?":"When was this asset placed in service?"})}),e.jsxs("div",{className:L.body,children:[e.jsx(T,{name:"placedInServiceDate",component:nn,label:"Date placed in service (Optional)",className:L.dateField,disableCalendar:i,tabIndex:-1}),e.jsx(oe,{type:"info",className:L.alertContainer,children:n.isProperty==="property"?e.jsx("span",{children:'A property is generally considered "placed in service" when it is first listed for rent. In the first and last tax year that you are eligible to claim depreciation on a property the amount will be prorated based on the date the property was placed in service.'}):e.jsx("span",{children:"An asset is placed in service at the start of its useful life. In the first and last tax year that you are eligible to claim depreciation on an asset the amount will be prorated based on the date the asset was placed in service."})}),l&&e.jsx(oe,{type:"error",className:L.alertContainer,children:e.jsx("span",{children:l.message})})]}),e.jsxs("div",{className:S(L.actions,{[L.smallScreen]:i}),children:[e.jsx(O,{className:S(L.actionButton,{[L.smallScreen]:i}),disabled:d,type:"primary",variant:"outline",onClick:t,children:"Cancel"}),e.jsx(O,{className:S(L.actionButton,{[L.smallScreen]:i}),type:"primary",variant:"fill",onClick:()=>{s()},htmlType:"submit",loading:d,children:n.isProperty==="property"?"Save Property":"Save Fixed Asset"})]})]})})},hc=()=>{const{setKey:n,asset:t,setAsset:a,onClose:o}=Pn(),i=Z(),r=cc.map(c=>({label:c.label,value:c.value,lifespan:c.lifespan})),l=de(St).data?.properties.map(c=>({label:c.address1,value:c.id.toString()}))??[],u=h.useMemo(()=>({propertyIdSelect:t.propertyIdSelect,propertyType:t.propertyType}),[t.propertyIdSelect,t.propertyType]);return e.jsx(ne,{initialValues:u,onSubmit:()=>{n("placedInService")},children:({handleSubmit:c})=>e.jsxs("form",{onSubmit:c,children:[e.jsx("div",{className:L.header,children:e.jsx(He,{children:"Which property are you adding?"})}),e.jsxs("div",{className:L.body,children:[e.jsx("div",{className:L.fieldContainer,children:e.jsx(T,{component:z,name:"propertyIdSelect",labelId:"property",label:"Select property *",options:l,value:t.propertyIdSelect,onChange:s=>{a({...t,propertyIdSelect:s,propertyId:s?Number(s.value):null,name:s?.label??""})},placeholder:"Select one",validate:M})}),e.jsx("div",{className:L.fieldContainer,children:e.jsx(T,{component:z,name:"propertyType",labelId:"property-type",label:"Property type *",options:r,value:t.propertyType,onChange:s=>{a({...t,propertyType:s})},placeholder:"Select one",validate:M})}),e.jsx(oe,{type:"info",className:L.alertContainer,children:e.jsx("span",{children:`${t.propertyType?.label??""} property depreciates over a ${t.propertyType?.lifespan?.toString()??""} year lifespan.`})})]}),e.jsxs("div",{className:S(L.actions,{[L.smallScreen]:i}),children:[e.jsx(O,{className:S(L.actionButton,{[L.smallScreen]:i}),type:"primary",variant:"outline",onClick:o,children:"Cancel"}),e.jsx(O,{className:S(L.actionButton,{[L.smallScreen]:i}),type:"primary",variant:"fill",htmlType:"submit",children:"Next"})]})]})})},gc=()=>{const{setKey:n,asset:t,setAsset:a,onClose:o}=Pn(),i=Z();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:L.header,children:e.jsx(He,{children:"What is the useful life of the fixed asset?"})}),e.jsxs("div",{className:L.body,children:[e.jsx(K,{className:L.fieldContainer,label:"Useful life (Optional)",input:{value:t.lifespan,onChange:r=>{a({...t,lifespan:Number(r.target.value)})}},type:"number",inputProps:{suffix:"years"}}),e.jsx(oe,{type:"info",className:L.alertContainer,children:e.jsx("span",{children:"The useful life of an asset is defined by the IRS. It is the length of time during which you are eligible to claim a depreciation expense. For tangible assets, the useful life is a fixed length. For loan closing cost assets, enter the term of the loan."})})]}),e.jsxs("div",{className:S(L.actions,{[L.smallScreen]:i}),children:[e.jsx(O,{className:S(L.actionButton,{[L.smallScreen]:i}),type:"primary",variant:"outline",onClick:o,children:"Cancel"}),e.jsx(O,{className:S(L.actionButton,{[L.smallScreen]:i}),type:"primary",variant:"fill",onClick:()=>{n("placedInService")},children:"Next"})]})]})},vc=()=>{const{key:n}=Pn();switch(n){case"assetType":return e.jsx(dc,{});case"selectProperty":return e.jsx(hc,{});case"assetDetails":return e.jsx(lc,{});case"usefulLife":return e.jsx(gc,{});case"placedInService":return e.jsx(pc,{});default:return null}},kc=({onClose:n,onAddFixedAsset:t})=>{const a=Z();return Kn("overflow: hidden;"),e.jsx(Xr,{onClose:n,onAddFixedAsset:t,children:e.jsx(_,{isOpen:!0,onClose:n,hideCloseButton:a,size:"lg",children:e.jsx(vc,{})})})},li=({fixedAssetOptions:n,onAddFixedAsset:t})=>{const[a,o]=h.useState(!1),i=Z();return e.jsxs(e.Fragment,{children:[e.jsx(T,{name:"fixedAssetOption",validate:M,children:({input:r,meta:d})=>e.jsx(z,{className:S(N.field,{[N.oneThird]:!i}),labelId:"fixed-asset",label:"Fixed asset*",options:n,placeholder:"Select One",meta:d,input:r,value:r.value,onChange:l=>{l?.value===""?o(!0):r.onChange(l)}})}),a&&e.jsx(kc,{onClose:()=>{o(!1)},onAddFixedAsset:t})]})};function fc(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{type2:"Fixed Asset"}}}),{fixedAssetOptions:a,isLoading:o,refetch:i}=Yt({isAddNewIncluded:!0}),{isLoading:r,refetch:d,vendorOptions:l}=Tt(),{change:u}=G(),{values:c}=Y(),{isLoading:s,scopeOptions:m,unitOptions:p}=fe({scopeOption:c.scopeOption,unitOption:c.unitOption,handleUnitOptionChange:f=>{u("unitOption",f)}}),v=t||o||r||s,{initializeFormValues:k,hasJournal:g}=Pe({accountOptions:n,accountFieldName:"assetAccountOption",isLoading:v,scopeOptions:m,unitOptions:p,vendorOptions:l,fixedAssetOptions:a});return h.useEffect(()=>{k()},[k]),{assetAccountOptions:n,fixedAssetOptions:a,isLoading:v,scopeOptions:m,unitOptions:p,vendorOptions:l,refetchFixedAssetOptions:i,refetchVendorOptions:d,hasJournal:g}}const bc={label:j.EXPENSE,value:j.EXPENSE},yc=()=>{const[n,t]=h.useState(!1),{transaction:a,closeInlineBooking:o,handleSuggestRule:i,shouldCreateRule:r}=V(),{assetAccountOptions:d,isLoading:l,scopeOptions:u,fixedAssetOptions:c,vendorOptions:s,unitOptions:m,refetchFixedAssetOptions:p,refetchVendorOptions:v,hasJournal:k}=fc(),{organization:g}=_e(),f=Z(),{change:b}=G(),{values:y}=Y(),{handleTransactionTypeOptionChange:I}=on(),C=h.useCallback(async X=>{await p();const w={label:X.name,value:R(X.id)??""};b("fixedAssetOption",w)},[b]),E=h.useCallback(async X=>{await v();const w={label:X.name,value:R(X.id)??""};b("vendorOption",w)},[b]),{createJournalWithCacheUpdate:D,createJournalSubmitting:x}=Fe(a),{updateJournalWithCacheUpdate:A,updateJournalSubmitting:F}=De(a),U=G(),q=h.useCallback(async X=>{X.preventDefault(),await U.submit();const{invalid:w}=U.getState();if(w)return;const J={selectedAccount:y.assetAccountOption,direction:Ce.CASH_OUT,type:j.FIXED_ASSET_PURCHASE,vendorId:y.vendorOption?.value?Number(y.vendorOption.value):null,fixedAssetId:y.fixedAssetOption?.value?Number(y.fixedAssetOption.value):null},re=Je(y,a,J,k?{hasJournal:k,journalId:a.journal?.id}:void 0);await(k?A(re):D(re)),!g?.settings?.shouldHideSuggestRule&&!r&&i(),o(void 0,!0)},[y,a,o]);return Be(),e.jsx(pe,{loading:l,children:e.jsxs("form",{className:N.form,onSubmit:q,children:[a.amount<=vl&&!n&&e.jsx(oe,{header:`Purchases of $2,500 or less may be eligible for the de minimis
                election.`,ctaText:"LEARN MORE",onCTAClick:()=>{t(!0)},ctaType:f?"stacked":"inline"}),n&&e.jsx(oe,{type:"info",header:`The IRS allows you to make a de minimis safe harbor election.
              Taxpayers making this election may expense, rather than
              capitalize, items costing up to $2,500. This typically reduces
              upfront taxes and simplifies record keeping. Use an expense to
              record these transactions in REI Hub if you will be making this
              common election.`,ctaText:"BOOK AS EXPENSE",onCTAClick:()=>{I(bc)},ctaType:f?"stacked":"inline"}),e.jsxs("div",{className:N.fields,children:[e.jsx(li,{fixedAssetOptions:c,onAddFixedAsset:C}),e.jsx(T,{name:"assetAccountOption",component:z,className:S(N.field,{[N.oneThird]:!f}),labelId:"asset-account",label:"Asset account*",options:d,placeholder:"Select one",validate:M}),e.jsx(jt,{vendorOptions:s,onVendorAdded:E})]}),e.jsx("div",{className:N.fields,children:e.jsx(T,{className:S(N.field,{[N.twoThirdsSmall]:!f}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})}),e.jsx(Me,{scopeOptions:u,unitOptions:m}),e.jsx(Oe,{}),e.jsx(Ae,{canCreateRule:!0,submitting:x||F})]})})},Nc=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({assetAccountOption:null,description:n.description,fixedAssetOption:null,notes:"",scopeOption:null,unitOption:null,uploadedDocuments:[],vendorOption:null}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(yc,{})})},Mt=[{label:P.MORTGAGE,value:P.MORTGAGE},{label:P.HARD_MONEY_LOAN,value:P.HARD_MONEY_LOAN},{label:P.HELOC,value:P.HELOC},{label:P.OTHER,value:P.OTHER}],Sc="Escrow amount must be less than total payment",[Un,xc]=hn("AddLoanModal"),Tc=({children:n,transaction:t,onClose:a,onAddLoan:o,onEditLoan:i,account:r,selectedLoanAccount:d,selectedLoanScope:l,selectedLoanUnit:u})=>{const c=!!d,s=d?.mortgageEscrowAccountId??null,m=de(tn,{variables:{filters:{type2In:[P.BANK,P.CREDIT_CARD,P.PROPERTY_MANAGEMENT,P.OWNER_FUNDS,P.HELOC,P.ACCOUNTS_PAYABLE,P.PREPAID_EXPENSE]}}}),v=de(tn,{variables:{filters:{default:Xi.AUTO_BALANCE}}}).data?.accounts[0],k=h.useMemo(()=>m.data?.accounts.map(E=>({label:E.name,value:E.id.toString()}))??[],[m.data?.accounts]),[g,f]=h.useState("loanInformation"),[b,y]=h.useState(c?{id:Number(R(d.id)),name:d.name,type:d.type,loanType:d.type2===P.LOAN?Mt.find(E=>E.value===P.OTHER)??null:Mt.find(E=>E.value===d.type2)??null,balance:d.lastCurrentBalance??0,monthlyPayment:d.mortgagePaymentAmount??0,interestRate:(d.mortgageInterestRate??0)*100,escrowPayment:d.mortgageEscrowTransferAmount??0,paymentAccount:null,openingBalanceDate:null,openingBalance:d.openingBalance??0,escrowOpeningBalance:0,autobookMatchingTransactions:d.autobookMatchingTransactions??!1,scopeSelect:l?{label:l.label,value:l.value.toString(),entityId:l.entityId?.toString(),propertyId:l.propertyId?.toString()}:null,unitSelect:u??null,organizationId:Number(t.organizationId),currentBalanceDate:d.lastCurrentBalanceDate?Ve(d.lastCurrentBalanceDate).format("MM/DD/YYYY"):null}:{name:"",type:Te.LIABILITY,loanType:null,balance:0,monthlyPayment:0,interestRate:null,escrowPayment:0,paymentAccount:null,openingBalanceDate:null,openingBalance:0,escrowOpeningBalance:0,autobookMatchingTransactions:!1,scopeSelect:null,unitSelect:null,organizationId:Number(t.organizationId)}),I=h.useMemo(()=>!d?.lastCurrentBalanceDate||d.lastCurrentBalance===void 0?null:`Last Verified Balance: ${d.lastCurrentBalance.toLocaleString("en-US",{style:"currency",currency:"USD"})} on ${Ve(d.lastCurrentBalanceDate).format("MM/DD/YYYY")}`,[d?.lastCurrentBalance,d?.lastCurrentBalanceDate]),C=h.useMemo(()=>({key:g,setKey:f,transaction:t,onClose:a,onAddLoan:o,onEditLoan:i,account:r,loan:b,setLoan:y,paymentAccountsData:m,paymentAccountOptions:k,selectedLoanAccount:d,isEditFlow:c,lastCurrentBalanceDateText:I,autoBalanceAccount:v,existingEscrowAccountId:s}),[g,f,t,a,o,i,b,y,m,k,d,c,I,v,s]);return e.jsx(xc.Provider,{value:C,children:n})},Ic="_2zfnP",jc="Gscky",Cc="jYS-W",Ac="onyEV",Oc="onmBZ",Fc="lhwI-",Dc="J-uSi",Ec="gsfxQ",wc="Y-Ydr",Rc="_2sQ1s",Lc="QROxQ",_c="YAaux",B={header:Ic,closeButton:jc,body:Cc,field:Ac,marginBottom:Oc,errorField:Fc,errorMessage:Dc,actions:Ec,actionButton:wc,alertContainer:Rc,alertContent:Lc,alertText:_c},Bc=({values:n,onSubmit:t,onClose:a,isEditFlow:o,lastCurrentBalanceDateText:i})=>{const{scopeOptions:r,unitOptions:d}=fe({scopeOption:n.scopeSelect,unitOption:n.unitSelect,handleUnitOptionChange:()=>{}}),l=gn();return e.jsxs("form",{onSubmit:u=>{t(u,n)},children:[e.jsxs("div",{className:B.header,children:[e.jsx(He,{children:o?"Edit loan":"Please enter your loan information"}),e.jsx(O,{variant:"ghost",size:"sm",icon:"close",onClick:()=>{a()},className:B.closeButton})]}),e.jsxs("div",{className:B.body,children:[e.jsx(T,{className:B.field,name:"name",component:K,label:"Loan name *",inputProps:{placeholder:"Loan name"},validate:M}),e.jsx(T,{name:"loanType",className:S(B.field,B.marginBottom),component:z,labelId:"loanType",label:"Loan type *",options:Mt,placeholder:"Select one",validate:M}),e.jsx(T,{name:"scopeSelect",className:S(B.field,B.marginBottom),component:z,labelId:"scopeSelect",label:"Portfolio/property *",options:r,placeholder:"Select one",validate:M}),d.length>0&&e.jsx(T,{name:"unitSelect",className:S(B.field,B.marginBottom),component:z,labelId:"unitSelect",label:"Unit *",options:d,placeholder:"Select one",validate:M}),e.jsx(T,{className:B.field,component:je,format:Ln,id:"balance",icon:()=>e.jsx(se,{name:"dollar"}),label:"Current loan balance *",name:"balance",parse:xn,validate:no,type:"text",onKeyDown:Ye}),o&&e.jsx(T,{className:S(B.field,B.marginBottom),name:"currentBalanceDate",component:nn,disableCalendar:l,label:"Date of current loan balance",helpText:i,onKeyDown:Ye})]}),e.jsxs("div",{className:B.actions,children:[e.jsx(O,{className:B.actionButton,variant:"outline",onClick:()=>{a()},children:"Cancel"}),e.jsx(O,{className:B.actionButton,variant:"fill",htmlType:"submit",children:"Next"})]})]})},Mc=()=>{const{loan:n,setLoan:t,setKey:a,onClose:o,isEditFlow:i,lastCurrentBalanceDateText:r}=Un(),d=h.useMemo(()=>({name:n.name,loanType:n.loanType,scopeSelect:n.scopeSelect,unitSelect:n.unitSelect,balance:n.balance,currentBalanceDate:n.currentBalanceDate}),[n]),l=u=>async(c,s)=>{c.preventDefault(),await u.submit();const{invalid:m}=u.getState();if(m)return;const p={...n,name:s.name,loanType:s.loanType,scopeSelect:s.scopeSelect,unitSelect:s.unitSelect,balance:Number(s.balance)};t(p),a("paymentTemplate")};return e.jsx(ne,{initialValues:d,onSubmit:()=>{},id:"loanInformationForm",children:({values:u,form:c})=>e.jsx(Bc,{values:u,onSubmit:l(c),onClose:o,isEditFlow:i,lastCurrentBalanceDateText:r??null})})},Pc=`mutation updateProperty($input: updatePropertyInput!) {
  updateProperty(input: $input) {
    ok
    property {
      id
      address1
      address2
      city
      state
      zip
      hasLoan
    }
  }
}
`,Uc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"updatePropertyInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateProperty"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"property"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address1"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address2"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"city"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"zip"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hasLoan"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:248,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Pc}}};function $c({hasEscrowAmount:n}){const{loan:t,onAddLoan:a,autoBalanceAccount:o,transaction:i}=Un(),{variables:r,totalTransactionsCount:d}=jn(),{closeInlineBooking:l}=V(),[u,c]=h.useState(null),[s,{loading:m}]=ae(Va),[p,{loading:v}]=ae(Uc),[k,{loading:g}]=ae(pn),[f,{loading:b}]=ae(Ha),[y]=bt(Nt),I=()=>({propertyId:t.scopeSelect?.propertyId?Number(t.scopeSelect.propertyId):null,entityId:t.scopeSelect?.entityId?Number(t.scopeSelect.entityId):null,unitId:t.unitSelect?.value&&t.unitSelect.value!=="all"?Number(t.unitSelect.value):null}),C=async()=>{try{const{data:F}=await s({variables:{input:{organizationId:t.organizationId,name:`Escrow for ${t.name}`,type:Te.ASSET,type2:P.ESCROW,...I()}}});return F?.createAccount.account??null}catch(F){c(F instanceof Error?F.message:"Failed to create escrow account")}},E=async F=>{const U={organizationId:t.organizationId,name:t.name,type:t.type,type2:t.loanType?.value===P.OTHER?P.LOAN:t.loanType?.value,...I(),mortgagePaymentAmount:t.monthlyPayment,mortgagePaymentAccountId:t.paymentAccount?.value?Number(R(t.paymentAccount.value)):null,mortgageInterestRate:t.interestRate?t.interestRate/100:null,mortgageEscrowTransferAmount:n?t.escrowPayment:null,mortgageEscrowAccountId:F?Number(R(F)):null,lastCurrentBalance:t.balance,lastCurrentBalanceDate:Ve().toISOString(),autobookMatchingTransactions:t.autobookMatchingTransactions};try{const{data:q}=await s({variables:{input:U}});return t.scopeSelect?.propertyId&&await p({variables:{input:{id:t.scopeSelect.propertyId,hasLoan:!0}}}),q?.createAccount.account??null}catch(q){return c(q instanceof Error?q.message:"Failed to create loan account"),null}},D=async(F,U)=>{const q={type:"credit",credit:Number(F.openingBalance),accountId:Number(R(U?.id))},X={type:"debit",debit:Number(F.openingBalance),accountId:Number(R(o?.id))},w={organizationId:t.organizationId,cash:!0,accrual:!0,type:Te.OPENING_BALANCE,amount:Number(F.openingBalance),date:F.openingBalanceDate,...I(),description:Te.OPENING_BALANCE,journalLines:[q,X]};try{await k({variables:{input:w}})}catch(J){c(J instanceof Error?J.message:"Failed to create opening balance journal")}},x=async(F,U)=>{const q={type:"credit",credit:Number(F.escrowOpeningBalance),accountId:Number(R(o?.id))},X={type:"debit",debit:Number(F.escrowOpeningBalance),accountId:Number(R(U.id))},w={organizationId:t.organizationId,cash:!0,accrual:!0,type:Te.OPENING_BALANCE,amount:Number(F.escrowOpeningBalance),date:F.openingBalanceDate,...I(),description:Te.OPENING_BALANCE,journalLines:[q,X]};try{await k({variables:{input:w}})}catch(J){c(J instanceof Error?J.message:"Failed to create escrow opening balance journal")}};return{handleUseAllMutations:async F=>{let U;if(n){const X=await C();U=X?.id,X&&F.escrowOpeningBalance&&await x(F,X)}const q=await E(U??null);if(F.openingBalance&&q&&await D(F,q),q){if(q.autobookMatchingTransactions){const X=await f({variables:{input:{organizationId:q.organizationId,loanAccountId:R(q.id),automationType:"bookLoanPayments",analysisAccounts:[q.mortgagePaymentAccountId]}}});if(X.data.runAutomations.autobookedTransactionsCount&&ge(`Loan created! ${X.data.runAutomations.autobookedTransactionsCount.toString()} ${X.data.runAutomations.autobookedTransactionsCount===1?"transaction":"transactions"} booked successfully based on your loan template`),(await y({variables:{...r??{},first:d}})).data?.transactions.edges.find(re=>re.node.id===i.id)?.node.journal){l();return}}a?.(q)}},error:u,loading:m||g||b||v}}const Vc=()=>{const{loan:n,setKey:t,onClose:a}=Un(),o=Z(),i=h.useMemo(()=>({openingBalanceDate:n.openingBalanceDate,openingBalance:n.openingBalance,escrowOpeningBalance:n.escrowOpeningBalance}),[n]),r=h.useMemo(()=>n.escrowPayment>0,[n.escrowPayment]),{handleUseAllMutations:d,error:l,loading:u}=$c({hasEscrowAmount:r});return e.jsx(ne,{initialValues:i,onSubmit:c=>{d(c)},children:({values:c,handleSubmit:s})=>{const m=!!(c.openingBalance??c.escrowOpeningBalance??c.openingBalanceDate);return e.jsxs("form",{onSubmit:p=>{p.preventDefault(),s(c)},children:[e.jsxs("div",{className:B.header,children:[e.jsx(He,{children:"Do you want to add an opening balance transaction for this loan?"}),e.jsx(O,{variant:"ghost",size:"sm",icon:"close",onClick:()=>{a()},className:B.closeButton})]}),e.jsxs("div",{className:B.body,children:[e.jsx("div",{className:B.alertContainer,children:e.jsx(oe,{type:"info",className:B.alertContent,children:e.jsx("span",{className:B.alertText,children:"Adding an opening balance transaction establishes the starting point to your loan account on your balance sheet. The opening balance is not the original loan amount; it is the outstanding amount as of the start of your record-keeping in TurboTenant."})})}),e.jsx(T,{className:B.field,name:"openingBalanceDate",component:nn,label:"Date",hint:m?null:"(Optional)",required:m,onKeyDown:Ye,disableCalendar:o}),e.jsx(T,{className:B.field,name:"openingBalance",component:je,icon:()=>e.jsx(se,{name:"dollar"}),hint:m?null:"(Optional)",label:"Loan opening balance amount",format:Ln,parse:xn,onKeyDown:Ye,required:m}),r&&e.jsx(T,{className:B.field,name:"escrowOpeningBalance",component:je,icon:()=>e.jsx(se,{name:"dollar"}),hint:"(Optional)",label:"Escrow opening balance amount",format:Ln,parse:xn,onKeyDown:Ye}),l&&e.jsx(oe,{type:"error",className:B.alertContent,children:e.jsx("span",{className:B.alertText,children:l})})]}),e.jsxs("div",{className:B.actions,children:[e.jsx(O,{className:B.actionButton,variant:"outline",disabled:u,onClick:()=>{t("paymentTemplate")},children:"Back"}),e.jsx(O,{className:B.actionButton,variant:"fill",htmlType:"submit",disabled:u,loading:u,children:"Save"})]})]})}})},ba=n=>({propertyId:n.scopeSelect?.propertyId?Number(n.scopeSelect.propertyId):null,entityId:n.scopeSelect?.entityId?Number(n.scopeSelect.entityId):null,unitId:n.unitSelect?.value&&n.unitSelect.value!=="all"?Number(n.unitSelect.value):null});function Jc(){const{onEditLoan:n,existingEscrowAccountId:t}=Un(),[a,o]=h.useState(null),[i,{loading:r}]=ae(Zi),[d,{loading:l}]=ae(Va),u=async(m,p)=>{const v=p.escrowPayment>0,k={organizationId:p.organizationId,id:p.id,name:p.name,type:p.type,type2:p.loanType?.value===P.OTHER?P.LOAN:p.loanType?.value,...ba(p),mortgagePaymentAmount:p.monthlyPayment,mortgagePaymentAccountId:p.paymentAccount?.value?Number(R(p.paymentAccount.value)):null,mortgageInterestRate:p.interestRate?p.interestRate/100:null,mortgageEscrowTransferAmount:v?p.escrowPayment:null,mortgageEscrowAccountId:null,lastCurrentBalance:p.balance,lastCurrentBalanceDate:Ve().toISOString()};t?k.mortgageEscrowAccountId=t:k.mortgageEscrowAccountId=m?Number(R(m)):null;try{const{data:g}=await i({variables:{input:k}});return g?.updateAccount.account??null}catch(g){return o(g instanceof Error?g.message:"Failed to update loan account"),null}},c=async m=>{try{const{data:p}=await d({variables:{input:{organizationId:m.organizationId,name:`Escrow for ${m.name}`,type:Te.ASSET,type2:P.ESCROW,...ba(m)}}});return p?.createAccount.account??null}catch(p){return o(p instanceof Error?p.message:"Failed to create escrow account"),null}};return{handleLoanUpdate:async m=>{let p;m.escrowPayment>0&&!t&&(p=(await c(m))?.id??null);const k=await u(p??null,m);return k&&n?.(k),null},error:a,loading:r||l}}const ya=(n,t)=>{const a=t?.monthlyPayment&&Number(t.monthlyPayment)>0,o=t?.interestRate&&Number(t.interestRate)>0,i=!!t?.paymentAccount;if([a,o,i].some(Boolean))return M(n)},zc=()=>{const{loan:n,setLoan:t,setKey:a,paymentAccountOptions:o,onClose:i,isEditFlow:r}=Un(),d=h.useMemo(()=>({monthlyPayment:n.monthlyPayment,interestRate:n.interestRate,escrowPayment:n.escrowPayment,paymentAccount:n.paymentAccount,autobookMatchingTransactions:n.autobookMatchingTransactions}),[n]),[l,u]=h.useState(null),{handleLoanUpdate:c,error:s,loading:m}=Jc(),p=g=>({...n,monthlyPayment:Number(g.monthlyPayment),interestRate:Number(g.interestRate),escrowPayment:Number(g.escrowPayment),paymentAccount:g.paymentAccount,autobookMatchingTransactions:g.autobookMatchingTransactions}),v=g=>{const f=p(g);t(f),a("openingBalance")},k=(g,f,b)=>{if(g.preventDefault(),b&&Number(f.escrowPayment)>=Number(f.monthlyPayment)){u(Sc);return}if(r){const y=p(f);c(y)}else v(f)};return e.jsx(ne,{initialValues:d,onSubmit:()=>{},children:({values:g})=>{const f=g,b=f.monthlyPayment&&Number(f.monthlyPayment)>0,y=f.interestRate&&Number(f.interestRate)>0,I=!!f.paymentAccount,C=[b,y,I].some(Boolean);return l&&Number(f.monthlyPayment)>Number(f.escrowPayment)&&u(null),e.jsxs("form",{onSubmit:E=>{k(E,g,C)},children:[e.jsxs("div",{className:B.header,children:[e.jsx(He,{children:"Please enter your payment template"}),e.jsx(O,{variant:"ghost",size:"sm",icon:"close",onClick:()=>{i()},className:B.closeButton})]}),e.jsxs("div",{className:B.body,children:[e.jsx("div",{className:B.alertContainer,children:e.jsx(oe,{type:"info",className:B.alertContent,children:e.jsx("span",{className:B.alertText,children:"This payment template lets TurboTenant automatically recognize and split mortgage payments into principal, interest, and escrow components for accurate cashflow tracking."})})}),e.jsx(T,{className:B.field,name:"monthlyPayment",component:je,icon:()=>e.jsx(se,{name:"dollar"}),label:C?"Monthly payment amount *":"Monthly payment amount",hint:C?null:"(Optional)",format:Ln,parse:xn,validate:ya,type:"text",onKeyDown:Ye}),e.jsx(T,{className:B.field,name:"interestRate",component:K,label:C?"Interest rate *":"Interest rate",hint:C?null:"(Optional)",type:"text",onKeyDown:Ye,validate:ya}),e.jsx(T,{className:S(B.field,{[B.errorField]:l}),name:"escrowPayment",component:je,icon:()=>e.jsx(se,{name:"dollar"}),label:"Monthly escrow amount",hint:"(Optional)",type:"text",onKeyDown:Ye,format:Ln,parse:xn}),l&&e.jsx("span",{className:B.errorMessage,children:l}),e.jsx(T,{name:"paymentAccount",className:S(B.field,B.marginBottom),component:z,labelId:"paymentAccount",label:"Payment account",hint:"(Optional)",options:o,placeholder:"Select one"}),e.jsx(T,{name:"autobookMatchingTransactions",component:en,type:"checkbox",label:"Automatically book matching loan payments"}),s&&e.jsx(oe,{type:"error",className:B.alertContent,children:e.jsx("span",{className:B.alertText,children:s})})]}),e.jsxs("div",{className:B.actions,children:[e.jsx(O,{className:B.actionButton,variant:"outline",onClick:()=>{a("loanInformation")},children:"Back"}),r?e.jsx(O,{className:B.actionButton,variant:"fill",htmlType:"submit",disabled:m,children:"Save"}):e.jsx(O,{className:B.actionButton,variant:"fill",htmlType:"submit",children:C?"Next":"Skip"})]})]})}})},qc=()=>{const{key:n}=Un();switch(n){case"loanInformation":return e.jsx(Mc,{});case"paymentTemplate":return e.jsx(zc,{});case"openingBalance":return e.jsx(Vc,{});default:return null}},Na=({onClose:n,transaction:t,onAddLoan:a,onEditLoan:o,selectedLoanAccount:i,selectedLoanScope:r,selectedLoanUnit:d})=>(Kn("overflow: hidden;"),e.jsx(_,{isOpen:!0,onClose:n,size:"lg",isDismissible:!1,isKeyboardDismissDisabled:!1,children:e.jsx(Tc,{transaction:t,onClose:n,onAddLoan:a,onEditLoan:o,selectedLoanAccount:i,selectedLoanScope:r,selectedLoanUnit:d,children:e.jsx(qc,{})})}));function Yc(){const{loading:n,data:t}=de(tn,{variables:{filters:{type2In:[P.MORTGAGE,P.HELOC,P.HARD_MONEY_LOAN,P.LOAN]}},fetchPolicy:"network-only"}),{transaction:a}=V(),{loading:o,data:i}=de(tn,{variables:{filters:{defaultIn:["otherInterestExpense","mortgageInterestExpense"]}}}),r=h.useMemo(()=>{if(t)return t.accounts.map(k=>({label:k.name,value:R(k.id)??""}))},[t]);r?.length&&!r.some(k=>k.value==="New Instance")&&r.unshift({label:"+ Add new",value:"New Instance"});const{change:d}=G(),{values:l}=Y(),{isLoading:u,scopeOptions:c,unitOptions:s}=fe({scopeOption:l.scopeOption,unitOption:l.unitOption,handleUnitOptionChange:k=>{d("unitOption",k)}}),m=n||u||o,{initializeFormValues:p,hasJournal:v}=Pe({accountOptions:r??[],accountFieldName:"loanAccountOption",isLoading:m,scopeOptions:c,unitOptions:s});return h.useEffect(()=>{p()},[p]),h.useEffect(()=>{if(!m&&v){const k=a.journal?.journal_lines?.find(b=>b.account.type2===P.ESCROW);k&&d("escrowAmount",k.type===Ie.DEBIT?Number(k.amount):-Number(k.amount));const g=a.journal?.journal_lines?.find(b=>b.account.type===Te.LIABILITY);d("principalAmount",g?.type===Ie.DEBIT?Number(g.amount):-Number(g?.amount));const f=a.journal?.journal_lines?.find(b=>b.account.type2===P.INTEREST_EXPENSE);d("interestAmount",f?.type===Ie.DEBIT?Number(f.amount):-Number(f?.amount))}},[v,m]),{isLoading:m,loanAccountsData:t,loanAccountOptions:r,scopeOptions:c,unitOptions:s,loanInterestAccountsData:i,hasJournal:v}}const Gc=`query getAccountJournalTotals(
  $type: String
  $type2: String
  $accountId: String
  $journalType: String
  $startDate: String
  $endDate: String
  $entityId: String
  $propertyId: String
) {
  accountJournalTotals(
    type: $type
    type2: $type2
    accountId: $accountId
    journalType: $journalType
    startDate: $startDate
    endDate: $endDate
    entityId: $entityId
    propertyId: $propertyId
  ) {
    id
    name
    totalDebits
    totalCredits
    netCredits
  }
}
`,Wc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getAccountJournalTotals"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type2"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accountId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"journalType"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"startDate"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"endDate"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accountJournalTotals"},arguments:[{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"Argument",name:{kind:"Name",value:"type2"},value:{kind:"Variable",name:{kind:"Name",value:"type2"}}},{kind:"Argument",name:{kind:"Name",value:"accountId"},value:{kind:"Variable",name:{kind:"Name",value:"accountId"}}},{kind:"Argument",name:{kind:"Name",value:"journalType"},value:{kind:"Variable",name:{kind:"Name",value:"journalType"}}},{kind:"Argument",name:{kind:"Name",value:"startDate"},value:{kind:"Variable",name:{kind:"Name",value:"startDate"}}},{kind:"Argument",name:{kind:"Name",value:"endDate"},value:{kind:"Variable",name:{kind:"Name",value:"endDate"}}},{kind:"Argument",name:{kind:"Name",value:"entityId"},value:{kind:"Variable",name:{kind:"Name",value:"entityId"}}},{kind:"Argument",name:{kind:"Name",value:"propertyId"},value:{kind:"Variable",name:{kind:"Name",value:"propertyId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalDebits"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalCredits"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"netCredits"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:522,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Gc}}},ri=12,Hc=n=>{let t=Number(n.mortgagePaymentAmount);return n.mortgageEscrowAccountId&&(t-=n.mortgageEscrowTransferAmount??0),t},Kc=(n,t)=>{const a=R(n.id);return n.lastCurrentBalanceDate&&t.date>n.lastCurrentBalanceDate?{startDate:Ve(n.lastCurrentBalanceDate).add(1,"days").format("YYYY-MM-DD"),endDate:t.date,accountId:a}:{startDate:t.date,endDate:n.lastCurrentBalanceDate,accountId:a}},Xc=(n,t,a,o)=>{if(n.lastCurrentBalanceDate&&t.date>n.lastCurrentBalanceDate)return Number(n.lastCurrentBalance)+Number(t.amount);const i=Number(o?.[0]?.netCredits??0),r=Number(n.mortgageInterestRate);return(Number(n.lastCurrentBalance)+a-i)/(1+r/ri)},Qc=(n,t)=>Math.round(n*t/ri*100)/100,Zc=(n,t,a,o)=>{n.change("principalAmount",Math.round((t-a)*100)/100),n.change("interestAmount",a),n.change("escrowAmount",Math.round(o*100)/100)},Sa=n=>{n.change("principalAmount",null),n.change("interestAmount",null),n.change("escrowAmount",null)};function ed({selectedLoanAccount:n,transaction:t,isLoanTemplateIncomplete:a,form:o,isInitialLoad:i,setIsInitialLoad:r}){const[d]=bt(Wc),l=h.useCallback(async()=>{if(!n)return null;const u=Hc(n),c=Kc(n,t),{data:s}=await d({variables:c}),m=Xc(n,t,u,s?.accountJournalTotals),p=Qc(m,n.mortgageInterestRate??0),v=n.mortgageEscrowTransferAmount??0;return{loanPI:u,interest:p,escrowAmount:v}},[n,t,d]);return h.useEffect(()=>{if(i&&n&&t.journal){r(!1);return}n&&n.mortgagePaymentAmount===t.amount&&!a?l().then(c=>{c?Zc(o,c.loanPI,c.interest,c.escrowAmount):Sa(o)}):Sa(o)},[n,t.amount,a,l,o]),{calculatePaymentAmounts:l}}const nd="The total does not match the expected payment amount",xa={MORTGAGE_INTEREST_EXPENSE:"mortgageInterestExpense",OTHER_INTEREST_EXPENSE:"otherInterestExpense"},td=(n,t)=>{if(n?.type2===P.MORTGAGE){const o=t?.accounts.find(i=>i.default===xa.MORTGAGE_INTEREST_EXPENSE)?.id??null;return Number(R(o))}const a=t?.accounts.find(o=>o.default===xa.OTHER_INTEREST_EXPENSE)?.id??null;return Number(R(a))},ad=({totalEnteredAmount:n,transaction:t,selectedLoanAccount:a,loanInterestAccountsData:o,setError:i,closeInlineBooking:r,hasJournal:d})=>{const{createJournalWithCacheUpdate:l,createJournalSubmitting:u}=Fe(t),{updateJournalWithCacheUpdate:c,updateJournalSubmitting:s}=De(t),m=(k,g,f)=>{const b={organizationId:Number(t.organizationId),type:j.LOAN_PAYMENT,cash:!0,accrual:!0,date:t.date,amount:Number(t.amount),description:"Loan Payment",notes:k.notes,attachmentURL:k.uploadedDocuments[0]?.attachmentURL??"",journalLines:f,...g};return d?{...b,id:Number(R(t.journal?.id))}:b},p=G();return{handleSubmit:h.useCallback(async(k,g)=>{k.preventDefault(),await p.submit();const{invalid:f}=p.getState();if(f)return;if(n!==t.amount){i(nd);return}const b=It(g),y={type:"credit",credit:Number(t.amount),debit:null,accountId:Number(t.accountId),yodleeTransactionId:Number(R(t.id))},I={type:"debit",credit:null,debit:Number(g.principalAmount),accountId:Number(g.loanAccountOption?.value),yodleeTransactionId:null},C=td(a,o),E={type:"debit",credit:null,debit:Number(g.interestAmount),accountId:C,yodleeTransactionId:null};let D=null;a?.mortgageEscrowAccountId&&(D={type:"debit",credit:null,debit:Number(g.escrowAmount),accountId:Number(a.mortgageEscrowAccountId),yodleeTransactionId:null});const x=[y,I,E];D&&x.push(D);const A=m(g,b,x);d?await c(A):await l(A),r(void 0,!0)},[n,t,a,o,i,r]),createJournalSubmitting:u,updateJournalSubmitting:s}},id=(n,t)=>{const[a,o]=h.useState(null);return{setScopeOption:h.useCallback(r=>{if(!r){o(null);return}const{entityId:d,propertyId:l}=r;let u="",c="",s=null;if(d&&!l){const m=n.find(v=>"options"in v&&v.options?.some(k=>k.entityId?.toString()===d.toString())),p=m&&"options"in m?m.options?.find(v=>v.entityId?.toString()===d.toString()):void 0;p&&"value"in p&&(u=p.label,c=p.value.toString(),s=p)}else if(l&&d){const m=n.find(v=>"options"in v&&v.options?.some(k=>k.propertyId?.toString()===l.toString())),p=m&&"options"in m?m.options?.find(v=>v.propertyId===r.propertyId):void 0;p&&"value"in p&&(u=p.label,c=p.value.toString(),s=p)}else if(l&&!d){const m=n.find(p=>"value"in p&&p.value.toString()===r.propertyId?.toString());m&&"value"in m&&(u=m.label,c=m.value.toString(),s=m)}else{const m=n.find(p=>"value"in p&&p.value.toString()==="all");m&&"value"in m&&(u=m.label,c=m.value.toString(),s=m)}o(s),t.change("scopeOption",{...s,label:u,value:c})},[n,t]),selectedScopeOption:a}},od=()=>{const{isLoading:n,loanAccountsData:t,loanAccountOptions:a,loanInterestAccountsData:o,scopeOptions:i,unitOptions:r,hasJournal:d}=Yc(),l=gn(),{values:u}=Y(),c=G(),{transaction:s,closeInlineBooking:m}=V(),[p,v]=h.useState(!1),[k,g]=h.useState(null),[f,b]=h.useState(null),[y,I]=h.useState(null),[C,E]=h.useState(null),[D,x]=h.useState(null),[A,F]=h.useState(!0),U=h.useMemo(()=>{const W=Number(u.principalAmount??0)+Number(u.interestAmount??0)+Number(u.escrowAmount??0);return Number(W.toFixed(2))},[u.principalAmount,u.interestAmount,u.escrowAmount]),{handleSubmit:q,createJournalSubmitting:X,updateJournalSubmitting:w}=ad({totalEnteredAmount:U,transaction:s,selectedLoanAccount:k,loanInterestAccountsData:o??null,setError:I,closeInlineBooking:m,hasJournal:d}),J=W=>{v(!1),E(W),g(W),c.change("loanAccountOption",{label:W.name,value:R(W.id)})},re=W=>{v(!1),x(W),g(W),c.change("loanAccountOption",{label:W.name,value:R(W.id)})},ze=h.useMemo(()=>{if(C)return[...a??[],{label:C.name,value:C.id}];if(D){const W=[...a??[]],Ee=W.findIndex(Cn=>Cn.value===D.id);return Ee!==-1&&(W[Ee]={label:D.name,value:D.id}),W}return a},[C,D,a]),Se=h.useMemo(()=>!k?.mortgagePaymentAmount||!k.lastCurrentBalance||!k.mortgageInterestRate||k.mortgageEscrowAccountId&&!k.mortgageEscrowTransferAmount,[k]);ed({selectedLoanAccount:k,transaction:s,isLoanTemplateIncomplete:!!Se,form:c,isInitialLoad:A,setIsInitialLoad:F});const{setScopeOption:vn,selectedScopeOption:kn}=id(i,c);return h.useEffect(()=>{U===s.amount&&I(null)},[U,s]),h.useEffect(()=>{if(!u.loanAccountOption||C||D)return;const W=t?.accounts.find(Ee=>R(Ee.id)===u.loanAccountOption?.value);g(W??null)},[u.loanAccountOption,t,C,D]),h.useEffect(()=>{A&&d||k&&vn(k)},[k]),h.useEffect(()=>{if(k&&r.length>0){let W;k.unitId?W=r.find(Ee=>Ee.value.toString()===k.unitId?.toString()):W=r.find(Ee=>Ee.value.toString()==="all"),W&&"value"in W&&(c.change("unitOption",{label:W.label,value:W.value}),b(W))}},[k,r]),h.useEffect(()=>{u.loanAccountOption?.value==="New Instance"&&v(!0)},[u.loanAccountOption]),!n&&!a?.length&&!C?e.jsxs(e.Fragment,{children:[p&&e.jsx(Na,{onClose:()=>{v(!1)},transaction:s,onAddLoan:J}),e.jsx("div",{className:N.form,children:e.jsx(oe,{header:"You must add a loan account before booking payments.",ctaText:"ADD A LOAN",ctaType:l?"stacked":"inline",onCTAClick:()=>{v(!0)}})})]}):e.jsxs(pe,{loading:n,children:[p&&e.jsx(Na,{onClose:()=>{v(!1)},transaction:s,onEditLoan:re,onAddLoan:J,selectedLoanAccount:k,selectedLoanScope:kn,selectedLoanUnit:f}),k&&Se&&e.jsx("div",{className:N.form,children:e.jsx(oe,{header:`Make it easy to track loan payments! Update your loan template to
              automatically split principal, interest, and escrow.`,ctaText:"UPDATE LOAN TEMPLATE",onCTAClick:()=>{v(!0)},ctaType:l?"stacked":"inline"})}),k&&!Se&&s.amount!==k.mortgagePaymentAmount&&e.jsx("div",{className:N.form,children:e.jsx(oe,{header:"This payment amount does not match your template",ctaText:"EDIT LOAN TEMPLATE",onCTAClick:()=>{v(!0)},ctaType:l?"stacked":"inline"})}),e.jsxs("form",{className:N.form,onSubmit:W=>{q(W,u)},children:[e.jsx("div",{className:N.fields,children:((ze?.length??0)>0||C)&&e.jsx(T,{name:"loanAccountOption",component:z,className:S(N.field,{[N.oneThird]:!l}),labelId:"loan-account",label:"Loan account*",options:ze,placeholder:"Select one",validate:M,onChange:W=>{E(null),x(null),c.change("loanAccountOption",W)}})}),e.jsx(Me,{scopeOptions:i,unitOptions:r}),k&&e.jsxs("div",{className:N.loanAmountFieldsContainer,children:[e.jsxs("div",{className:N.fields,children:[e.jsx(T,{className:S(N.field,{[N.oneThirdLoan]:!l}),component:je,icon:()=>e.jsx(se,{name:"dollar"}),label:"Principal amount",name:"principalAmount",inputProps:{placeholder:"0.00"},type:"number"}),e.jsx(T,{className:S(N.field,{[N.oneThirdLoan]:!l}),component:je,icon:()=>e.jsx(se,{name:"dollar"}),label:"Interest amount",name:"interestAmount",inputProps:{placeholder:"0.00"},type:"number"}),k.mortgageEscrowAccountId&&e.jsx(T,{className:S(N.field,{[N.oneThirdLoan]:!l}),component:je,icon:()=>e.jsx(se,{name:"dollar"}),label:"Escrow amount",name:"escrowAmount",inputProps:{placeholder:"0.00"},type:"number"})]}),e.jsxs("div",{className:N.amountsTextContainer,children:[e.jsx("span",{className:N.amountText,children:`Total assigned: $${U.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}),U!==s.amount&&U!==0&&e.jsx("span",{className:S(N.amountText,N.error),children:`Expected: $${s.amount.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`})]})]}),e.jsx(Oe,{}),y&&e.jsx(oe,{type:"error",header:y,children:" "}),e.jsx(Ae,{canCreateRule:!1,submitting:X||w})]})]})},sd=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({loanAccountOption:null,description:n.description,notes:"",scopeOption:null,unitOption:null,uploadedDocuments:[],principalAmount:null,interestAmount:null,escrowAmount:null,loanInterestAccountsData:[]}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},render:()=>e.jsx(od,{})})},ld=({revenueAccountOptions:n,expenseAccountOptions:t,isLoading:a,scopeOptions:o,unitOptions:i})=>{const{transaction:r}=V(),{journalValues:d,hasJournal:l}=ti(r),{initialize:u}=G(),{values:c}=Y(),{setScopeOption:s}=zt(o,d.propertyId??null,d.entityId??null),m=h.useCallback(()=>{if(!a)if(l){const p=s();if(d.type!==j.NET_INCOME){u({...c,scopeOption:p,description:d.description,notes:d.notes??""});return}const v=d.journalLines?.filter(f=>!f.yodleeTransactionId),k=v?.filter(f=>f.type==="credit"),g=v?.filter(f=>f.type==="debit");u({...c,scopeOption:p,description:d.description,notes:d.notes??"",revenues:k?.map(f=>({account:n.find(b=>b.value===f.accountId.toString()),amount:f.amount})),expenses:g?.map(f=>({account:t.find(b=>b.value===f.accountId.toString()),amount:f.amount}))})}else u({...c,scopeOption:o.length===1?o[0]:c.scopeOption})},[a,l,o.length]);return h.useEffect(()=>{l&&!a&&i.length&&u({...c,unitOption:d.unitId?i.find(p=>p.value===d.unitId?.toString()):i.find(p=>p.value==="all")})},[l,i,d.unitId]),h.useEffect(()=>{m()},[m]),{initializeNetIncomeFormValues:m}};function rd(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{type:j.REVENUE}}}),{accountOptions:a,isLoading:o}=ce({variables:{filters:{type:j.EXPENSE}}}),{change:i}=G(),{values:r}=Y(),{isLoading:d,scopeOptions:l,unitOptions:u}=fe({scopeOption:r.scopeOption,unitOption:r.unitOption,handleUnitOptionChange:m=>{i("unitOption",m)}}),c=t||o||d,{initializeNetIncomeFormValues:s}=ld({revenueAccountOptions:n,expenseAccountOptions:a,isLoading:c,scopeOptions:l,unitOptions:u});return h.useEffect(()=>{s()},[s]),{isLoading:c,revenueAccountOptions:n,expenseAccountOptions:a,scopeOptions:l,unitOptions:u}}function cd(){const{transaction:n,closeInlineBooking:t}=V(),{values:a}=Y(),o=G(),i=n,{createJournalWithCacheUpdate:r,loading:d}=Fe(i),{updateJournalWithCacheUpdate:l}=De(i);return{handleSubmit:h.useCallback(async c=>{c.preventDefault(),await o.submit();const{invalid:s}=o.getState();if(s)return;const m=It(a),p=a.revenues.reduce((x,A)=>x+Number(A.amount??0),0),v=a.expenses.reduce((x,A)=>x+Number(A.amount??0),0),k=a.revenues.some(({amount:x})=>x!==null)&&a.expenses.some(({amount:x})=>x!==null),g=Number((p-v).toFixed(2));if(k&&g!==Number(i.amount))return;const b={type:"debit",credit:null,debit:Number(i.amount),accountId:Number(i.accountId),yodleeTransactionId:Number(R(i.id))},y=a.revenues.filter(x=>x.account&&x.amount).map(x=>({type:"credit",credit:Number(x.amount),debit:null,accountId:Number(x.account?.value),yodleeTransactionId:null})),I=a.expenses.filter(x=>x.account&&x.amount).map(x=>({type:"debit",credit:null,debit:Number(x.amount),accountId:Number(x.account?.value),yodleeTransactionId:null})),E=k&&g===0&&Number(v)===Number(i.amount)?[b,...y]:[b,...y,...I];let D={organizationId:Number(i.organizationId),type:j.NET_INCOME,cash:!0,accrual:!0,date:i.date,amount:Number(i.amount),description:a.description,notes:a.notes,attachmentURL:a.uploadedDocuments[0]?.attachmentURL??"",journalLines:E,...m};i.journal?(D={...D,id:Number(R(i.journal.id))},await l(D)):await r(D),t(void 0,!0)},[a,i,o,r,t]),loading:d}}const dd="hSNlZ",ud="Ry3MV",md="_5EUt8",pd="FnMjE",hd="F2mos",gd="m2rdC",vd="yGG4e",kd="-f0Fq",fd="hRh70",ve={descriptionField:dd,twoColumnGroup:ud,card:md,cardFooter:pd,lines:hd,lineFields:gd,accountField:vd,amountField:kd,deleteButton:fd},bd=()=>{const{transaction:n}=V(),{values:t}=Y(),{isLoading:a,revenueAccountOptions:o,expenseAccountOptions:i,scopeOptions:r,unitOptions:d}=rd(),l=Z(),{handleSubmit:u,loading:c}=cd(),s=t.revenues.reduce((g,f)=>g+Number(f.amount??0),0),m=t.expenses.reduce((g,f)=>g+Number(f.amount??0),0),p=Number((s-m).toFixed(2)),k=t.revenues.some(({amount:g})=>g!==null)&&t.expenses.some(({amount:g})=>g!==null)&&p!==Number(n.amount);return Be(),e.jsx(pe,{loading:a,children:e.jsxs("form",{className:N.form,onSubmit:g=>{u(g)},"data-qa":"net-income-form",children:[e.jsx("div",{className:N.fields,children:e.jsx(T,{className:S(N.field,ve.descriptionField,{[N.twoThirds]:!l}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})}),e.jsx(Me,{scopeOptions:r,unitOptions:d}),e.jsxs("div",{className:ve.twoColumnGroup,children:[e.jsxs(Rn,{className:ve.card,"data-qa":"revenues-card",children:[e.jsx(He,{children:"Revenues"}),e.jsxs("div",{className:ve.lines,children:[e.jsx(at,{name:"revenues",children:({fields:g})=>g.map((f,b)=>e.jsxs("div",{className:ve.lineFields,children:[e.jsx(T,{component:z,className:ve.accountField,labelId:`rev-${String(b)}`,label:"Revenue account*",options:o,placeholder:"Select one",name:`${f}.account`,validate:M}),e.jsx(T,{component:je,name:`${f}.amount`,className:ve.amountField,icon:()=>e.jsx(se,{name:"dollar"}),label:"Amount",type:"number",inputProps:{placeholder:"0.00"},step:".01",pattern:"[0-9]*",inputMode:"decimal",formatOnBlur:!0,format:mt,validate:Sn(Yn,dt)}),g.length&&g.length>1&&e.jsx(O,{className:ve.deleteButton,size:"md",variant:"ghost",icon:"delete",type:"danger","aria-label":"Remove revenue line",onClick:()=>{g.remove(b)}})]},f))}),e.jsxs("div",{className:ve.cardFooter,children:[e.jsx(at,{name:"revenues",children:({fields:g})=>e.jsx(O,{size:"md",variant:"ghost",onClick:()=>{g.push({account:null,amount:null})},children:"Add Line"})}),"Revenues:"," ",`$${Number(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`]})]})]}),e.jsxs(Rn,{className:ve.card,"data-qa":"expenses-card",children:[e.jsx(He,{children:"Expenses"}),e.jsxs("div",{className:ve.lines,children:[e.jsx(at,{name:"expenses",children:({fields:g})=>g.map((f,b)=>e.jsxs("div",{className:ve.lineFields,children:[e.jsx(T,{component:z,className:ve.accountField,labelId:`exp-${String(b)}`,label:"Expense account*",options:i,placeholder:"Select one",name:`${f}.account`,validate:M}),e.jsx(T,{component:je,name:`${f}.amount`,className:ve.amountField,icon:()=>e.jsx(se,{name:"dollar"}),label:"Amount",type:"number",inputProps:{placeholder:"0.00"},step:".01",pattern:"[0-9]*",inputMode:"decimal",formatOnBlur:!0,format:mt,validate:Sn(Yn,dt)}),g.length&&g.length>1&&e.jsx(O,{className:ve.deleteButton,size:"lg",variant:"ghost",type:"danger",icon:"delete","aria-label":"Remove expense line",onClick:()=>{g.remove(b)}})]},f))}),e.jsxs("div",{className:ve.cardFooter,children:[e.jsx(at,{name:"expenses",children:({fields:g})=>e.jsx(O,{variant:"ghost",size:"md",onClick:()=>{g.push({account:null,amount:null})},children:"Add Line"})}),e.jsxs("div",{children:[e.jsxs(ie,{children:["Expenses:"," ",`$${Number(m).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`]}),e.jsxs(ie,{weight:"bold",className:"mt-10",children:["Net Amount:"," ",`$${Number(p).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`]})]})]})]})]})]}),e.jsx(Oe,{}),k&&e.jsx(oe,{type:"error",header:`Please double-check that the net amount for the transaction equals
            the net amount shown below the expenses.`}),e.jsx(Ae,{submitting:c,disabled:k})]})})},yd=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({description:n.description,notes:"",scopeOption:null,unitOption:null,uploadedDocuments:[],revenues:[{account:null,amount:null}],expenses:[{account:null,amount:null}]}),[n.description]);return e.jsx(ne,{onSubmit:()=>{},mutators:{...Li},initialValues:t,children:()=>e.jsx(bd,{})})};function Nd(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{type2:"Partner"}}}),{change:a}=G(),{transaction:o}=V(),i=o.description.toLowerCase().includes("turboTenant paym"),r=t,{initializeFormValues:d,hasJournal:l}=Pe({accountOptions:n,accountFieldName:"partnerAccountOption",isLoading:r,scopeOptions:[],unitOptions:[]});return h.useEffect(()=>{d()},[d]),h.useEffect(()=>{!r&&!l&&a("partnerAccountOption",i?n.find(u=>u.label.toLocaleLowerCase().includes("electronic")):n.find(u=>u.label.toLocaleLowerCase().includes("manual"))??null)},[r]),{isLoading:r,partnerAccountOptions:n,hasJournal:l}}const Sd=()=>{const{transaction:n,closeInlineBooking:t}=V(),{values:a}=Y(),{isLoading:o,partnerAccountOptions:i,hasJournal:r}=Nd(),d=Z(),{createJournalWithCacheUpdate:l,createJournalSubmitting:u}=Fe(n),{updateJournalWithCacheUpdate:c,updateJournalSubmitting:s}=De(n),m=G(),p=h.useCallback(async v=>{v.preventDefault(),await m.submit();const{invalid:k}=m.getState();if(k)return;const g={selectedAccount:a.partnerAccountOption,direction:Ce.CASH_IN,type:j.TRANSFER},f=Je(a,n,g,r?{hasJournal:r,journalId:n.journal?.id}:void 0);await(r?c(f):l(f)),t(void 0,!0)},[a,n,t]);return Be(),e.jsx(pe,{loading:o,children:e.jsxs("form",{className:N.form,onSubmit:p,children:[e.jsx(oe,{type:"info",header:`TurboTenant rent payments sync automatically. Only use this template
          if you manually received the funds outside of TurboTenant to avoid
          double-counting.`,ctaText:"LEARN MORE",ctaType:d?"stacked":"inline",onCTAClick:()=>{_i("https://support.reihub.net/en/collections/10110122-turbotenant-partner-integration/")}}),e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"partnerAccountOption",component:z,className:S(N.field,{[N.oneThird]:!d}),labelId:"partner-account",label:"Partner account*",options:i,placeholder:"Select one",validate:M}),e.jsx(T,{className:S(N.field,{[N.twoThirds]:!d}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})]}),e.jsx(Oe,{}),e.jsx(Ae,{canCreateRule:!1,submitting:u||s})]})})},xd=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({description:n.description,partnerAccountOption:null,notes:"",scopeOption:null,unitOption:null,uploadedDocuments:[]}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(Sd,{})})};function Td(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{or:[{type:"Revenue"},{type2:"Deferred Revenue"}]}}}),{change:a}=G(),{values:o}=Y(),{isLoading:i,scopeOptions:r,unitOptions:d}=fe({scopeOption:o.scopeOption,unitOption:o.unitOption,handleUnitOptionChange:s=>{a("unitOption",s)}}),l=t||i,{initializeFormValues:u,hasJournal:c}=Pe({accountOptions:n,accountFieldName:"refundAccountOption",isLoading:l,scopeOptions:r,unitOptions:d});return h.useEffect(()=>{u()},[u]),{isLoading:l,refundAccountOptions:n,scopeOptions:r,unitOptions:d,hasJournal:c}}const Id=()=>{const{transaction:n,closeInlineBooking:t}=V(),{values:a}=Y(),{createJournalWithCacheUpdate:o,createJournalSubmitting:i}=Fe(n),{updateJournalWithCacheUpdate:r,updateJournalSubmitting:d}=De(n),{isLoading:l,refundAccountOptions:u,scopeOptions:c,unitOptions:s,hasJournal:m}=Td(),p=Z(),v=G(),k=h.useCallback(async g=>{g.preventDefault(),await v.submit();const{invalid:f}=v.getState();if(f)return;const b={selectedAccount:a.refundAccountOption,direction:Ce.CASH_OUT,type:j.REFUND_ISSUED},y=Je(a,n,b,m?{hasJournal:m,journalId:n.journal?.id}:void 0);await(m?r(y):o(y)),t(void 0,!0)},[a,n,t]);return Be(),e.jsx(pe,{loading:l,children:e.jsxs("form",{className:N.form,onSubmit:k,children:[e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"refundAccountOption",component:z,className:S(N.field,{[N.oneThird]:!p}),labelId:"refund-account",label:"Refund account*",options:u,placeholder:"Select one",validate:M}),e.jsx(T,{className:S(N.field,{[N.twoThirds]:!p}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})]}),e.jsx(Me,{scopeOptions:c,unitOptions:s}),e.jsx(Oe,{}),e.jsx(Ae,{submitting:i||d})]})})},jd=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({description:n.description,refundAccountOption:null,notes:"",scopeOption:null,unitOption:null,uploadedDocuments:[]}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(Id,{})})},Ta=n=>n?isNaN(Number(n))?R(n):n:null;function Cd(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{or:[{type:"Expense"},{type2In:["Sales and Use Tax","Fixed Asset"]}]}}}),{fixedAssetOptions:a,isLoading:o,refetch:i}=Yt({isAddNewIncluded:!0}),{isLoading:r,refetch:d,vendorOptions:l}=Tt(),{change:u}=G(),{values:c}=Y(),{isLoading:s,scopeOptions:m,unitOptions:p}=fe({scopeOption:c.scopeOption,unitOption:c.unitOption,handleUnitOptionChange:f=>{u("unitOption",f)}}),v=t||o||r||s,{initializeFormValues:k,hasJournal:g}=Pe({accountOptions:n,accountFieldName:"refundAccountOption",isLoading:v,scopeOptions:m,unitOptions:p,vendorOptions:l,fixedAssetOptions:a});return h.useEffect(()=>{k()},[k]),{fixedAssetOptions:a,isLoading:v,refundAccountOptions:n,scopeOptions:m,unitOptions:p,vendorOptions:l,refetchFixedAssetOptions:i,refetchVendorOptions:d,hasJournal:g}}const Ad=()=>{const{transaction:n,closeInlineBooking:t}=V(),{values:a}=Y(),{fixedAssetOptions:o,isLoading:i,refundAccountOptions:r,scopeOptions:d,unitOptions:l,vendorOptions:u,refetchFixedAssetOptions:c,refetchVendorOptions:s,hasJournal:m}=Cd(),{change:p}=G(),{values:{refundAccountOption:v}}=Y(),k=Z(),{createJournalWithCacheUpdate:g,createJournalSubmitting:f}=Fe(n),{updateJournalWithCacheUpdate:b,updateJournalSubmitting:y}=De(n),I=G(),C=h.useCallback(async x=>{x.preventDefault(),await I.submit();const{invalid:A}=I.getState();if(A)return;const F={selectedAccount:a.refundAccountOption,direction:Ce.CASH_IN,type:j.REFUND,vendorId:a.vendorOption?.value?Number(Ta(a.vendorOption.value)):null,fixedAssetId:a.fixedAssetOption?.value?Number(Ta(a.fixedAssetOption.value)):null},U=Je(a,n,F,m?{hasJournal:m,journalId:n.journal?.id}:void 0);await(m?b(U):g(U)),t(void 0,!0)},[a,n,t]),E=async x=>{await c();const A={label:x.name,value:String(x.id)};p("fixedAssetOption",A)},D=h.useCallback(async x=>{await s();const A={label:x.name,value:R(x.id)??""};p("vendorOption",A)},[p]);return Be(),e.jsx(pe,{loading:i,children:e.jsxs("form",{className:N.form,onSubmit:C,children:[e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"refundAccountOption",component:z,className:S(N.field,{[N.oneThird]:!k}),labelId:"refund-account",label:"Refund account*",options:r,placeholder:"Select one",validate:M}),v?.type2==="Fixed Asset"&&e.jsx(li,{fixedAssetOptions:o,onAddFixedAsset:E}),e.jsx(jt,{vendorOptions:u,onVendorAdded:D})]}),e.jsx("div",{className:N.fields,children:e.jsx(T,{className:S(N.field,{[N.twoThirds]:!k}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})}),e.jsx(Me,{scopeOptions:d,unitOptions:l}),e.jsx(Oe,{}),e.jsx(Ae,{submitting:f||y})]})})},Od=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({description:n.description,fixedAssetOption:null,refundAccountOption:null,notes:"",scopeOption:null,unitOption:null,uploadedDocuments:[],vendorOption:null}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(Ad,{})})};function Fd(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{type:"Revenue"}}}),{change:a}=G(),{values:o}=Y(),{isLoading:i,scopeOptions:r,unitOptions:d}=fe({scopeOption:o.scopeOption,unitOption:o.unitOption,handleUnitOptionChange:s=>{a("unitOption",s)}}),l=t||i,{initializeFormValues:u,hasJournal:c}=Pe({accountOptions:n,accountFieldName:"revenueAccountOption",isLoading:l,scopeOptions:r,unitOptions:d});return h.useEffect(()=>{u()},[u]),{isLoading:l,revenueAccountOptions:n,scopeOptions:r,unitOptions:d,hasJournal:c}}const Dd={label:j.PARTNER_DEPOSIT,value:j.PARTNER_DEPOSIT},Ed=()=>{const{transaction:n,closeInlineBooking:t,handleSuggestRule:a,shouldCreateRule:o}=V(),{values:i}=Y(),{organization:r}=_e(),{handleTransactionTypeOptionChange:d}=on(),{isLoading:l,revenueAccountOptions:u,scopeOptions:c,unitOptions:s,hasJournal:m}=Fd(),p=Z(),{createJournalWithCacheUpdate:v,createJournalSubmitting:k}=Fe(n),{updateJournalWithCacheUpdate:g,updateJournalSubmitting:f}=De(n),b=G(),y=h.useCallback(async I=>{I.preventDefault(),await b.submit();const{invalid:C}=b.getState();if(C)return;const E={selectedAccount:i.revenueAccountOption,direction:Ce.CASH_IN,type:j.REVENUE},D=Je(i,n,E,m?{hasJournal:m,journalId:n.journal?.id}:void 0);await(m?g(D):v(D)),!r?.settings?.shouldHideSuggestRule&&!o&&a(),t(void 0,!0)},[i,n,t,m,a]);return Be(),e.jsx(pe,{loading:l,children:e.jsxs("form",{className:N.form,onSubmit:I=>y(I),children:[e.jsx(oe,{type:"info",header:`All paid invoices from TurboTenant automatically sync to Accounting. Use the deposit
          template if the funds are already marked as received in TurboTenant to avoid
          double-counting income.`,ctaText:"USE DEPOSIT TEMPLATE",ctaType:p?"stacked":"inline",onCTAClick:()=>{d(Dd)}}),e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"revenueAccountOption",component:z,className:S(N.field,{[N.oneThird]:!p}),labelId:"revenue-account",label:"Revenue account*",options:u,placeholder:"Select one",validate:M}),e.jsx(T,{className:S(N.field,{[N.twoThirds]:!p}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})]}),e.jsx(Me,{scopeOptions:c,unitOptions:s}),e.jsx(Oe,{}),e.jsx(Ae,{canCreateRule:!0,submitting:k||f})]})})},wd=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({description:n.description,notes:"",revenueAccountOption:null,scopeOption:null,unitOption:null,uploadedDocuments:[]}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(Ed,{})})};function Rd(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{type2:"Security Deposits"}}}),{change:a}=G(),{values:o}=Y(),{isLoading:i,scopeOptions:r,unitOptions:d}=fe({scopeOption:o.scopeOption,unitOption:o.unitOption,handleUnitOptionChange:s=>{a("unitOption",s)}}),l=t||i,{initializeFormValues:u,hasJournal:c}=Pe({accountOptions:n,accountFieldName:"securityDepositAccountOption",isLoading:l,scopeOptions:r,unitOptions:d});return h.useEffect(()=>{u()},[u]),{isLoading:l,scopeOptions:r,securityDepositAccountOptions:n,unitOptions:d,hasJournal:c}}const Ld=()=>{const{transaction:n,closeInlineBooking:t}=V(),{values:a}=Y(),{isLoading:o,scopeOptions:i,securityDepositAccountOptions:r,unitOptions:d,hasJournal:l}=Rd(),u=Z(),{createJournalWithCacheUpdate:c,createJournalSubmitting:s}=Fe(n),{updateJournalWithCacheUpdate:m,updateJournalSubmitting:p}=De(n),v=G(),k=h.useCallback(async g=>{g.preventDefault(),await v.submit();const{invalid:f}=v.getState();if(f)return;const b={selectedAccount:a.securityDepositAccountOption,direction:Ce.CASH_IN,type:ft.SECURITY_DEPOSIT_IN},y=Je(a,n,b,l?{hasJournal:l,journalId:n.journal?.id}:void 0);await(l?m(y):c(y)),t(void 0,!0)},[a,n,t]);return Be(),e.jsx(pe,{loading:o,children:e.jsxs("form",{className:N.form,onSubmit:k,children:[e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"securityDepositAccountOption",component:z,className:S(N.field,{[N.oneThird]:!u}),labelId:"security-deposit-account",label:"Security deposit account*",options:r,placeholder:"Select one",validate:M}),e.jsx(T,{className:S(N.field,{[N.twoThirds]:!u}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})]}),e.jsx(Me,{scopeOptions:i,unitOptions:d}),e.jsx(Oe,{}),e.jsx(Ae,{submitting:s||p})]})})},_d=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({description:n.description,notes:"",scopeOption:null,securityDepositAccountOption:null,unitOption:null,uploadedDocuments:[]}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(Ld,{})})};function Bd(){const{accountOptions:n,isLoading:t}=ce({variables:{filters:{type2:"Security Deposits"}}}),{change:a}=G(),{values:o}=Y(),{isLoading:i,scopeOptions:r,unitOptions:d}=fe({scopeOption:o.scopeOption,unitOption:o.unitOption,handleUnitOptionChange:s=>{a("unitOption",s)}}),l=t||i,{initializeFormValues:u,hasJournal:c}=Pe({accountOptions:n,accountFieldName:"securityDepositAccountOption",isLoading:l,scopeOptions:r,unitOptions:d});return h.useEffect(()=>{u()},[u]),{isLoading:l,scopeOptions:r,securityDepositAccountOptions:n,unitOptions:d,hasJournal:c}}const Md=()=>{const{transaction:n,closeInlineBooking:t}=V(),{values:a}=Y(),{createJournalWithCacheUpdate:o,createJournalSubmitting:i}=Fe(n),{updateJournalWithCacheUpdate:r,updateJournalSubmitting:d}=De(n),{isLoading:l,scopeOptions:u,securityDepositAccountOptions:c,unitOptions:s,hasJournal:m}=Bd(),p=Z(),v=G(),k=h.useCallback(async g=>{g.preventDefault(),await v.submit();const{invalid:f}=v.getState();if(f)return;const b={selectedAccount:a.securityDepositAccountOption,direction:Ce.CASH_OUT,type:ft.SECURITY_DEPOSIT_OUT},y=Je(a,n,b,m?{hasJournal:m,journalId:n.journal?.id}:void 0);await(m?r(y):o(y)),t(void 0,!0)},[a,n,t]);return Be(),e.jsx(pe,{loading:l,children:e.jsxs("form",{className:N.form,onSubmit:k,children:[e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"securityDepositAccountOption",component:z,className:S(N.field,{[N.oneThird]:!p}),labelId:"security-deposit-account",label:"Security deposit account*",options:c,placeholder:"Select one",validate:M}),e.jsx(T,{className:S(N.field,{[N.twoThirds]:!p}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})]}),e.jsx(Me,{scopeOptions:u,unitOptions:s}),e.jsx(Oe,{}),e.jsx(Ae,{submitting:i||d})]})})},Pd=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({description:n.description,securityDepositAccountOption:null,notes:"",scopeOption:null,unitOption:null,uploadedDocuments:[]}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx(Md,{})})};function Ud(){const{transaction:n}=on(),{accountOptions:t,isLoading:a}=ce({variables:{filters:{idNot:n.accountId,typeIn:["Asset","Equity","Liability"]}}}),{change:o}=G(),{values:i}=Y(),{isLoading:r,scopeOptions:d,unitOptions:l}=fe({scopeOption:i.scopeOption,unitOption:i.unitOption,handleUnitOptionChange:m=>{o("unitOption",m)}}),u=a||r,{initializeFormValues:c,hasJournal:s}=Pe({accountOptions:t,accountFieldName:"transferAccountOption",isLoading:u,scopeOptions:d,unitOptions:l});return h.useEffect(()=>{c()},[c]),{balanceSheetAccountOptions:t,isLoading:u,scopeOptions:d,unitOptions:l,hasJournal:s}}const $d=()=>{const{transaction:n,closeInlineBooking:t,handleSuggestRule:a,shouldCreateRule:o}=V(),{values:i}=Y(),{organization:r}=_e(),{balanceSheetAccountOptions:d,isLoading:l,scopeOptions:u,unitOptions:c,hasJournal:s}=Ud(),{createJournalWithCacheUpdate:m,createJournalSubmitting:p}=Fe(n),{updateJournalWithCacheUpdate:v,updateJournalSubmitting:k}=De(n),g=Z(),f=n.yodleeType===wn.CREDIT,b=G(),y=h.useCallback(async I=>{I.preventDefault(),await b.submit();const{invalid:C}=b.getState();if(C)return;const E={selectedAccount:i.transferAccountOption,direction:f?Ce.CASH_IN:Ce.CASH_OUT,type:j.TRANSFER},D=Je(i,n,E,s?{hasJournal:s,journalId:n.journal?.id}:void 0);await(s?v(D):m(D)),!r?.settings?.shouldHideSuggestRule&&!o&&a(),t(void 0,!0)},[i,n,f,m,t]);return Be(),e.jsx(pe,{loading:l,children:e.jsxs("form",{className:N.form,onSubmit:y,children:[e.jsxs("div",{className:N.fields,children:[e.jsx(T,{name:"transferAccountOption",component:z,className:S(N.field,{[N.oneThird]:!g}),labelId:"transfer-account",label:f?"Transfer from account*":"Transfer to account*",options:d,placeholder:"Select one",validate:M}),e.jsx(T,{className:S(N.field,{[N.twoThirds]:!g}),component:K,hint:"(Optional)",label:"Description",name:"description",placeholder:"Description"})]}),e.jsx(Me,{scopeOptions:u,unitOptions:c}),e.jsx(Oe,{}),e.jsx(Ae,{canCreateRule:!0,submitting:p||k})]})})},Vd=()=>{const{transaction:n}=V(),t=h.useMemo(()=>({description:n.description,notes:"",scopeOption:null,transferAccountOption:null,unitOption:null,uploadedDocuments:[]}),[n.description]);return e.jsx(ne,{initialValues:t,onSubmit:()=>{},children:()=>e.jsx($d,{})})},Jd=()=>{const{selectedTransactionTypeOption:n}=on();switch(n?.value){case j.EXPENSE:return e.jsx(Hr,{});case j.FIXED_ASSET_PURCHASE:return e.jsx(Nc,{});case j.REVENUE:return e.jsx(wd,{});case j.NET_INCOME:return e.jsx(yd,{});case j.CREDIT_CARD_PAYMENT:return e.jsx(Fr,{});case j.TRANSFER:case j.TRANSFER_FROM:case j.TRANSFER_TO:return e.jsx(Vd,{});case j.SECURITY_DEPOSIT_REFUND:return e.jsx(Pd,{});case j.SECURITY_DEPOSIT_RECEIVED:return e.jsx(_d,{});case j.DISTRIBUTION:return e.jsx(wr,{});case j.CONTRIBUTION:return e.jsx(Cr,{});case j.REFUND:return e.jsx(Od,{});case j.REFUND_ISSUED:return e.jsx(jd,{});case j.LOAN_PAYMENT:return e.jsx(sd,{});case j.PARTNER_DEPOSIT:return e.jsx(xd,{});default:return null}},zd="P6A4w",qd={container:zd},Yd=()=>{const{className:n,selectedTransactionTypeOption:t,transactionTypeOptions:a,handleTransactionTypeOptionChange:o}=on();return e.jsxs("div",{className:S(qd.container,n),children:[e.jsx(Wa,{transactionTypeOptions:a,selectedTransactionTypeOption:t,onTransactionTypeOptionChange:o}),e.jsx(Jd,{})]})},ci=({className:n})=>{const[t,a]=h.useState(),{transaction:o}=V(),{organization:i}=_e(),r=i?.vendorTracking??!1,d=kl({accountType:o.account.type,accountType2:o.account.type2,yodleeType:o.yodleeType}),l=h.useCallback(c=>{a(c)},[a]);fl({recommendedTransactionType:o.recommendedTransactionType,selectedTransactionTypeOption:t,transactionAmount:o.amount,transactionTypeOptions:d,handleTransactionTypeOptionChange:l});const u=h.useMemo(()=>({className:n,selectedTransactionTypeOption:t,transaction:o,transactionTypeOptions:d,vendorTracking:r,handleTransactionTypeOptionChange:l}),[n,t,o,d,r,l]);return e.jsx(bl.Provider,{value:u,children:e.jsx(Yd,{})})};function Gd(n){[46,8,9,27,13,188,190,110].includes(n.keyCode)||n.keyCode===65&&(n.ctrlKey||n.metaKey)||n.keyCode>=35&&n.keyCode<=40||n.key==="-"||(n.shiftKey||n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.preventDefault()}const Wd="_36F33",Hd="Zz0vm",Kd="Dgqz4",Xd="JF4PQ",Vn={header:Wd,warningColor:Hd,inputsRow:Kd,input:Xd},Qd=()=>{const{transaction:n,setIsEditTransactionModalVisible:t,editTransaction:a,isUpdatingTransaction:o}=V(),i=Z(),r=()=>{t?.(!1)},d=an(n.account.type,n.yodleeType);return e.jsxs(_,{isOpen:!0,isDismissible:!1,size:"lg",onClose:r,children:[e.jsx(_.Header,{children:"Edit Transaction"}),e.jsx(ne,{onSubmit:l=>{a?.(l)},initialValues:{date:Ve.utc(n.date).format("MM/DD/YYYY"),amount:Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(n.amount),description:n.description},subscription:{values:!0},children:({handleSubmit:l})=>e.jsxs("form",{onSubmit:l,children:[e.jsxs(_.Content,{className:"pb-16 pt-16",children:[e.jsxs(ie,{weight:"bold",uppercase:!0,color:"primary",children:[new Date(n.date).toLocaleDateString("en-US"),"  ",n.account.name]}),e.jsxs("div",{className:Vn.header,children:[e.jsx(Vt,{children:n.description}),e.jsx(Ze,{className:S({[Vn.warningColor]:d}),children:(function(){const c=String(Ge(n.amount));return d?`-${c}`:c})()})]}),e.jsxs("div",{className:Vn.inputsRow,children:[e.jsx(T,{className:Vn.input,name:"date",component:nn,label:"Transaction Date",disableCalendar:i,onKeyDown:Ye,validate:Sn(M,$a)}),e.jsx(T,{className:Vn.input,name:"amount",component:je,label:"Amount",type:"number",inputProps:{placeholder:"0.00"},step:".01",pattern:"[0-9]*",inputMode:"decimal",formatOnBlur:!0,format:mt,validate:Sn(Yn,dt),icon:"dollar",onKeyDown:Gd})]}),e.jsx(T,{name:"description",component:K,label:"Description",hint:"(Optional)"}),e.jsx(oe,{className:"mt-16",type:"error",header:"Editing may cause future reconciliation issues.",children:"Changes will overwrite imported data and cannot be undone."})]}),e.jsxs(_.Footer,{children:[e.jsx(_.SecondaryAction,{width:232,smWidth:"block",onClick:r,disabled:o,children:"Cancel"}),e.jsx(_.PrimaryAction,{width:232,smWidth:"block",htmlType:"submit",loading:o,children:"Save"})]})]})})]})},Zd="L6Ed-",eu="KeApM",Ia={contentHeader:Zd,warningColor:eu},nu=()=>{const{transaction:n,shouldCreateRule:t,setShouldCreateRule:a,setIsIgnoreTransactionModalVisible:o,ignoreTransaction:i,isUpdatingTransaction:r}=V(),d=()=>{o(!1)},l=an(n.account.type,n.yodleeType),u=()=>{ee("ignore clicked",{location:"import_feed tt"}),i()};return e.jsxs(_,{isOpen:!0,isDismissible:!1,size:"lg",onClose:d,children:[e.jsx(_.Header,{children:"Ignore Transaction"}),e.jsxs(_.Content,{className:"pb-16 pt-16",children:[e.jsxs(ie,{weight:"bold",uppercase:!0,color:"primary",children:[new Date(n.date).toLocaleDateString("en-US")," "," ",n.account.name]}),e.jsxs("div",{className:Ia.contentHeader,children:[e.jsx(Vt,{children:n.description}),e.jsx(Ze,{className:S({[Ia.warningColor]:l}),children:(function(){const s=String(Ge(n.amount));return l?`-${s}`:s})()})]}),e.jsx(en,{className:S("mt-16","mb-0"),wholeContainerClickable:!0,controlled:!0,label:"Create rule after saving",checked:t,onChange:()=>{a(!t)},"data-qa":"ignore-transaction-create-rule"})]}),e.jsxs(_.Footer,{children:[e.jsx(_.SecondaryAction,{width:232,smWidth:"block",onClick:d,children:"Cancel"}),e.jsx(_.PrimaryAction,{width:232,smWidth:"block",onClick:u,"data-qa":"ignore-transaction-submit",loading:r,children:"Ignore Transaction"})]})]})},tu="D2q1y",au="qN1Nx",ja={header:tu,warningColor:au},iu=()=>{const{setIsSplitTransactionModalVisible:n,shouldCreateRule:t,setShouldCreateRule:a,transaction:o,splitTransaction:i,isSplittingTransactions:r}=V(),{change:d}=G(),{values:l,submitting:u}=Y(),c=()=>{n(!1)},s=h.useMemo(()=>Math.abs(o.amount),[o.amount]),m=y=>{const I=gt(y.splitLines);return I===0||I===s?!1:s-I!==0},p=l.splitLines.filter(y=>!!y.amount).length>=2,v=m(l)&&p,k=u||gt(l.splitLines)===0||v,g=an(o.account.type,o.yodleeType),f=()=>{ee("split clicked",{location:"import_feed tt"})},b=y=>{y.preventDefault();const I=l.splitLines.map(C=>C.amount?Number(C.amount):0).filter(C=>C>0);i(I)};return e.jsxs(_,{isOpen:!0,isDismissible:!1,size:"lg",onClose:c,children:[e.jsx(_.Header,{children:"Split Transaction"}),e.jsxs("form",{onSubmit:y=>{b(y)},children:[e.jsxs(_.Content,{className:"pb-16 pt-16",children:[e.jsxs(ie,{weight:"bold",uppercase:!0,color:"primary",children:[new Date(o.date).toLocaleDateString("en-US"),"  ",o.account.name]}),e.jsxs("div",{className:ja.header,children:[e.jsx(Vt,{children:o.description}),e.jsx(Ze,{className:S({[ja.warningColor]:g}),children:(function(){const I=String(Ge(o.amount));return g?`-${I}`:I})()})]}),e.jsx(qa,{splitLines:l.splitLines,updateSplitLines:y=>{d("splitLines",y)}}),v&&e.jsx(oe,{className:"mt-16",type:"error",children:e.jsx(ie,{weight:"bold",children:"The split total must match the original transaction amount"})}),e.jsx(en,{className:"mt-16",controlled:!0,label:"Create rule after saving",checked:t,onChange:()=>{a(!t)},"data-qa":"split-transaction-create-rule",wholeContainerClickable:!0})]}),e.jsxs(_.Footer,{children:[e.jsx(_.SecondaryAction,{width:232,smWidth:"block",onClick:c,disabled:r,children:"Cancel"}),e.jsx(_.PrimaryAction,{width:232,smWidth:"block",disabled:k,"data-qa":"split-transaction-submit",htmlType:"submit",loading:r,onClick:f,children:"Split"})]})]})]})},ou=()=>{const n=h.useMemo(()=>({splitLines:[Xe(),Xe()]}),[]);return e.jsx(ne,{initialValues:n,subscription:{values:!0,submitting:!0},onSubmit:()=>{},children:()=>e.jsx(iu,{})})},su=()=>{const{setIsUnbookConfirmationModalVisible:n,unbookTransaction:t,isDeletingJournal:a}=V(),o=()=>{n(!1)},i=()=>{ee("unbooked clicked",{location:"import_feed tt"}),t()};return e.jsxs(Jt,{isOpen:!0,isDismissible:!1,size:"xs",onClose:o,children:[e.jsxs(_.Content,{children:[e.jsx(Ke,{children:"Are you sure you want to unbook this transaction?"}),e.jsx(ie,{children:"Undoing this transaction will delete the booked transaction and return imported transactions to your import feed."})]}),e.jsxs(_.Footer,{children:[e.jsx(_.SecondaryAction,{width:128,smWidth:"block",onClick:o,disabled:a,children:"Cancel"}),e.jsx(_.PrimaryAction,{width:128,smWidth:"block",onClick:i,loading:a,children:"Unbook"})]})]})},lu="uUT9b",ru="wEFSz",cu="FVA0Y",du="LboNK",uu="Lg8h-",mu="Vueah",pu="J6W0B",rn={modalContainer:lu,icon:ru,title:cu,text:du,buttonContainer:uu,button:mu,checkbox:pu},hu=()=>{Kn("overflow: hidden;");const[n,t]=h.useState(!1),[a]=ae(_n),o=async()=>{await a({variables:{input:{settings:{shouldHideUnsavedFormModal:!0}}}})},{closeInlineBooking:i,handleIsTemplateFormDirtyChange:r,handleIsUnsavedFormModalVisibleChange:d}=V(),l=async()=>{n&&await o(),d(!1)},u=async()=>{n&&await o(),r(!1),i(void 0,!0),d(!1)};return e.jsxs(_,{isOpen:!0,isDismissible:!1,className:rn.modalContainer,size:"sm",onClose:l,children:[e.jsx(wa,{className:rn.icon,name:"error",size:"lg"}),e.jsxs("div",{children:[e.jsx(Ke,{className:rn.title,children:"You have unsaved changes"}),e.jsx(ie,{className:rn.text,children:"Stay to keep your changes. If you leave, your changes will be lost."})]}),e.jsxs("div",{className:rn.buttonContainer,children:[e.jsx(O,{className:rn.button,type:"primary",variant:"outline",onClick:u,children:"Leave"}),e.jsx(O,{className:rn.button,onClick:l,children:"Stay"})]}),e.jsx(en,{className:rn.checkbox,input:{value:n,onChange:c=>{t(c.target.checked)}},label:"Don't show this again - future unsaved changes will be lost if you leave.",wholeContainerClickable:!0})]})},gu=()=>{const{setIsUnsplitConfirmationModalVisible:n,unsplitTransaction:t,isUnsplitting:a,splitChildrenCount:o,segmentTracking:i}=V(),r=()=>{n(!1),i("cancel clicked",{location:"unsplit modal"})},d=()=>{t(),i("unsplit clicked",{location:"unsplit modal"})};return e.jsxs(Jt,{isOpen:!0,isDismissible:!1,size:"md",onClose:r,iconColor:"error",children:[e.jsxs(_.Content,{children:[e.jsx(Ke,{align:"center",className:"mb-8",children:"Are you sure you want to unsplit this transaction?"}),e.jsxs(ie,{align:"center",children:["The unsplit transaction will be restored to your import feed in unbooked status and all"," ",e.jsxs("b",{children:[o," associated split transaction",o!==1?"s":""]})," ","will be deleted."]})]}),e.jsxs(_.Footer,{children:[e.jsx(_.SecondaryAction,{width:128,smWidth:"block",onClick:r,disabled:a,size:"sm",children:"Cancel"}),e.jsx(_.PrimaryAction,{width:128,smWidth:"block",onClick:d,loading:a,type:"danger",size:"sm",children:"Unsplit"})]})]})},di=()=>{const{isUnsavedFormModalVisible:n,isUnbookConfirmationModalVisible:t,isSplitTransactionModalVisible:a,isEditTransactionModalVisible:o,isIgnoreTransactionModalVisible:i,isUnsplitConfirmationModalVisible:r}=V();return e.jsxs(e.Fragment,{children:[n&&e.jsx(hu,{}),t&&e.jsx(su,{}),a&&e.jsx(ou,{}),o&&e.jsx(Qd,{}),i&&e.jsx(nu,{}),r&&e.jsx(gu,{})]})},vu="OjOgQ",ku="JRPW0",fu="widTs",bu="s-wzG",yu="sk7SQ",Nu="WMo-9",Su="j7AYV",xu="x-oJj",Tu="_2Ix-v",Iu="yZar6",ju="jskiL",Cu="MvA33",Au="PyFca",H={row:vu,canBeBooked:ku,isInlineBookingVisible:fu,rowColumn:bu,rowButton:yu,rowDefaultText:Nu,truncatedText:Su,rowSmallText:xu,splitLine:Tu,rowNegativeText:Iu,rowRow:ju,inlineBookingRowWrapper:Cu,trigger:Au},Ou=()=>{const{canBeBooked:n,hasAttachment:t,isAutoBooked:a,isBooked:o,isIgnored:i,isInlineBookingVisible:r,isSplitChild:d,isSplitParent:l,setIsUnsplitConfirmationModalVisible:u,transaction:c,closeInlineBooking:s,openInlineBooking:m,kebobActions:p,handleKebobAction:v,unignoreTransaction:k,isUpdatingTransaction:g}=V(),f=$t(),I=new URLSearchParams(f.search).get("transactionStatus")?.toUpperCase()===We.UNBOOKED;return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:S(H.row,{[H.canBeBooked]:n&&!r,[H.isInlineBookingVisible]:r}),tabIndex:n&&!r?0:-1,children:[e.jsx("td",{onClick:m,children:e.jsx("span",{className:H.rowDefaultText,children:Ve(c.date).format("M/DD/YYYY")})}),e.jsx("td",{onClick:m,children:e.jsxs("div",{className:S(H.rowColumn,{[H.splitLine]:d&&!I}),children:[e.jsxs("div",{className:H.rowRow,children:[l&&e.jsxs(e.Fragment,{children:[e.jsx(se,{name:"expand-horizontal",size:"lg",color:"primary","data-tooltip-id":"split-transaction-tooltip"}),e.jsx(ct,{id:"split-transaction-tooltip",type:"default",className:void 0,children:e.jsx("span",{children:"This is a split transaction."})})]}),t&&c.journal?.attachmentURL&&e.jsx(Bi,{target:"_blank",to:Bn(c.journal.attachmentURL.split("?")[0]),style:{textDecoration:"none"},children:e.jsx(se,{name:"attachment",size:"lg",color:"primary"})}),e.jsx("span",{className:S(H.rowDefaultText,H.truncatedText),children:d?`Split - ${c.description}`:c.description})]}),e.jsx("span",{className:S(H.rowSmallText,H.truncatedText),children:c.account.name})]})}),e.jsx("td",{onClick:m,children:c.journal&&e.jsxs("div",{className:H.rowColumn,children:[e.jsxs("div",{className:H.rowRow,children:[a&&e.jsxs(e.Fragment,{children:[e.jsx(se,{name:"lightning-filled",size:"lg","data-tooltip-id":"auto-booked-tooltip"}),e.jsx(ct,{id:"auto-booked-tooltip",type:"default",className:void 0,children:e.jsx("span",{children:"Booked by a rule."})})]}),e.jsx("span",{className:S(H.rowDefaultText,H.truncatedText),children:Za(c)})]}),c.journal.entityId&&!c.journal.propertyId&&e.jsx("span",{className:S(H.rowSmallText,H.truncatedText),children:c.journal.entity?.name}),c.journal.propertyId&&e.jsx("span",{className:S(H.rowSmallText,H.truncatedText),children:c.journal.property.address1}),c.journal.unitId&&e.jsx("span",{className:S(H.rowSmallText,H.truncatedText),children:c.journal.unit?.name})]})}),e.jsx("td",{onClick:m,children:e.jsx("span",{className:an(c.account.type,c.yodleeType)?H.rowNegativeText:H.rowDefaultText,children:an(c.account.type,c.yodleeType)?`-${Ge(c.amount)}`:Ge(c.amount)})}),e.jsx("td",{children:!r&&e.jsxs(e.Fragment,{children:[n&&e.jsx(O,{className:H.rowButton,size:"sm",onClick:m,children:"Book"}),l&&e.jsx(O,{className:H.rowButton,size:"sm",variant:"outline",onClick:()=>{u(!0)},children:"Unsplit"}),i&&e.jsx(O,{className:H.rowButton,loading:g,size:"sm",variant:"outline",onClick:k,children:"Unignore"}),o&&e.jsx(O,{className:H.rowButton,size:"sm",variant:"outline",onClick:C=>{m(C,!0)},children:"Edit"})]})}),e.jsxs("td",{children:[!l&&!i&&!r&&e.jsxs(ke,{closeOnClick:!0,className:H.dropdown,placement:"bottom-end",children:[e.jsx(ke.Trigger,{asChild:!0,children:e.jsx("div",{className:H.trigger,children:e.jsx(O,{"data-tooltip-id":`more-actions-${c.id}`,variant:"ghost",icon:"more-vertical",size:"lg",type:"secondary"})})}),e.jsx(ke.Content,{className:H.dropdownContent,children:p.map(({label:C,icon:E,type:D})=>e.jsx(ke.Item,{as:"button",className:H.dropdownItem,icon:E,danger:D==="delete",onClick:()=>{v(D)},children:C},`${D}-${C}`))})]}),r&&e.jsx(O,{variant:"ghost",icon:"close",size:"lg",onClick:s})]})]},c.id),r&&e.jsx("tr",{className:H.inlineBookingRowWrapper,children:e.jsx("td",{colSpan:100,children:e.jsx(ci,{})})}),e.jsx(ct,{id:`more-actions-${c.id}`,type:"default",className:void 0,children:"More actions"}),e.jsx(di,{})]})},Fu=({transaction:n,batchTargets:t,updateBatchTargets:a})=>e.jsx(ni,{transaction:n,batchTargets:t,updateBatchTargets:a,children:e.jsx(Ou,{})}),Du="uuIgS",Eu="Oovzx",wu="X2KFx",Ru="_80wU1",Lu="L2sG9",_u="Teap-",Bu="_6jPrT",Mu="DRNz2",Pu="DQsFV",Uu="Yw9y5",$u="Gr3hh",Vu="fYktw",Ju="OjMhO",zu="uadqa",qu="-BH-a",Yu="_5GfSf",te={row:Du,canBeBooked:Eu,isInlineBookingVisible:wu,rowContent:Ru,textColumn:Lu,truncatedText:_u,smallText:Bu,regularText:Mu,negativeRegularText:Pu,descriptionRowContainer:Uu,descriptionIcon:$u,autobookedIcon:Vu,buttonContainer:Ju,rowButton:zu,menuContainer:qu,inlineBookingWrapper:Yu},Gu=()=>{const{canBeBooked:n,isAutoBooked:t,isBooked:a,isIgnored:o,isInlineBookingVisible:i,isSplitChild:r,isSplitParent:d,transaction:l,openInlineBooking:u,kebobActions:c,unsplitTransaction:s,handleKebobAction:m,unignoreTransaction:p,isUpdatingTransaction:v,isUnsplitting:k}=V();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:S(te.row,{[te.canBeBooked]:n&&!i,[te.isInlineBookingVisible]:i}),tabIndex:n&&!i?0:-1,children:e.jsxs("div",{className:te.rowContent,children:[e.jsxs("div",{className:te.textColumn,onClick:u,onKeyDown:g=>{g.key==="Enter"&&u(g)},children:[e.jsx("span",{className:S(te.smallText,te.truncatedText),children:`${l.date}  ${l.account.name}`}),e.jsx("div",{children:e.jsxs("div",{className:te.descriptionRowContainer,children:[d&&e.jsx(se,{name:"expand-horizontal",size:"lg",color:"primary",className:te.descriptionIcon}),t&&e.jsx(se,{name:"lightning-filled",size:"lg",color:"primary",className:S(te.descriptionIcon,te.autobookedIcon)}),e.jsx("span",{className:S(te.regularText,te.truncatedText),children:a?Za(l):Vs(r,l)})]})}),e.jsx("span",{className:an(l.account.type,l.yodleeType)?te.negativeRegularText:te.regularText,children:an(l.account.type,l.yodleeType)?`-${Ge(l.amount)}`:Ge(l.amount)})]}),!i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:te.buttonContainer,children:[n&&e.jsx(O,{className:te.rowButton,onClick:u,children:"Book"}),d&&e.jsx(O,{className:te.rowButton,onClick:s,loading:k,variant:"outline",children:"Unsplit"}),o&&e.jsx(O,{className:te.rowButton,loading:v,variant:"outline",onClick:p,children:"Unignore"}),a&&e.jsx(O,{className:te.rowButton,onClick:g=>{u(g,!0)},variant:"outline",children:"Edit"})]}),e.jsx("div",{className:te.menuContainer,children:!d&&!o&&e.jsxs(ke,{closeOnClick:!0,className:te.dropdown,placement:"bottom-end",children:[e.jsx(ke.Trigger,{asChild:!0,children:e.jsx("div",{className:te.trigger,children:e.jsx(O,{variant:"ghost",icon:"more-vertical",size:"lg",type:"secondary"})})}),e.jsx(ke.Content,{className:te.dropdownContent,children:c.map(({label:g,icon:f,type:b})=>e.jsx(ke.Item,{as:"button",className:te.dropdownItem,icon:f,danger:b==="delete",onClick:()=>{m(b)},children:g},`${b}-${g}`))})]})})]})]})},l.id),i&&e.jsx(ci,{className:te.inlineBookingWrapper}),e.jsx(di,{})]})},Wu=({transaction:n,batchTargets:t,updateBatchTargets:a})=>e.jsx(ni,{transaction:n,batchTargets:t,updateBatchTargets:a,children:e.jsx(Gu,{})}),Hu="bNvOv",Ku={icon:Hu},Xu=({onResetFilters:n})=>e.jsx(Rn,{children:e.jsxs(Ne,{width:"fluid",size:"lg",children:[e.jsx(Ne.Icon,{name:"error",className:Ku.icon}),e.jsx(Ne.Title,{children:"No imported transactions were found"}),e.jsx(Ne.Description,{children:"Try adjusting your filter options to find what you are looking for or upload any new transactions"}),e.jsx(Ne.Actions,{children:e.jsx(O,{onClick:n,size:"sm",variant:"outline",children:"RESET ALL FILTERS"})})]})}),Qu="M80Qk",Zu="-c2oN",em="RbE2-",nm="_5OSGC",Jn={rentPaymentsSuccessModal:Qu,content:Zu,title:em,text:nm},tm=({onClose:n})=>e.jsx(_,{isOpen:!0,onClose:n,className:Jn.rentPaymentsSuccessModal,children:e.jsxs(_.Content,{className:Jn.content,children:[e.jsx(Ni,{style:{width:96,height:96}}),e.jsxs("div",{className:Jn.textContainer,children:[e.jsx(Ke,{className:Jn.title,children:"Your transactions are ready!"}),e.jsx(ie,{className:Jn.text,children:"We've pulled in your recent income and expenses. Next, you'll review and book them to keep your records accurate and tax-ready."})]}),e.jsx(O,{onClick:()=>{n()},variant:"fill",children:"View transactions"})]})}),am="prJux",im="CGV-g",om="GLOKf",sm="fm6SR",lm="_1xSXS",rm="_6b2Us",cm="_1iMEP",dm="iDEcx",cn={topControlsContainer:am,filterContainer:im,accountItem:om,accountItemText:sm,accountItemTextSubtitle:lm,editRulesButton:rm,applyDateButton:cm,dateRangeFilterMenuContainer:dm},um=[{label:it(We.UNBOOKED),value:We.UNBOOKED,component:"RadioButton"},{label:it(We.BOOKED),value:We.BOOKED,component:"RadioButton"},{label:it(We.SPLIT),value:We.SPLIT,component:"RadioButton"},{label:it(We.IGNORED),value:We.IGNORED,component:"RadioButton"}],mm=()=>{const n=Mi(Pi),{isUserAccountingSubscribed:t}=yt(),a=Mn(),o=In(),i=new URLSearchParams(a.search),r=i.get("transactionStatus")?i.get("transactionStatus").toUpperCase():null,d=()=>{const w=i.get("accountIds")||"";return w?w.split(",").filter(Boolean):[]},l=d(),u=i.get("startDate")??null,c=i.get("endDate")??null,[s,m]=h.useState(u&&c?zn.CUSTOM:null),[p,v]=h.useState(u?new Date(u):null),[k,g]=h.useState(c?new Date(c):null),{data:f,loading:b}=de(tn,{skip:!t,variables:{filters:{type2In:[P.BANK,P.CREDIT_CARD]}}}),y=h.useMemo(()=>(f?.accounts||[]).map(w=>({label:w.name,value:w.id??"",type2:w.type2,numericId:String(R(w.id??""))})),[f]),I=[{label:"All Accounts",value:"ALL"},...y],C=y.length>1,E=y.length>3,{data:D}=de(eo,{skip:!t}),x=h.useMemo(()=>{const w={};return(D?.unmatchedTransactions||[]).forEach(J=>{w[String(J.accountId)]=J.unmatchedTransactionCount||0}),w},[D]);let A=h.useMemo(()=>(D?.unmatchedTransactions||[]).reduce((w,J)=>w+(J.unmatchedTransactionCount||0),0),[D]);const F=w=>{const J=w.length?w[0]:null;J?i.set("transactionStatus",J.toLowerCase()):i.delete("transactionStatus");const re=i.toString();o(`${a.pathname}${re?`?${re}`:""}`)},U=w=>{w.length?i.set("accountIds",w.join(",")):i.delete("accountIds");const J=i.toString();o(`${a.pathname}${J?`?${J}`:""}`)},q=w=>{w===zn.CUSTOM?(i.set("dateFilterValue",w),i.set("startDate",p?.toString()??""),i.set("endDate",k?.toString()??"")):(i.delete("dateFilterValue"),i.delete("startDate"),i.delete("endDate"));const J=i.toString();o(`${a.pathname}${J?`?${J}`:""}`)},X=w=>{if(!w||w==="ALL"){ee("All_accounts clicked",{location:"Import Feed"});return}const J=y.findIndex(Se=>Se.value===w),re=["Filter_account_one clicked","Filter_account_two clicked","Filter_account_three clicked"],ze=J>=0&&J<re.length?re[J]:"All_accounts clicked";ee(ze,{location:"Import Feed"})};return e.jsxs(e.Fragment,{children:[C&&!n&&!E&&e.jsx(ma,{selectionType:"checkbox",hideSelectionControl:!0,className:"mb-16",selected:l.length?l:["ALL"],onChange:w=>{if(X(w),w==="ALL"){U([]);return}if(typeof w=="string"){const J=d(),ze=J.includes(w)?J.filter(Se=>Se!==w):[...J,w];U(ze)}},children:I.map(w=>{const J=w.value==="ALL"?A:x[w.numericId]||0,re=w.type2===P.CREDIT_CARD?"credit-card":"bank-account";return e.jsx(ma.Item,{value:w.value,children:e.jsxs("div",{className:cn.accountItem,children:[e.jsx(wa,{name:re,size:32}),e.jsxs("div",{className:cn.accountItemText,children:[e.jsx(wt,{weight:"bold",size:"small",children:w.label}),e.jsxs(wt,{color:"tertiary",size:"small",weight:"semi",className:cn.accountItemTextSubtitle,children:[J," ",J===1?"Unbooked transaction":"Unbooked transactions"]})]})]})},w.value)})}),e.jsxs("div",{className:cn.topControlsContainer,children:[e.jsxs("div",{className:cn.filterContainer,children:[(E||n)&&e.jsx(ut,{icon:"bank-account",iconProps:{width:18,height:18},filterName:"Accounts",allLabel:"All Accounts",options:y,selected:l,onChange:U,showApplyFiltersButton:!0,hideMultiline:!0,closeOnButtonsClick:!0,loading:b,staticFilterName:!0,onOpenFilter:()=>{ee("Accounts clicked",{location:"Import Feed"})}}),e.jsx(ut,{icon:"expense",iconProps:{width:18,height:18},filterName:"Status",allLabel:"All Transactions",staticFilterName:!0,selectionMode:"single",options:um,selected:r?[r]:[],showApplyFiltersButton:!0,hideMultiline:!0,closeOnButtonsClick:!0,onChange:F,loading:!1,hideSearch:!0,onOpenFilter:()=>{ee("Status clicked",{location:"Import Feed"})}}),e.jsx("div",{"data-qa":"import-feed-date-range-filter",children:e.jsx(zn,{icon:"calendar",iconsProps:{width:18,height:18},allLabel:"All Time",staticFilterName:!0,filterName:"Date Range",value:s,onChange:w=>{m(w),w!==zn.CUSTOM&&(v(null),g(null),q(w))},options:[],custom:e.jsxs("div",{className:cn.dateRangeFilterMenuContainer,children:[e.jsx(nn,{id:"start",input:{onChange:w=>{v(w)}},value:p,label:"Start","data-qa":"import-feed-date-range-start"}),e.jsx(nn,{id:"end",input:{onChange:w=>{g(w)}},value:k,label:"End","data-qa":"import-feed-date-range-end"}),e.jsx(O,{onClick:()=>{ee("apply_custom_dates clicked",{location:"Import Feed"}),q(s)},className:cn.applyDateButton,"data-qa":"import-feed-date-range-apply-custom-dates-button",children:"Apply custom dates"})]})})})]}),e.jsx(xt,{label:"Edit Rules",redirectPage:Lt.reiHub.rules,segmentLocation:"Transactions Import Feed",variant:"ghost",className:cn.editRulesButton})]})]})},pm="-wzwG",hm="N608m",gm="mxWWK",vm="OrIby",km="Xa5JR",fm="tB-P5",En={loadingScreen:pm,tableContainer:hm,table:gm,mobileTable:vm,backTopTop:km,desktopTable:fm},Ca=()=>e.jsxs(e.Fragment,{children:[e.jsx(qn,{skeleton:Gn,skeletonMobile:Wn}),e.jsx(qn,{skeleton:Gn,skeletonMobile:Wn})]}),bm=()=>{const{currentRuleData:n,currentTransaction:t,currentTransactionJournal:a,isAddRuleModalVisible:o,variables:i,isSuggestRuleModalVisible:r,updateIsAddRuleModalVisible:d,updateTotalTransactionsCount:l,updateCurrentRuleData:u,updateIsSuggestRuleModalVisible:c}=jn(),s=Z(),m=h.useRef(null),p=In(),{isUserAccountingSubscribed:v}=yt(),k=Mn(),g=new URLSearchParams(k.search),f=g.get("transactionStatus")?g.get("transactionStatus").toUpperCase():null,y=(()=>{const Q=g.get("accountIds")||"";return Q?Q.split(",").filter(Boolean):[]})(),{data:I,loading:C,fetchMore:E,networkStatus:D}=de(Nt,{variables:{...i,offset:0},skip:!v,notifyOnNetworkStatusChange:!0}),x=I?.transactions.edges.map(Q=>Q.node)||[],A=I?.transactions.pageInfo.hasNextPage||!1,F=D===Ra.fetchMore,U=x.length>pt&&!F,q=!!f||!!y?.length,X=h.useCallback(async()=>{!A||F||await E({variables:{...i,offset:x.length},updateQuery:(Q,{fetchMoreResult:sn})=>sn?{...Q,transactions:{...sn.transactions,edges:[...Q.transactions.edges,...sn.transactions.edges]}}:Q})},[A,F,E,x.length]),[w]=Ja({loading:F,hasNextPage:A,onLoadMore:X}),[J,re]=h.useState([]),[ze,Se]=h.useState(g.get("rentPayments")==="true"),vn=h.useCallback(()=>{m.current?m.current.scrollIntoView({behavior:"smooth",block:"start"}):window.scrollTo({top:0,behavior:"smooth"})},[]),{cardKey:kn,isSyncingTransactions:W,isTransactionsSkeletonVisible:Ee,handleClose:Cn}=Gi(),fn=Q=>{const sn=J.find(An=>An.id===Q.id);re(sn?J.filter(An=>An.id!==Q.id):[...J,Q])},Qn=()=>{Se(!1),p(k.pathname,{replace:!0})};h.useEffect(()=>{l(x.length)},[x.length]);const Zn=()=>{g.delete("transactionStatus"),g.delete("accountIds");const Q=g.toString();p(`${k.pathname}${Q?`?${Q}`:""}`)};return e.jsxs("div",{ref:m,children:[(x.length>0||q)&&e.jsx(mm,{onResetFilters:Zn}),Ee?e.jsx(go,{}):e.jsxs(pe,{loading:C&&!I&&!F,hideContent:!0,className:En.loadingScreen,children:[ze&&e.jsx(tm,{onClose:Qn}),e.jsx(Ms,{}),x.length===0&&q&&e.jsx(Xu,{onResetFilters:Zn}),x.length>0&&e.jsxs("div",{className:En.tableContainer,"data-qa":"all-transactions-table",children:[s?e.jsxs("div",{className:En.mobileTable,children:[x.map(Q=>e.jsx("div",{children:e.jsx(Wu,{transaction:Q,batchTargets:J,updateBatchTargets:()=>fn(Q)})},Q.id)),A&&e.jsx("div",{ref:w,children:F&&e.jsx(Ca,{})})]}):e.jsxs("div",{className:En.desktopTable,children:[e.jsx(qt,{className:En.table,headers:["Date","Description","Booked","Amount","Action",""],children:x.map(Q=>e.jsx(Fu,{transaction:Q,batchTargets:J,updateBatchTargets:()=>fn(Q)},Q.id))}),A&&e.jsx("div",{ref:w,children:F&&e.jsx(Ca,{})})]}),U&&e.jsxs("div",{className:En.backTopTop,children:[e.jsx(O,{onClick:vn,variant:"ghost",children:"Back to top"}),!A&&x.length>0&&e.jsx(ie,{children:"You've reached the end of this list."})]})]})]}),o&&e.jsx(cs,{ruleData:n,transaction:t,transactionJournal:a,onModalClosed:()=>{u(),d(!1)},onRuleAdded:()=>{u(),d(!1)}}),r&&e.jsx(nl,{onClose:()=>{c(!1)}}),e.jsx(Wi,{cardKey:kn,copies:Ki,isSyncingTransactions:W,titles:Hi,onClose:Cn})]})},ym=`query getJournals($filters: GetJournalsFiltersType, $shouldOnlyCount: Boolean) {
  journals(filters: $filters, shouldOnlyCount: $shouldOnlyCount) {
    ... on JournalCount {
      count
    }
    ... on JournalList {
      rows {
        id
        description
        notes
        date
        amount
        type
        cash
        accrual
        autobooked
        attachmentURL
        importedTransactionRuleId
        partnerPaymentId
        partnerDepositId
        partnerWithdrawalId
        partnerExpenseId
        partnerName
        recurringTransactionId
        organizationId
        propertyId
        unitId
        leaseId
        fixedAssetId
        vendorId
        entityId
        createdAt
        updatedAt
      }
    }
  }
}
`,Nm={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getJournals"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"NamedType",name:{kind:"Name",value:"GetJournalsFiltersType"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldOnlyCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"journals"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}},{kind:"Argument",name:{kind:"Name",value:"shouldOnlyCount"},value:{kind:"Variable",name:{kind:"Name",value:"shouldOnlyCount"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"JournalCount"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"JournalList"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"rows"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cash"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accrual"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"autobooked"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"attachmentURL"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"importedTransactionRuleId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerPaymentId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerDepositId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerWithdrawalId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerExpenseId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recurringTransactionId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"propertyId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unitId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"leaseId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fixedAssetId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vendorId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entityId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:796,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:ym}}},Sm="CD4or",xm="_0oyZa",Aa={container:Sm,text:xm},Tm={[mn.FIRST]:"Boom! Your first transaction is booked!  Our top 25% investors log in every two weeks to stay on top of accounting.",[mn.MORE_THAN_25]:"25+ transactions loggedyour books look solid.  Investors with clean books make smarter decisions.",[mn.MORE_THAN_50]:"50+ transactions and counting!  You're a bookkeeping pro. Keep building that financial clarity!",[mn.MORE_THAN_100]:"100+ transactions logged!  With books this organized, tax time will be a breeze!"},Im=({messageType:n,toastId:t})=>{const a=h.useCallback(()=>{Rt.dismiss(t)},[t]);return e.jsxs("div",{className:Aa.container,children:[e.jsx(ie,{className:Aa.text,children:Tm[n]}),e.jsx(O,{"aria-label":"Dismiss celebration bar",icon:"close",size:"sm",type:"reverse",variant:"ghost",onClick:a})]})},jm=n=>(Rt.dismiss(),Rt.custom(t=>e.jsx(Im,{messageType:n,toastId:t}),{...Qi,duration:8e3}));function Cm(){const{organization:n}=_e(),[t]=bt(Nm,{variables:{filters:{partnerPaymentId:null},shouldOnlyCount:!0},fetchPolicy:"network-only"}),[a]=ae(_n);return h.useCallback(async()=>{const i=n?.settings??{};if(Object.values(Fn).every(c=>i[c]))return;const{data:d}=await t(),l=d?.journals.count;let u=null;l&&(l<25&&!i[Fn.FIRST]&&(u=mn.FIRST),l>=25&&l<50&&!i[Fn.MORE_THAN_25]&&(u=mn.MORE_THAN_25),l>=50&&l<100&&!i[Fn.MORE_THAN_50]&&(u=mn.MORE_THAN_50),l>=100&&l<=150&&!i[Fn.MORE_THAN_100]&&(u=mn.MORE_THAN_100),u&&(jm(u),a({variables:{input:{settings:{...i,[Fn[u]]:!0}}}})))},[n,t,a])}const Am=()=>{const[n,t]=h.useState(!1),[a,o]=h.useState(!1),[i,r]=h.useState([]),[d,l]=h.useState(null),[u,c]=h.useState(),[s,m]=h.useState(),[p,v]=h.useState(0),[k,g]=h.useState(null),f=Mn(),b=new URLSearchParams(f.search),y=h.useMemo(()=>{const E=b.get("transactionStatus")?.toUpperCase()??null,D=b.get("accountIds")?.split(",").filter(Boolean)??[],x=b.get("startDate")??null,A=b.get("endDate")??null;return{first:pt,includeAccount:!0,includeJournal:!0,...E?{transactionStatus:E}:{},...D.length?{accountIds:D}:{},...x?{startDate:x}:{},...A?{endDate:A}:{}}},[f.search]),I=Cm(),C=h.useMemo(()=>({isAddRuleModalVisible:n,isSuggestRuleModalVisible:a,descriptionMatches:i,currentRuleData:d,currentTransaction:u,currentTransactionJournal:s,variables:y,totalTransactionsCount:p,getStartedChecklistId:k,updateIsSuggestRuleModalVisible:o,updateDescriptionMatches:r,updateCurrentRuleData:l,updateCurrentTransaction:c,updateCurrentTransactionJournal:m,updateJournalsCelebration:I,updateIsAddRuleModalVisible:t,updateTotalTransactionsCount:v,updateGetStartedChecklistId:g}),[n,a,i,d,u,s,n,y,p,k,I]);return e.jsx(Xo.Provider,{value:C,children:e.jsx(bm,{})})},[Xn,Om]=hn("Expenses"),Fm=`query getJournalLines(
  $first: Int
  $offset: Int
  $accountType: String
  $shouldIncludeAccount: Boolean = false
  $shouldIncludeJournal: Boolean = false
  $accountIds: [String!]
  $entityIds: [String!]
  $propertyIds: [String!]
  $unitIds: [String!]
  $startDate: String
  $endDate: String
) {
  journalLines(
    first: $first
    offset: $offset
    accountType: $accountType
    shouldIncludeAccount: $shouldIncludeAccount
    shouldIncludeJournal: $shouldIncludeJournal
    accountIds: $accountIds
    entityIds: $entityIds
    propertyIds: $propertyIds
    unitIds: $unitIds
    startDate: $startDate
    endDate: $endDate
  ) {
    pageInfo {
      hasNextPage
      endCursor
    }
    total
    edges {
      node {
        id
        type
        debit
        credit
        accountId
        journalId
        organizationId
        yodleeTransactionId
        amount
        reconciled
        account @include(if: $shouldIncludeAccount) {
          id
          name
          type
          type2
          default
          openingBalance
          openingBalanceDate
          mortgagePaymentAmount
          mortgageInterestRate
          mortgagePMIAmount
          mortgageEscrowTransferAmount
          autobookMatchingTransactions
          lastCurrentBalance
          lastCurrentBalanceDate
          nonDepreciable
          importStartDate
          partnerBankAccountId
          partnerName
          aziboAccountId
          inactive
          institutionName
          accountNumberMask
          organizationId
          plaidAccountId
          yodleeAccountId
          propertyManagerId
          propertyId
          unitId
          entityId
          mortgageEscrowAccountId
          mortgagePaymentAccountId
          parentAccountId
          createdAt
          updatedAt
        }
        journal @include(if: $shouldIncludeJournal) {
          id
          description
          notes
          date
          amount
          type
          cash
          accrual
          autobooked
          attachmentURL
          importedTransactionRuleId
          partnerPaymentId
          partnerDepositId
          partnerWithdrawalId
          partnerExpenseId
          partnerName
          recurringTransactionId
          organizationId
          propertyId
          unitId
          leaseId
          fixedAssetId
          vendorId
          entityId
          createdAt
          updatedAt
          property {
            id
            address1
            address2
            city
            state
            zip
            status
            inactive
          }
          unit {
            id
            name
            inactive
          }
          entity {
            id
            name
          }
          fixed_asset {
            id
            name
          }
          journal_lines {
            id
            type
            debit
            credit
            amount
            reconciled
            journalId
            accountId
            yodleeTransactionId
            account {
              id
              name
              type
              type2
            }
          }
        }
      }
    }
  }
}
`,Wt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getJournalLines"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accountType"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldIncludeAccount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldIncludeJournal"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accountIds"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityIds"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyIds"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"unitIds"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"startDate"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"endDate"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"journalLines"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"accountType"},value:{kind:"Variable",name:{kind:"Name",value:"accountType"}}},{kind:"Argument",name:{kind:"Name",value:"shouldIncludeAccount"},value:{kind:"Variable",name:{kind:"Name",value:"shouldIncludeAccount"}}},{kind:"Argument",name:{kind:"Name",value:"shouldIncludeJournal"},value:{kind:"Variable",name:{kind:"Name",value:"shouldIncludeJournal"}}},{kind:"Argument",name:{kind:"Name",value:"accountIds"},value:{kind:"Variable",name:{kind:"Name",value:"accountIds"}}},{kind:"Argument",name:{kind:"Name",value:"entityIds"},value:{kind:"Variable",name:{kind:"Name",value:"entityIds"}}},{kind:"Argument",name:{kind:"Name",value:"propertyIds"},value:{kind:"Variable",name:{kind:"Name",value:"propertyIds"}}},{kind:"Argument",name:{kind:"Name",value:"unitIds"},value:{kind:"Variable",name:{kind:"Name",value:"unitIds"}}},{kind:"Argument",name:{kind:"Name",value:"startDate"},value:{kind:"Variable",name:{kind:"Name",value:"startDate"}}},{kind:"Argument",name:{kind:"Name",value:"endDate"},value:{kind:"Variable",name:{kind:"Name",value:"endDate"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasNextPage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"endCursor"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"debit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"credit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"journalId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"yodleeTransactionId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reconciled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"account"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"shouldIncludeAccount"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type2"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"default"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"openingBalance"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"openingBalanceDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mortgagePaymentAmount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mortgageInterestRate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mortgagePMIAmount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mortgageEscrowTransferAmount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"autobookMatchingTransactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lastCurrentBalance"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lastCurrentBalanceDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nonDepreciable"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"importStartDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerBankAccountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"aziboAccountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inactive"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"institutionName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accountNumberMask"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plaidAccountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"yodleeAccountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"propertyManagerId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"propertyId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unitId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entityId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mortgageEscrowAccountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mortgagePaymentAccountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parentAccountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"journal"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"shouldIncludeJournal"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cash"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accrual"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"autobooked"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"attachmentURL"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"importedTransactionRuleId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerPaymentId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerDepositId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerWithdrawalId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerExpenseId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"partnerName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recurringTransactionId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organizationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"propertyId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unitId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"leaseId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fixedAssetId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vendorId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entityId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"property"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address1"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address2"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"city"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"zip"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inactive"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inactive"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"entity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"fixed_asset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"journal_lines"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"debit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"credit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reconciled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"journalId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"yodleeTransactionId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"account"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type2"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}]}}],loc:{start:0,end:3238,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Fm}}},Dm="Are you sure you want to delete this expense?",Em="Are you sure you want to unbook this expense?",wm="This expense will be removed.",Rm="Unbooking this expense will remove it from your books and return the transaction to your import feed as unbooked.",Lm="Delete",_m="Unbook",ui=({hasYodleeTransactionId:n})=>{const{setDeleteExpenseTarget:t,deleteExpenseTarget:a}=Xn(),[o,{loading:i}]=ae(ei,{variables:{input:{id:R(a?.journal.id)}},fetchPolicy:"no-cache",refetchQueries:[],awaitRefetchQueries:!1,update:d=>{d.modify({fields:{journalLines(l,{readField:u}){if("__ref"in l||!l.edges)return l;const c=l.edges.filter(s=>u("id",s.node)!==a?.id);return{...l,edges:c,total:l.total?l.total-1:0}}}})},onCompleted:()=>{ge(`Transaction ${n?"unbooked":"deleted"} successfully`),t(null)},onError:()=>{ye(`Failed to ${n?"unbook":"delete"} transaction`)}}),r=()=>{t(null)};return e.jsxs(Jt,{isOpen:!0,isDismissible:!1,size:"xs",onClose:r,children:[e.jsxs(_.Content,{children:[e.jsx(Ke,{children:n?Em:Dm}),e.jsx(ie,{children:n?Rm:wm})]}),e.jsxs(_.Footer,{children:[e.jsx(_.SecondaryAction,{width:128,smWidth:"block",onClick:r,loading:i,children:"Cancel"}),e.jsx(_.PrimaryAction,{width:128,smWidth:"block",onClick:()=>{ee(`${n?"unbook":"delete"} clicked`,{location:"Expenses"}),o()},loading:i,children:n?_m:Lm})]})]})},mi=n=>{const{journal:t}=n;return t.journal_lines?.find(o=>o.yodleeTransactionId)?"Unbook":"Delete"},Bm=n=>{const{journal:t}=n;return t.journal_lines?.find(o=>o.type==="credit")?.account.name},Mm="Vg-ul",Pm="iMNuG",Um="hFIBt",$m="YVBs2",Vm="KOlnK",Jm="_3V8Nm",zm="GLyb4",qm="_7QUqP",le={row:Mm,rowColumn:Pm,rowRow:Um,rowDefaultText:$m,rowSmallText:Vm,rowButton:Jm,kebabButton:zm,negativeText:qm},Ym=({expense:n,setExpenseToEdit:t,setIsAddEditModalOpen:a})=>{const{deleteExpenseTarget:o,setDeleteExpenseTarget:i}=Xn(),r=!!n.journal.journal_lines?.find(d=>d.yodleeTransactionId);return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:le.row,children:[e.jsx("td",{children:e.jsx("span",{className:S(le.rowDefaultText,le.truncatedText),children:Ve(n.journal.date).format("M/DD/YYYY")})}),e.jsx("td",{children:e.jsxs("div",{className:le.rowColumn,children:[e.jsxs("div",{className:le.rowRow,children:[n.journal.attachmentURL&&e.jsx(La,{target:"_blank",to:{pathname:Bn(n.journal.attachmentURL)},style:{textDecoration:"none"},children:e.jsx(se,{name:"attachment",size:"lg",color:"primary"})}),e.jsx("span",{className:S(le.rowDefaultText,le.truncatedText),children:n.journal.description||"---"})]}),e.jsxs("span",{className:S(le.rowSmallText,le.truncatedText),children:[n.journal.entityId&&!n.journal.propertyId&&n.journal.entity?.name,n.journal.propertyId&&n.journal.property.address1]}),n.journal.unitId&&e.jsx("span",{className:S(le.rowSmallText,le.truncatedText),children:n.journal.unit?.name})]})}),e.jsx("td",{children:e.jsxs("div",{className:le.rowColumn,children:[e.jsxs("div",{className:le.rowRow,children:[n.journal.autobooked&&e.jsxs(e.Fragment,{children:[e.jsx(se,{name:"lightning-filled",size:"lg","data-tooltip-id":"auto-booked-tooltip"}),e.jsx(ct,{id:"auto-booked-tooltip",type:"default",children:e.jsx("span",{children:"Booked by a rule."})})]}),e.jsx("span",{className:S(le.rowDefaultText,le.truncatedText),children:n.account.name})]}),e.jsx("span",{className:S(le.rowSmallText,le.truncatedText),children:Bm(n)})]})}),e.jsx("td",{children:e.jsx("span",{className:S(le.rowDefaultText,le.truncatedText,le.negativeText),children:`-${Ge(n.journal.amount)}`})}),e.jsx("td",{children:e.jsx(O,{size:"sm",variant:"outline",className:le.rowButton,onClick:()=>{t(n),a(!0)},children:"Edit"})}),e.jsx("td",{children:e.jsxs(ke,{closeOnClick:!0,className:le.dropdown,placement:"bottom-end",children:[e.jsx(ke.Trigger,{asChild:!0,children:e.jsx("div",{className:le.kebabButton,children:e.jsx(O,{variant:"ghost",icon:"more-vertical",size:"lg",type:"secondary"})})}),e.jsx(ke.Content,{children:e.jsx(ke.Item,{as:"button",icon:r?"cancel":"delete",onClick:()=>{i(n)},children:mi(n)})})]})})]}),o?.id===n.id&&e.jsx(ui,{hasYodleeTransactionId:r})]})};function Gm(){const[n,t]=ae(pn,{refetchQueries:[Wt]});return{createJournalWithCacheUpdate:h.useCallback(async o=>await n({variables:{input:o},onCompleted:()=>{ge("Expense added successfully")},onError:()=>{ye("Failed to add expense")}}),[n]),isCreateJournalSubmitting:t.loading}}function Wm(){const[n,t]=ae(Tn,{refetchQueries:[Wt]});return{updateJournalWithCacheUpdate:h.useCallback(async o=>await n({variables:{input:o},onCompleted:()=>{ge("Expense updated successfully")},onError:()=>{ye("Failed to update expense")}}),[n]),...t,isUpdateJournalSubmitting:t.loading}}function Hm({expenseToEdit:n=null}){const t=!!n,a=!!n?.journal.journal_lines?.find(A=>A.type===Ie.CREDIT)?.yodleeTransactionId||!!n?.journal.journal_lines?.find(A=>A.type===Ie.DEBIT)?.yodleeTransactionId,o=_e().organization?.vendorTracking??!1,{values:i}=Y(),{change:r,initialize:d}=G(),{data:l,loading:u}=de(tn,{variables:{filters:{type2In:[P.BANK,P.CREDIT_CARD,P.PROPERTY_MANAGEMENT,P.OWNER_FUNDS,P.HELOC,P.ACCOUNTS_PAYABLE,P.PREPAID_EXPENSE]}}}),{data:c,loading:s}=de(tn,{variables:{filters:{type:j.EXPENSE}}}),{data:m,loading:p,refetch:v}=de(Ya,{skip:!o}),k=m?.vendors??[],{isLoading:g,scopeOptions:f,unitOptions:b}=fe({scopeOption:i.scopeOption,unitOption:i.unitOption,handleUnitOptionChange:A=>{r("unitOption",A)}}),{setScopeOption:y}=zt(f,n?.journal.propertyId??null,n?.journal.entityId??null),I=u||s||p||g,C=h.useMemo(()=>l?.accounts.map(A=>({label:A.name,value:A.id.toString()}))??[],[l?.accounts]),E=h.useMemo(()=>c?.accounts.map(A=>({label:A.name,value:A.id.toString()}))??[],[c?.accounts]),D=h.useMemo(()=>k.map(A=>({label:A.name,value:A.id.toString()})),[k]),x=h.useCallback(()=>{if(!I)if(t){const A=n.journal.journal_lines?.find(q=>q.type===Ie.CREDIT)??null,F=n.journal.journal_lines?.find(q=>q.type===Ie.DEBIT)??null,U=y();d({...i,paymentAccountOption:C.find(q=>R(q.value)===A?.accountId.toString()),expenseAccountOption:E.find(q=>R(q.value)===F?.accountId.toString()),vendorOption:D.find(q=>R(q.value)===n.journal.vendorId?.toString())??null,date:Ve(n.journal.date).format("MM/DD/YYYY"),amount_paid:n.journal.amount,notes:n.journal.notes,description:n.journal.description,uploadedDocument:n.journal.attachmentURL?{name:Bn(n.journal.attachmentURL,!0),file:new File([],n.journal.attachmentURL),url:Bn(n.journal.attachmentURL)}:null,scopeOption:U})}else d({...i,scopeOption:f.length===1?f[0]:null})},[n,C.length,E.length,t,I,f.length]);return h.useEffect(()=>{x()},[x]),h.useEffect(()=>{if(t&&b.length){const A=b.find(F=>F.value===n.journal.unitId?.toString());d(A?{...i,unitOption:A}:{...i,unitOption:b.find(F=>F.value==="all")})}},[t,b.length,n?.journal.unitId]),{isLoading:I,isVendorTrackingEnabled:o,paymentAccountOptions:C,expenseAccountOptions:E,vendorOptions:D,scopeOptions:f,unitOptions:b,refetchVendors:v,hasYodleeTransactionId:a}}const Km=(n,t,a)=>{const o=a?.journal.journal_lines?.find(l=>l.type===Ie.CREDIT)?.yodleeTransactionId,i=a?.journal.journal_lines?.find(l=>l.type===Ie.DEBIT)?.yodleeTransactionId,r=It(n);return{organizationId:t,date:n.date,amount:Number(n.amount_paid),type:j.EXPENSE,cash:!0,accrual:!0,attachmentURL:n.uploadedDocument?.url??"",description:n.description,notes:n.notes,vendorId:n.vendorOption?.value?Number(R(n.vendorOption.value)):null,journalLines:[{type:Ie.CREDIT,credit:Number(n.amount_paid),accountId:Number(R(n.paymentAccountOption?.value)),yodleeTransactionId:o?Number(o):null},{type:Ie.DEBIT,debit:Number(n.amount_paid),accountId:Number(R(n.expenseAccountOption?.value)),yodleeTransactionId:i?Number(i):null}],...a?.journal.id?{id:R(a.journal.id)}:{},...r}},Xm="nINf4",Qm="kxxZd",Zm="os0St",ep="bm-SS",np="i4xZq",tp="UUtNw",ap="GFl75",Ue={field:Xm,docsTitle:Qm,uploadContainer:Zm,loadingContainer:ep,uploadedFile:np,nameWrapper:tp,name:ap},ip=({expenseToEdit:n,isEditFlow:t,onClose:a,isSubmitting:o})=>{const i=gn(),{isLoading:r,paymentAccountOptions:d,expenseAccountOptions:l,vendorOptions:u,isVendorTrackingEnabled:c,scopeOptions:s,unitOptions:m,refetchVendors:p,hasYodleeTransactionId:v}=Hm({expenseToEdit:n});Kn("overflow: hidden;");const{change:k}=G(),[g,f]=h.useState(null),[b,y]=h.useState(!1),I=async E=>{y(!0);const D=await Ma({fileName:E.name}),x=D.url??D.urls?.[0];if(!x)throw new Error("Missing S3 upload URL");await Pa(x,E);const A=`${x.endpoint_url}/${x.params.key}`,F={name:E.name,file:E,url:A};f(F),k("uploadedDocument",F),y(!1)},C=h.useCallback(async E=>{await p();const D={label:E.name,value:R(E.id)??""};k("vendorOption",D)},[k,p]);return h.useEffect(()=>{f(n?.journal.attachmentURL?{name:Bn(n.journal.attachmentURL,!0),file:new File([],n.journal.attachmentURL),url:Bn(n.journal.attachmentURL)}:null)},[n]),e.jsxs(pe,{loading:r,children:[e.jsx(_.Header,{children:n?"Edit Expense":"Add Expense"}),e.jsxs(_.Content,{children:[e.jsx(T,{label:"Date *",name:"date",component:nn,validate:Sn(M,$a),placeholder:"MM/DD/YYYY",disableCalendar:i}),e.jsx(T,{label:"Amount paid *",name:"amount_paid",component:je,validate:Sn(M,Yn),icon:()=>e.jsx(se,{name:"dollar"}),placeholder:"0.00"}),e.jsx(T,{label:"Portfolio/property *",name:"scopeOption",component:z,options:s,validate:M,className:Ue.field}),m.length>0&&e.jsx(T,{label:"Unit *",name:"unitOption",component:z,options:m,validate:M,className:Ue.field}),e.jsx(T,{label:"Expense account *",name:"expenseAccountOption",component:z,options:l,validate:M,className:Ue.field}),e.jsx(T,{label:"Payment account *",name:"paymentAccountOption",component:z,options:d,validate:M,isDisabled:t&&v,className:Ue.field}),c&&e.jsx("div",{className:Ue.field,children:e.jsx(jt,{vendorOptions:u,onVendorAdded:C})}),e.jsx(T,{label:"Description",name:"description",component:K,hint:"(Optional)",placeholder:"Description"}),e.jsx(T,{component:K,label:"Notes",name:"notes",hint:"(Optional)",placeholder:"Notes",as:"textarea"}),e.jsx(Ze,{className:Ue.docsTitle,children:"Attachments"}),!g&&e.jsxs("div",{className:Ue.uploadContainer,children:[b&&e.jsx("div",{className:Ue.loadingContainer,children:e.jsx(Si,{secondary:!0,className:Ue.spinner})}),e.jsx(T,{label:i?"Tap to upload":"Click or drag to upload",id:"uploadedDocument",name:"uploadedDocument",component:Ua,multiple:!1,accept:Ui.join(","),onFileDrop:E=>{I(E[0])}})]}),g&&e.jsxs("div",{className:Ue.uploadedFile,children:[e.jsxs("div",{className:Ue.nameWrapper,children:[e.jsx(se,{name:"document",color:"close-lightbg"}),e.jsx(La,{className:Ue.name,target:"_blank",to:{pathname:g.url},children:g.name})]}),e.jsx(O,{icon:"delete",variant:"ghost",type:"danger",onClick:()=>{f(null),k("uploadedDocument",null)}})]})]}),e.jsxs(_.Footer,{children:[e.jsx(O,{variant:"outline",size:"lg",width:232,smWidth:"block",onClick:a,disabled:o,children:"Cancel"}),e.jsx(O,{variant:"fill",size:"lg",width:232,smWidth:"block",htmlType:"submit",loading:o,onClick:()=>{ee(`${t?"save":"add_expense"} clicked`,{location:"expense modal"})},children:t?"Save":"Add Expense"})]})]})},Oa=({onClose:n,expenseToEdit:t,refetchJournalLines:a})=>{const o=!!t,{organization:i}=_e(),{createJournalWithCacheUpdate:r,isCreateJournalSubmitting:d}=Gm(),{updateJournalWithCacheUpdate:l,isUpdateJournalSubmitting:u}=Wm(),c=h.useMemo(()=>({date:"",amount_paid:"",paymentAccountOption:null,expenseAccountOption:null,vendorOption:null,scopeOption:null,unitOption:null,notes:"",uploadedDocument:null,description:""}),[]),s=h.useCallback(async p=>{const v=Km(p,Number(R(i?.id)),t||void 0);await(t?l(v):r(v)),a&&a(),n()},[i?.id,t,r,l,a,n]),m=d||u;return e.jsx(_,{isOpen:!0,onClose:n,size:"lg",isDismissible:!1,children:e.jsx(ne,{initialValues:c,onSubmit:s,subscription:{submitting:!0,values:!0},children:({handleSubmit:p})=>e.jsx("form",{onSubmit:p,children:e.jsx(ip,{expenseToEdit:t,isEditFlow:o,onClose:n,isSubmitting:m})})})})},Pt="All properties",Ut="All accounts",Fa={CUSTOM:"CUSTOM"},op="E-VVt",sp="KdspJ",lp="peOSw",Dt={filtersContainer:op,dateRangeFilterMenuContainer:sp,applyDateButton:lp},rp=()=>{const{propertyOptions:n,expenseAccountOptions:t,filterVariables:a}=Xn(),o=Mn(),i=new URLSearchParams(o.search),r=In(),[d,l]=h.useState(a.dateFilterValue??""),[u,c]=h.useState(a.startDate?new Date(a.startDate):null),[s,m]=h.useState(a.endDate?new Date(a.endDate):null),p=b=>{b.length?i.set("propertyIds",b.join(",")):i.delete("propertyIds");const y=i.toString();r(`${o.pathname}${y?`?${y}`:""}`)},v=b=>{b.length?i.set("accountIds",b.join(",")):i.delete("accountIds");const y=i.toString();r(`${o.pathname}${y?`?${y}`:""}`)},k=b=>{b===Fa.CUSTOM?(i.set("dateFilterValue",b),i.set("startDate",u?.toString()??""),i.set("endDate",s?.toString()??"")):(i.delete("dateFilterValue"),i.delete("startDate"),i.delete("endDate"));const y=i.toString();r(`${o.pathname}${y?`?${y}`:""}`)},g=()=>{const b=i.get("propertyIds")??"";return b?b.split(",").filter(Boolean):[]},f=()=>{const b=i.get("accountIds")??"";return b?b.split(",").filter(Boolean):[]};return e.jsxs("div",{className:Dt.filtersContainer,children:[e.jsx(ut,{icon:"properties",iconProps:{width:18,height:18},filterName:"Property",allLabel:"All Properties",options:n.filter(b=>b.value!==Pt),onChange:b=>{p(b)},selected:g(),showApplyFiltersButton:!0,hideMultiline:!0,closeOnButtonsClick:!0,staticFilterName:!0,selectionMode:"multiple"}),e.jsx(ut,{icon:"bank-account",iconProps:{width:18,height:18},filterName:"Accounts",allLabel:"All Accounts",options:t.filter(b=>b.value!==Ut),onChange:b=>{v(b)},selected:f(),showApplyFiltersButton:!0,hideMultiline:!0,closeOnButtonsClick:!0,staticFilterName:!0,selectionMode:"multiple"}),e.jsx(zn,{icon:"calendar",iconProps:{width:18,height:18},allLabel:"All Time",staticFilterName:!0,filterName:"Date Range",value:a.dateFilterValue?a.dateFilterValue:d,onChange:b=>{l(b),b!==Fa.CUSTOM&&(c(null),m(null),k(b))},options:[],custom:e.jsxs("div",{className:Dt.dateRangeFilterMenuContainer,children:[e.jsx(nn,{id:"start",input:{onChange:b=>{c(b)}},value:u,label:"Start"}),e.jsx(nn,{id:"end",input:{onChange:b=>{m(b)}},value:s,label:"End"}),e.jsx(O,{onClick:()=>{k(d)},className:Dt.applyDateButton,children:"Apply custom dates"})]})})]})},cp="UF8pT",dp="yDYo6",up="vllTe",mp="gmU-Z",pp="jtYdy",hp="-KhLs",gp="XU-VJ",vp="LLXoX",kp="e-GPd",fp="_-1iyh",bp="Cblup",yp="pk-92",he={mobileRow:cp,rowContent:dp,textColumn:up,smallText:mp,regularText:pp,truncatedText:hp,negative:gp,descriptionRowContainer:vp,autobookedIcon:kp,buttonContainer:fp,rowButton:bp,menuContainer:yp},Np=({expense:n,setExpenseToEdit:t,setIsAddEditModalOpen:a})=>{const{deleteExpenseTarget:o,setDeleteExpenseTarget:i}=Xn(),r=!!n.journal.journal_lines?.find(d=>d.yodleeTransactionId);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:he.mobileRow,children:e.jsxs("div",{className:he.rowContent,children:[e.jsxs("div",{className:he.textColumn,children:[e.jsx("span",{className:S(he.smallText,he.truncatedText),children:`${Ve(n.journal.date).format("M/DD/YYYY")}  ${n.account.name}`}),e.jsxs("div",{className:he.descriptionRowContainer,children:[n.journal.autobooked&&e.jsx(se,{name:"lightning-filled",className:he.autobookedIcon}),e.jsx("span",{className:S(he.regularText,he.truncatedText),children:n.journal.description||"---"})]}),e.jsx("span",{className:S(he.regularText,he.truncatedText,he.negative),children:`-${Ge(n.journal.amount)}`})]}),e.jsx("div",{className:he.buttonContainer,children:e.jsx(O,{variant:"outline",className:he.rowButton,onClick:()=>{t(n),a(!0)},children:"Edit"})}),e.jsx("div",{className:he.menuContainer,children:e.jsxs(ke,{closeOnClick:!0,className:he.dropdown,placement:"bottom-end",children:[e.jsx(ke.Trigger,{asChild:!0,children:e.jsx("div",{className:he.kebabButton,children:e.jsx(O,{variant:"ghost",icon:"more-vertical",size:"lg",type:"secondary"})})}),e.jsx(ke.Content,{children:e.jsx(ke.Item,{as:"button",icon:r?"cancel":"delete",onClick:()=>{i(n)},children:mi(n)})})]})})]})}),o?.id===n.id&&e.jsx(ui,{hasYodleeTransactionId:r})]})},Sp="/assets/accounting-expenses-empty-state-W7D2F3lO.svg",xp="Transactions Expenses",Tp=({onAddManualExpense:n})=>{const t=gn(),a=In();return e.jsx(Rn,{children:e.jsxs(Ne,{width:t?"narrow":"wide",size:"md",children:[e.jsx(Ne.Image,{src:Sp,alt:"empty-state"}),e.jsxs(Ne.Title,{children:["Start tracking your rental finances! "," "]}),e.jsx(Ne.Description,{children:"Expenses help you track property performance and stay on track for tax season."}),e.jsxs(Ne.Actions,{children:[e.jsx(O,{size:"lg",variant:"fill",onClick:()=>{ee("import_automatically clicked",{location:xp}),a("/owners/accounting/link")},children:"Import Automatically"}),e.jsx(O,{size:"lg",variant:"ghost",onClick:()=>{n()},children:"Add Manual Expense"})]})]})})},Ip="kzxBf",jp={icon:Ip},Cp=({onResetFilters:n})=>e.jsx(Rn,{children:e.jsxs(Ne,{width:"fluid",size:"lg",children:[e.jsx(Ne.Icon,{name:"error",className:jp.icon}),e.jsx(Ne.Title,{children:"No expenses were found"}),e.jsx(Ne.Description,{children:"Try adjusting your filter options to find what you are looking for."}),e.jsx(Ne.Actions,{children:e.jsx(O,{onClick:n,size:"sm",variant:"outline",children:"RESET ALL FILTERS"})})]})}),Ap="OGVge",Op="_3BY-J",Fp="DRLVV",Dp="XxEGM",Ep="btmEd",wp="jyfZP",Rp="_9S3DF",dn={topBar:Ap,addExpenseButton:Op,loadingScreen:Fp,tableContainer:Dp,desktopTable:Ep,mobileTable:wp,backToTopSection:Rp},Da=()=>e.jsxs(e.Fragment,{children:[e.jsx(qn,{skeleton:Gn,skeletonMobile:Wn}),e.jsx(qn,{skeleton:Gn,skeletonMobile:Wn})]}),Lp=()=>{const{filterVariables:n,isFilterActive:t}=Xn(),a={first:pt,offset:0,shouldIncludeAccount:!0,shouldIncludeJournal:!0,accountType:"Expense",...n},o=gn(),i=In(),r=$t(),d=new URLSearchParams(r.search),l=h.useRef(null),{data:u,loading:c,fetchMore:s,networkStatus:m,refetch:p}=de(Wt,{variables:{...a},notifyOnNetworkStatusChange:!0}),v=u?.journalLines.edges.map(F=>F.node)??[],k=u?.journalLines.pageInfo.hasNextPage??!1,g=m===Ra.fetchMore,f=v.length>pt&&!g,[b,y]=h.useState(!1),[I,C]=h.useState(null),E=h.useCallback(async()=>{!k||g||await s({variables:{...a,offset:v.length},updateQuery:(F,{fetchMoreResult:U})=>({...F,journalLines:{...U.journalLines,edges:[...F.journalLines.edges,...U.journalLines.edges]}})})},[k,g,s,v.length]),[D]=Ja({loading:g,hasNextPage:k,onLoadMore:E}),x=h.useCallback(()=>{l.current?l.current.scrollIntoView({behavior:"smooth",block:"start"}):window.scrollTo({top:0,behavior:"smooth"})},[]),A=()=>{d.delete("accountIds"),d.delete("propertyIds"),d.delete("dateFilterValue"),d.delete("startDate"),d.delete("endDate");const F=d.toString();i(`${r.pathname}${F?`?${F}`:""}`)};return v.length===0&&!c&&!t?e.jsxs(e.Fragment,{children:[b&&e.jsx(Oa,{onClose:()=>{y(!1),C(null)},expenseToEdit:I??void 0,refetchJournalLines:p}),e.jsx(Tp,{onAddManualExpense:()=>{y(!0)}})]}):e.jsxs(e.Fragment,{children:[b&&e.jsx(Oa,{onClose:()=>{y(!1),C(null)},expenseToEdit:I??void 0,refetchJournalLines:p}),e.jsxs("div",{ref:l,children:[e.jsxs("div",{className:dn.topBar,children:[e.jsx(rp,{}),e.jsx(O,{variant:"ghost",icon:"plus",iconPosition:"start",size:"lg",className:dn.addExpenseButton,onClick:()=>{y(!0)},children:"Add expense"})]}),e.jsxs(pe,{loading:c&&!u&&!g,hideContent:!0,className:dn.loadingScreen,children:[v.length===0&&t&&e.jsx(Cp,{onResetFilters:A}),v.length>0&&e.jsxs("div",{className:dn.tableContainer,children:[o?e.jsxs("div",{className:dn.mobileTable,children:[v.map(F=>e.jsx(Np,{expense:F,setExpenseToEdit:C,setIsAddEditModalOpen:y},F.id)),k&&e.jsx("div",{ref:D,children:g&&e.jsx(Da,{})})]}):e.jsxs("div",{className:dn.desktopTable,children:[e.jsx(qt,{className:dn.table,headers:["Date","Description","Accounts","Amount","Action",""],children:v.map(F=>e.jsx(Ym,{expense:F,setExpenseToEdit:C,setIsAddEditModalOpen:y},F.id))}),k&&e.jsx("div",{ref:D,children:g&&e.jsx(Da,{})})]}),f&&e.jsxs("div",{className:dn.backToTopSection,children:[e.jsx(O,{onClick:x,variant:"ghost",children:"Back to top"}),!k&&v.length>0&&e.jsx(ie,{children:"You've reached the end of this list."})]})]})]})]})]})},_p=()=>{const[n,t]=h.useState(null),a=de(St),o=h.useMemo(()=>[{label:Pt,value:Pt},...a.data?.properties.map(f=>({label:f.address1,value:f.id}))??[]],[a.data?.properties]),i=de(tn,{variables:{filters:{type:j.EXPENSE}}}),r=h.useMemo(()=>[{label:Ut,value:Ut},...i.data?.accounts.map(f=>({label:f.name,value:f.id}))??[]],[i.data?.accounts]),d=Mn(),l=new URLSearchParams(d.search),u=l.get("accountIds")?.split(",").filter(Boolean)??[],c=l.get("propertyIds")?.split(",").filter(Boolean)??[],s=l.get("startDate")??"",m=l.get("endDate")??"",p=l.get("dateFilterValue")??"",v=h.useMemo(()=>({...u.length?{accountIds:u.map(f=>f)}:{},...c.length?{propertyIds:c.map(f=>f)}:{},...s.length?{startDate:s}:{},...m.length?{endDate:m}:{},...p.length?{dateFilterValue:p}:{}}),[u,c,s,m]),k=h.useMemo(()=>!!u.length||!!c.length||!!s.length||!!m.length,[u,c,s,m]),g=h.useMemo(()=>({propertyOptions:o,expenseAccountOptions:r,expenseAccountsData:i,accountIdsFilter:u,propertyIdsFilter:c,startDateFilter:s,endDateFilter:m,filterVariables:v,isFilterActive:k,deleteExpenseTarget:n,setDeleteExpenseTarget:t}),[o,r,u,c,s,m,v,k,n,t]);return e.jsx(Om.Provider,{value:g,children:e.jsx(Lp,{})})},Bp="X3zLb",Mp="rl7ZH",Pp="rCsL9",Up="_3UgSD",un={container:Bp,headerText:Mp,buttons:Pp,btn:Up},Et="Transactions Header",pi=({onAddExpenses:n})=>{const t=In(),[a,o]=h.useState(!1),i=gn(),{isUserAccountingSubscribed:r}=yt(),[d]=$i(Vi.REI_ACCOUNTING),l=d(),u=()=>{n(),ee("add_expenses clicked",{location:"Transactions Navigation"}),t(Ji(Lt.transactionsExpenses))},c=()=>{o(!0),ee("import_automatically clicked",{location:Et})};return e.jsxs("div",{className:un.container,children:[e.jsx(Ke,{className:un.headerText,children:"Transactions"}),i&&e.jsx(to,{onImportAutomaticallyClicked:c,onAddExpensesClicked:u}),!i&&e.jsxs("div",{className:un.buttons,children:[!r&&e.jsxs(e.Fragment,{children:[e.jsx(O,{className:un.btn,onClick:u,variant:"outline",size:"md",width:"hug",children:"Add Expense"}),e.jsx(O,{size:"md",width:"hug",className:un.btn,onClick:c,"data-qa":"accounting-import-automatically-button",children:"Import Automatically"})]}),r&&e.jsxs(e.Fragment,{children:[l?e.jsx(O,{size:"md",width:"hug",variant:"outline",className:un.btn,onClick:()=>{t("/owners/accounting/transactions/accounts")},"data-qa":"accounting-manage-accounts-button",children:"Manage Accounts"}):e.jsx(xt,{label:"Manage Accounts",redirectPage:Lt.reiHub.manageAccounts,segmentLocation:Et,className:un.btn,variant:"outline",width:"hug","data-qa":"accounting-manage-accounts-button"}),e.jsx(O,{size:"md",width:"hug",variant:"fill",className:un.btn,onClick:()=>{ee("import_transactions clicked",{location:Et}),t("/owners/accounting/link")},"data-qa":"accounting-import-automatically-button",children:"Import Automatically"})]})]}),a&&e.jsx(ao,{open:a,onClose:()=>o(!1),segmentLocation:"Transactions Navigation"})]})};pi.propTypes={onAddExpenses:xi.func};const $p="-Yed-",Vp="eWxiD",Jp="qGKk0",zp="DvUHO",qp="tmRPQ",Yp="sg4P3",Gp="Ko0si",$e={container:$p,headerWrapper:Vp,header:Jp,accountingStyles:zp,tabContent:qp,focus:Yp,content:Gp},yh=()=>{const n=Ti(),t=Mn(),{isUserAccountingSubscribed:a,loading:o}=yt(),i=t.pathname.replace(`${n.url}/`,""),r=i==="landing",d=i==="expenses",[l,u]=h.useState(!1),c=a?"all":"landing";h.useEffect(()=>{!a&&!o&&ee("transaction_promo_page loaded")},[a,o]);const s=[...a?[{id:"import_feed_tab",label:"Import Feed",url:{pathname:`${n.url}/${c}`}}]:[{id:"accounting_tab",label:"Accounting",premiumBadge:!0,url:{pathname:`${n.url}/landing`}}],{id:"expenses_tab",label:"Expenses",url:{pathname:`${n.url}/expenses`},onClick:()=>{ee("expenses clicked",{location:"Transactions"})}}],m=()=>{u(!0)};return e.jsx(zi,{tabs:s,headerContent:e.jsx(pi,{onAddExpenses:m}),className:$e.container,headerWrapperClassName:S($e.headerWrapper,{[$e.accountingStyles]:r,[$e.expensesStyles]:d}),contentClassName:S($e.tabContent,$e.focus,{[$e.accountingStyles]:r,[$e.expensesStyles]:d}),headerClassName:$e.header,children:e.jsx("div",{className:S($e.content,{[$e.accountingStyles]:r,[$e.expensesStyles]:d}),children:e.jsxs(Ii,{children:[e.jsx(tt,{exact:!0,path:`${n.url}/landing`,component:Yi}),a?e.jsx(tt,{exact:!0,path:`${n.url}/expenses`,component:_p}):e.jsx(tt,{exact:!0,path:`${n.url}/expenses`,component:()=>e.jsx(qi,{isCreateEditExpenseModalOpen:l,setIsCreateEditExpenseModalOpen:u})}),e.jsx(tt,{exact:!0,path:`${n.url}/${c}`,component:Am}),e.jsx(ji,{exact:!0,from:n.url,to:`${n.url}/${c}`})]})})})};export{yh as default};
//# sourceMappingURL=index-B1LahImZ.js.map
