import{j as e,a9 as ee,B as w,p as G,o as U,u as z,al as te,a8 as se,ak as x,s as b,q as M,af as ne,k as T,I as ae,aU as ie,W as oe,Q as re,r as V,L as H,i as ce,bi as A,P as W}from"./TownhouseColor--VjQBVqd.js";import{O as le}from"./OfflineToOnlineConversionModal-rzszdUD7.js";import{P as de,R as me}from"./PaymentBanners-Bw0vF_Mk.js";import{P as ue}from"./PaymentStatusNotice-5am1IYJl.js";import{t as q,d7 as L,hl as pe,hm as he,d6 as ke,hn as ve,c9 as v,ho as ge,br as ye,aj as Ce,dT as Se,q as Pe,hp as Ne,aa as be}from"./main-dumNSXg9.js";import{F as fe}from"./FraudStatusEnum-BCCs0giA.js";import{u as xe}from"./useEntitiesQuery-Cfuo2upn.js";import{i as K}from"./isBannerHidden-BMafTP6_.js";import{I as _e}from"./InviteTenantModal-CgO4UIgM.js";import{C as O}from"./Checklist-CbTzPKDC.js";import{C as Y,a as $}from"./chargesTabConstants-w3vvtWKy.js";import"./isIdentityDocsRequired-B5TX9mAG.js";import"./UpdateStripeCompanyForm-B4YSI7cc.js";import"./addTenant-C28JX-tw.js";import"./renter.fragment-Bw-Iz3YH.js";import"./common_tenant_data.fragment-BuOJMkzd.js";import"./application.fragment-BPK0_S5u.js";const Te=`query getPaymentsSummaryList($period: String!) {
  dashboards {
    payments_summary(period: $period) {
      cumulative {
        overdue
        unpaid
        charges
        paid
        in_transit
        deposited
        applied_credit
      }
    }
  }
}
`,je={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getPaymentsSummaryList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"period"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dashboards"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"payments_summary"},arguments:[{kind:"Argument",name:{kind:"Name",value:"period"},value:{kind:"Variable",name:{kind:"Name",value:"period"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cumulative"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"overdue"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unpaid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"charges"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"paid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"in_transit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deposited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"applied_credit"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:301,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Te}}},Ee=()=>{const{user:t}=q(),s=t?.dismissed_banners||[],i=t?.premium_subscription_subscribed||!1;return K(s,L.PREMIUM_SUBSCRIPTION)||!pe(t)||i},Be=`query paymentsSetupChecklistStatus {
  payments_setup_checklist_status {
    id
    status
    completedPercentage
    completedCount
    steps {
      tenants
      charges
      bankAccount
    }
  }
}
`,De={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"paymentsSetupChecklistStatus"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"payments_setup_checklist_status"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"completedPercentage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"completedCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"steps"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tenants"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"charges"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bankAccount"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:242,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Be}}},Fe="pJA6W",Ie="SYpVW",Ae="UkkYb",Oe="DomIS",$e="H0CVC",Re="v49j1",we="seEuS",Me="NIqcG",Le="_9SM9M",Ue="NXIjm",r={card:Fe,header:Ie,progressBarContainer:Ae,progressBar:Oe,checklistContainer:$e,dismissButton:Re,checklistItem:we,checklistItemContent:Me,checklistDescription:Le,checklistAction:Ue},qe=({title:t,description:s,buttonText:i,buttonTextCompleted:c,isCompleted:n,onClick:d,onCompletedClick:h,customButton:m})=>e.jsx(O,{open:!0,completed:n,inProgress:!1,className:r.checklist,children:e.jsxs("div",{className:r.checklistItem,children:[e.jsxs("div",{className:r.checklistItemContent,children:[e.jsx(O.Title,{title:t}),!n&&e.jsx(O.Content,{children:e.jsx(ee,{className:r.checklistDescription,children:s})})]}),e.jsx("div",{className:r.checklistAction,children:m??e.jsx(w,{variant:n?"ghost":"fill",size:n?"md":"sm",width:176,smWidth:"block",onClick:n?h:d,children:n?c:i})})]})}),Ve=3,R=t=>t===he.COMPLETED,He=()=>{const t=G(),{PRIVATE_BASE_PATH:s}=U(),{user:i}=q(),c=i?.dismissed_banners??[],n=K(c,L.PAYMENTS_SETUP_CHECKLIST),{data:d,refetch:h}=z(De,{fetchPolicy:"cache-and-network",skip:n}),[m,{loading:o}]=ke({},L.PAYMENTS_SETUP_CHECKLIST),a=d?.payments_setup_checklist_status,u=a?.status;if(n||!a)return null;const{steps:p}=a,j=a.completedCount??0;if(u===ve.COMPLETED)return null;const S=async()=>{b("payments_setup_checklist_dismissed",{location:"PaymentsDashboard"}),await m()},E=async()=>{await h()},k=R(p?.tenants),g=()=>{b("create_charge clicked",{location:"Payments overview checklist"}),t(`${s}payments/charges/create`)},B=()=>{b("connect_bank clicked",{location:"Payments overview checklist"}),t(`${s}payments/setup/collection?offlineConversion=true&bankStep=true`)},D=()=>{t(`${s}payments/charges`)},F=()=>{t(`${s}settings/rent-payments`)},I=[{title:"Choose your Tenants",description:"We'll automatically send them reminders so you don't have to!",buttonText:"ADD TENANT",isCompleted:k,onClick:()=>{},onCompletedClick:()=>{},buttonTextCompleted:"add another tenant",customButton:e.jsx(_e,{onSubmit:E,trackEventOnSubmit:"add_tenant clicked",trackEventOnSubmitParams:{location:"PaymentsDashboard"},children:e.jsx(w,{variant:k?"ghost":"fill",size:k?"md":"sm",width:176,smWidth:"block",children:k?"add another tenant":"ADD TENANT"})})},{title:"Create a Charge",description:"Set up automated rent charges and collect security deposits. We even send reminders for you.",buttonText:"CREATE CHARGE",isCompleted:R(p?.charges),onClick:g,buttonTextCompleted:"View charges",onCompletedClick:D},{title:"Add a Bank Account",description:"Deposits will happen automatically without you chasing your tenants.",buttonText:"CONNECT BANK",isCompleted:R(p?.bankAccount),onClick:B,buttonTextCompleted:"Edit bank account",onCompletedClick:F}];return e.jsxs(te,{className:r.card,children:[e.jsx("div",{className:r.header,children:e.jsx(se,{children:"Get set up"})}),e.jsxs("div",{className:r.checklistContainer,children:[e.jsx(x,{value:j,max:Ve,type:"rounded",children:e.jsxs(x.Container,{className:r.progressBarContainer,children:[e.jsx(x.Bar,{className:r.progressBar}),e.jsx(x.Counter,{})]})}),I.map(l=>e.jsx(qe,{...l},l.title)),e.jsx(w,{variant:"ghost",size:"md",className:r.dismissButton,onClick:S,disabled:o,loading:o,children:"dismiss"})]})]})},We=()=>{const s=M.parse(location.search,{arrayFormat:"comma"})?.period;return{selectedPeriodFilter:s,areFiltersApplied:!!s}},N={label:"Month-to-date",value:"month"},Q={label:"Year-to-date",value:"year"},Ye="WPyvm",Qe="_0oFUU",Ge="GHQG8",ze="LnvtD",Ke="R22vx",P={dataCard:Ye,label:Qe,value:Ge,dataCardContent:ze,"bg-color-darkBlue":"X4pk6","bg-color-blue":"Oa-5p",pulse:Ke},y=({className:t,label:s,value:i,to:c,color:n="blue"})=>e.jsxs(ne,{className:T(P.dataCard,P[`bg-color-${n}`],t),to:c,children:[e.jsxs("div",{className:P.dataCardContent,children:[e.jsx("span",{className:P.label,children:s}),e.jsx("span",{className:T(P.value),children:i})]}),e.jsx(ae,{name:"chevron-arrow-right"})]}),Xe="hc1Qt",Je="mI4Ua",Ze="uL0Rj",et="Htx2O",_={container:Xe,onlyOfflinePayments:Je,paidValue:Ze,dcIconTooltip:et},tt=({pastDue:t,unpaid:s,charges:i,paid:c,inTransit:n,deposited:d,timePeriod:h,wantsOfflineTracking:m,credit:o=0})=>{const{PRIVATE_BASE_PATH:a}=U(),u=h===N.value?Y.CURRENT_MONTH:Y.YTD;return e.jsxs("div",{className:T(_.container,{[_.onlyOfflinePayments]:m}),children:[e.jsx(y,{label:t>0?e.jsx(ie,{color:"red",children:"Past Due"}):"Past Due",color:"darkBlue",value:v(t/100,!1),to:`${a}payments/charges?dateFilter=${u}&status=${$.PAST_DUE}`}),e.jsx(y,{label:"Unpaid",color:"darkBlue",value:v(s/100,!1),to:`${a}payments/charges?dateFilter=${u}&status=${$.UNPAID}`}),e.jsx(y,{label:"Charges",color:"darkBlue",value:v(i/100,!1),to:`${a}payments/charges?dateFilter=${u}`}),e.jsx(y,{label:"Paid",color:m?"darkBlue":"blue",value:e.jsxs("div",{className:_.paidValue,children:[v((c-o)/100,!1),o>0&&e.jsx(oe,{className:_.dcIconTooltip,tip:`${v(o/100,!1)} credit used by your tenant(s) not counted here`,onClick:p=>{p.stopPropagation(),p.preventDefault()}})]}),to:`${a}payments/charges?dateFilter=${u}&status=${$.PAID}`}),!m&&e.jsxs(e.Fragment,{children:[e.jsx(y,{label:"In Transit",color:"blue",value:v(n/100,!1),to:`${a}payments/deposits`}),e.jsx(y,{label:"Deposited",color:"blue",value:v(d/100,!1),to:`${a}payments/deposits?dateFilter=${u}`})]})]})},st="PY0EI",nt="Os6DS",at="c4y5U",it="Qzt0K",ot="D4LPo",C={headingContainer:st,heading:nt,periodFilter:at,paymentsContainer:it,fullWidth:ot},X=({location:t,showInFullWidth:s})=>{const{PRIVATE_BASE_PATH:i}=U(),c=ge(),n=G(),d=M.parse(t.search,{arrayFormat:"comma"}),{entities:h}=xe(),m=ye(),{wantsOfflineTracking:o,hasUserFinishedPaymentsOnboarding:a,loading:u}=Ce(),{user:p,loading:j,fraudStatus:S}=q(),E=Ee(),{selectedPeriodFilter:k}=We(),[g,B]=V.useState(k||N.value),D=Se(Pe),{data:F,loading:I}=z(je,{fetchPolicy:"cache-and-network",variables:{period:k||g}}),l=F?.dashboards?.payments_summary?.cumulative,J=f=>{B(f);const Z={...d,period:f};n(`${t.pathname}?${M.stringify(Z,{arrayFormat:"comma"})}`,{replace:!0})};return V.useEffect(()=>{d.showOnlineConversionModal&&o&&(b("online_collection_intro_modal loaded",{location:"Offline Tracking Request to Pay"}),m(f=>e.jsx(le,{firstName:p.first_name,onClose:f,open:!0})))},[d.showOnlineConversionModal,o]),!a&&!o&&!u?e.jsx(H,{loading:j,children:e.jsx("div",{className:T(C.paymentsContainer,{[C.fullWidth]:s}),children:e.jsx(Ne,{triggerSegmentEventOnLoad:"payments settings",segmentLocation:"Payments Intro Page",action:{to:`${i}payments/setup/lease`,onClick:async()=>{await c()},label:"get started",eventName:"get_started"}})})}):S==="DENIED"?e.jsx(ue,{title:"Access to Rent Payments Denied",titleId:"denied_title",description:e.jsxs("span",{children:["Contact"," ",e.jsx("a",{href:"mailto:support@turbotenant.com",children:"support@turbotenant.com"})," ","for more information."]})}):e.jsxs("div",{className:C.container,children:[e.jsx(de,{entities:h,fraudQueueStatus:S,isUnderInternalReview:S===fe.PENDING}),!E&&e.jsx(me,{openLocation:be.PAYMENTS_OVERVIEW,onLearnMoreClick:()=>{b("learn_more clicked",{location:"Payments Premium Banner"})}}),e.jsxs("div",{className:C.headingContainer,children:[e.jsx("h2",{className:C.heading,children:g===N.value?ce().format("MMMM YYYY"):"This Year"}),e.jsxs(A,{onValueChange:J,initialValue:g,className:C.periodFilter,size:D?"large":"small",children:[e.jsx(A.Item,{value:N.value,children:N.label}),e.jsx(A.Item,{value:Q.value,children:Q.label})]})]}),e.jsx(H,{loading:I,children:e.jsx(tt,{pastDue:l?.overdue,unpaid:l?.unpaid,charges:l?.charges,paid:l?.paid,inTransit:l?.in_transit,deposited:l?.deposited,credit:l?.applied_credit,timePeriod:g,wantsOfflineTracking:o})}),e.jsx(He,{})]})};X.propTypes={location:W.object,showInFullWidth:W.bool};const ft=re(X);export{ft as default};
//# sourceMappingURL=OverviewDashboardTab-CIziFGcY.js.map
