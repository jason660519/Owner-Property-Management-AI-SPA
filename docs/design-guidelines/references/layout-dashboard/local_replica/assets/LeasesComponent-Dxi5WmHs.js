import{h as ke,u as ge,r as l,j as e,a5 as ve,o as C,ar as he,B as ye,d as Ne,P as H,p as fe,an as g,N as o,G as _,U as Se,ap as w}from"./TownhouseColor--VjQBVqd.js";import{aP as _e,bS as Fe,bo as be,be as Le,aj as xe,g2 as Ee,t as Ie,g3 as Pe,aI as Ae,aV as je,g4 as Te,dg as x,e6 as v}from"./main-dumNSXg9.js";import{L as we}from"./leases-empty@2x-B8TdxcLP.js";import{N as Ce}from"./NoActiveItemsState-DORkPZUz.js";import{P as k,L as Re}from"./LeasePageHeader-CxZgexFQ.js";import{s as X,L as Be}from"./LeaseListItemCardWrapped-DnBL1ogY.js";import{N as Ve}from"./NewAccountEmptyState-Dqw66CVF.js";import"./NotFound-QMpt4eTL.js";import"./PremiumSubscriptionBanner-fx5JsfcE.js";import"./PencilDocument-C74JaG9V.js";import"./AlertModal--93869rJ.js";import"./FraudStatusEnum-BCCs0giA.js";import"./calculateLeaseTerm-B_s-x2O1.js";const $e="/assets/leases-empty-mobile-ThctBKuZ.webp",De=`# Leases query optimized for index page - only fetches fields used by LeasesComponent
query LeasesIndexQuery(
  $includePast: Boolean
  $offset: Int
  $limit: Int
  $searchFilter: String
  $listingFilter: [String]
  $sortBy: String
) {
  userData {
    id
    leasesPaginated(
      includePast: $includePast
      offset: $offset
      limit: $limit
      searchFilter: $searchFilter
      listingFilter: $listingFilter
      sortBy: $sortBy
    ) {
      dataHash
      data {
        list {
          id
          title
          status
          start_date
          end_date
          total_balance_due
          payment_request_rules_count
          can_delete
          listing {
            id
            address
            unit
            city
            state
            zip
            nickname
            property_role
            room_name
            parent_listing_name
            root_listing_name
            has_active_tenant_placement_service
          }
          renters {
            id
            first_name
            last_name
          }
          is_autopilot
        }
        totalRows
      }
    }
  }
}
`,Oe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"LeasesIndexQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includePast"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listingFilter"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sortBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userData"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"leasesPaginated"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includePast"},value:{kind:"Variable",name:{kind:"Name",value:"includePast"}}},{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}},{kind:"Argument",name:{kind:"Name",value:"searchFilter"},value:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}}},{kind:"Argument",name:{kind:"Name",value:"listingFilter"},value:{kind:"Variable",name:{kind:"Name",value:"listingFilter"}}},{kind:"Argument",name:{kind:"Name",value:"sortBy"},value:{kind:"Variable",name:{kind:"Name",value:"sortBy"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dataHash"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"list"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"start_date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"end_date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"total_balance_due"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"payment_request_rules_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"listing"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"city"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"zip"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nickname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"property_role"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"room_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_listing_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"root_listing_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"has_active_tenant_placement_service"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"renters"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"first_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"last_name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"is_autopilot"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"totalRows"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:1182,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:De}}},qe=(n={},a)=>{const{USER_PROFILE_POLL_INTERVAL:m}=ke();a===void 0&&(a=m);const u=a&&a>0?{pollInterval:a}:{},p=ge(Oe,{...u,...n,context:{...a&&a>0?{pollingEnabled:!0}:{},...n.context||{}}});return{response:p,loading:p.loading&&p.networkStatus!==6,leases:p?.data?.userData?.leasesPaginated?.data?.list??[],totalRows:p?.data?.userData?.leasesPaginated?.data?.totalRows??0}},ze="Abo2w",Ge="leKsP",Je="dKfrz",Me="Kcz2C",Ue="_4gdGT",F={container:ze,title:Ge,description:Je,contactSupport:Me,modalContainer:Ue},Xe=()=>{const[n,a]=l.useState(!0);function m(){a(!1)}function u(){Fe(),m()}return e.jsx(_e,{open:n,onClose:m,className:F.container,containerClassName:F.modalContainer,children:e.jsxs("div",{children:[e.jsx("h2",{className:F.title,children:"Lease does not exist"}),e.jsxs("p",{className:F.description,children:["This lease may have been deleted. Please"," ",e.jsx("span",{className:F.contactSupport,onClick:u,children:"contact support"})," ","if this is a mistake."]}),e.jsx(ve,{onClick:m,children:"Okay"})]})})},He="ULqqM",Ke="TlIz-",Qe="ZhzRL",We="z2meP",E={container:He,title:Ke,content:Qe,btn:We},K=({onClose:n})=>{const{PRIVATE_BASE_PATH:a}=C();return e.jsxs("article",{className:E.container,children:[e.jsxs("div",{className:E.content,children:[e.jsx("p",{className:E.title,children:"Make It Easy to Get Paid"}),e.jsxs("span",{children:["Forget the hassle of picking up and depositing checks! Add your bank account and a few more details about yourself to collect rent online through TurboTenant.Â ",e.jsx(he,{href:"https://support.turbotenant.com/en/articles/4004080-rent-payments",target:"_blank",rel:"noopener noreferrer",children:"Learn more about rent payments"}),"."]})]}),e.jsx(ye,{type:"secondary",size:"sm",to:{pathname:`${a}payments`,search:`?redirectTo=${encodeURIComponent(location.pathname)}`},className:E.btn,children:"Set Up Payments"}),e.jsx(be,{strokeWidth:4,color:Ne.greyLight,onClick:n,style:{width:14,height:14,cursor:"pointer",position:"absolute",top:13,right:13}})]})};K.propTypes={onClose:H.func};const Ye="_75DLA",Ze="_3-8ME",et="epNJc",tt="Aj6kB",h={header:Ye,skeletonItem:Ze,leasesList:et,leaseItem:tt},c=()=>e.jsx(x,{hybrid:!0,className:h.skeletonItem,children:e.jsxs(x.Section,{align:"start",padding:["xmd","ymd"],column:!0,children:[e.jsx(v,{size:"heading"}),e.jsxs(x.Section,{margin:["txs","bxs"],justify:"space",gap:"xl",align:"center",breakpoint:!0,children:[e.jsx(v,{size:"third",breakPoint:"md"}),e.jsxs(x.Section,{align:"center",gap:"sm",breakpoint:!0,children:[e.jsx(v,{size:"sm"}),e.jsx(v,{size:"md",expandSmall:!0})]}),e.jsx(v,{size:"sm"})]}),e.jsx(v,{size:"md",hideSmall:!0})]})}),at=({location:n})=>{const a=fe(),{listings:m,loading:u}=Le({variables:{mode:"ROOTS_ONLY",sort:"ALPHABETICAL"}}),{wantsOfflineTracking:p}=xe(),[Q,W]=l.useState(g("showTurboPayBanner")!=="hide"),I=o.parse(n?.search,{arrayFormat:"comma"}),R=Number(I.page)||0,y=I.search||"",i=I.propertyIdFilter||"";let b=[];Array.isArray(i)?b=i:i&&(b=[i]);const[B,V]=l.useState(y),[N]=Ee(B,800),[$,D]=l.useState(()=>Array.isArray(i)?i:i?[i]:JSON.parse(g(k.LEASE_INDEX_PAGE_FILTERS)||"{}")?.propertyFilter||[]),P=_(n,"state.toast",""),Y=n.search.includes("invalidLease"),{PRIVATE_BASE_PATH:A}=C(),[Z,ee]=l.useState(()=>{const s=JSON.parse(g(k.LEASE_INDEX_PAGE_FILTERS)||"{}")?.dateSort;return X.find(d=>d.value===s)||X[0]}),{user:r,loading:O,failedNetworkRequest:j,error:te}=Ie({polling:!1}),q=r.has_past_leases>0,f=_(r,"listings_count",0)+_(r,"tenants_count",0)+_(r,"applicants_count",0)===0,{TABLE_VIEW_PAGE_SIZE:L}=C(),{leases:S,loading:z,totalRows:T}=qe({variables:{offset:R*L,limit:L,searchFilter:N,listingFilter:b,sortBy:Z.value}}),ae=S||[],ne=_(r,"premium_subscription_subscribed",!1),G=(S.length===0||f)&&!q,J=S.length===0&&q,se=!p&&!(!ne&&!G&&!J)&&Q&&Pe(r);l.useEffect(()=>{P&&Se(P)},[P]);const ie=()=>{w("showTurboPayBanner","hide"),W(!1)},re=t=>{const s=o.parse(n.search)||{};s.page=t,a({pathname:n.pathname,search:`?${o.stringify(s)}`}),document.activeElement.blur(),window.scrollTo(0,0)},le=()=>Math.ceil(T/L),oe=t=>{V(t)};l.useEffect(()=>{if(N!==y){const t=o.parse(n.search)||{};t.search=N||void 0,t.page=0,a({pathname:n.pathname,search:`?${o.stringify(t)}`})}},[N,y,n.search,a]),l.useEffect(()=>{V(y)},[y]);const de=t=>{D(t);const s=o.parse(n.search)||{};s.propertyIdFilter=t.length>0?t.join(","):void 0,s.page=0,a({pathname:n.pathname,search:`?${o.stringify(s)}`});const d=JSON.parse(g(k.LEASE_INDEX_PAGE_FILTERS)||"{}");w(k.LEASE_INDEX_PAGE_FILTERS,JSON.stringify({...d,propertyFilter:t}))};if(l.useEffect(()=>{let t=[];Array.isArray(i)?t=i:i&&(t=[i]);const s=JSON.stringify([...$].sort()),d=JSON.stringify([...t].sort());s!==d&&D(t)},[i]),l.useEffect(()=>{if(!i){const s=JSON.parse(g(k.LEASE_INDEX_PAGE_FILTERS)||"{}")?.propertyFilter||[];if(s.length>0){const d=o.parse(n.search)||{};d.propertyIdFilter=s.join(","),a({pathname:n.pathname,search:`?${o.stringify(d)}`},{replace:!0})}}},[]),j)return console.log("failedNetworkRequest",j,te),e.jsx(Ae,{reason:j,source:"owner-leases"});if(f&&r.id&&!r.onboarding_completed)return e.jsx(je,{to:"/onboarding/process"});const ce=()=>ae?.map(t=>e.jsx(Be,{className:h.leaseItem,lease:t,user:r},`lease-item-key${t.id}`)),me=f?"Conveniently sign and share documents electronically, and even collect rent online! First, add your rental property to get started.":"Conveniently sign and share documents electronically, and even collect rent online! Add your lease details and then connect your tenants to make staying on top of your leases easy.",ue=f?"Add My Property":"Add Your Lease",M=()=>{a(`${A}leases/create`)},pe=f?()=>{a(`${A}properties/create`)}:M,U=N||b.length>0||T>6;return e.jsxs(e.Fragment,{children:[Y&&e.jsx(Xe,{}),e.jsx(Re,{className:h.header,type:"active",showAddLease:S.length!==0,showSearch:U,onSearch:oe,showFilter:U,searchValue:B,onFiltersChange:de,loadingListings:u,listings:m||[],selectedIds:$,user:r,leases:S,onChangeSort:t=>{ee(t);const s=JSON.parse(g(k.LEASE_INDEX_PAGE_FILTERS)||"{}");w(k.LEASE_INDEX_PAGE_FILTERS,JSON.stringify({...s,dateSort:t.value}))},loading:O||z||u}),O||z||u?e.jsxs(e.Fragment,{children:[e.jsx(c,{}),e.jsx(c,{}),e.jsx(c,{}),e.jsx(c,{}),e.jsx(c,{}),e.jsx(c,{}),e.jsx(c,{}),e.jsx(c,{})]}):e.jsxs("div",{className:h.content,children:[se&&e.jsx(K,{onClose:ie}),J&&e.jsx(Ce,{title:"You don't have any active leases",description:"If you're not seeing your lease here, try looking under past leases, or you can always add a new lease.",actions:[{label:"Add your lease",onClick:M},{label:"Check Past Leases",onClick:()=>{a(`${A}leases/past`)}}]}),G?e.jsx(Ve,{smallScreenImg:$e,desktopImage:we,title:"Easily Manage Your Leases",titleId:"leases-empty-state-title",description:me,actionLabel:ue,onAction:pe}):e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"leases-list",className:h.leasesList,children:ce()}),T>L&&e.jsx("div",{className:h.paginationWrapper,children:e.jsx(Te,{pageCount:le(),currentPage:R,onPageChange:re})})]})]})]})};at.propTypes={location:H.object.isRequired};export{at as default};
//# sourceMappingURL=LeasesComponent-Dxi5WmHs.js.map
