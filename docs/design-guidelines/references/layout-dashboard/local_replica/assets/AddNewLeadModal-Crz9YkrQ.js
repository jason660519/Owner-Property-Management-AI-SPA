import{r as w,s as V,v as O,j as n,at as $,L as P,a4 as I,F as N,B as j,E as C,U as G,G as A,w as M,P as c}from"./TownhouseColor--VjQBVqd.js";import{be as Q,bi as B,l as S,n as L,v as F,o as x,b7 as U,p as E,b5 as R,cV as W,b6 as D,b8 as z,bf as Y,d1 as X,d2 as H,d3 as T,d4 as q}from"./main-dumNSXg9.js";import{_ as Z}from"./detailed_lead.fragment-DkOpsOoq.js";const J=`#import "../fragments/detailed_lead.fragment.graphql"

mutation addLead(
  $listingId: String
  $email: String
  $first_name: String!
  $last_name: String!
  $phone: String
  $sendPreScreener: Boolean
  $listing: CreateListingInput
  $mechanism: String
) {
  addLead(
    input: {
      listing_id: $listingId
      first_name: $first_name
      last_name: $last_name
      phone: $phone
      email: $email
      listing: $listing
      send_prescreeener: $sendPreScreener
      mechanism: $mechanism
    }
  ) {
    lead {
      ...DetailedLeadFragment
    }
    count
  }
}
`,y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addLead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listingId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"email"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"phone"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sendPreScreener"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listing"}},type:{kind:"NamedType",name:{kind:"Name",value:"CreateListingInput"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mechanism"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addLead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"listing_id"},value:{kind:"Variable",name:{kind:"Name",value:"listingId"}}},{kind:"ObjectField",name:{kind:"Name",value:"first_name"},value:{kind:"Variable",name:{kind:"Name",value:"first_name"}}},{kind:"ObjectField",name:{kind:"Name",value:"last_name"},value:{kind:"Variable",name:{kind:"Name",value:"last_name"}}},{kind:"ObjectField",name:{kind:"Name",value:"phone"},value:{kind:"Variable",name:{kind:"Name",value:"phone"}}},{kind:"ObjectField",name:{kind:"Name",value:"email"},value:{kind:"Variable",name:{kind:"Name",value:"email"}}},{kind:"ObjectField",name:{kind:"Name",value:"listing"},value:{kind:"Variable",name:{kind:"Name",value:"listing"}}},{kind:"ObjectField",name:{kind:"Name",value:"send_prescreeener"},value:{kind:"Variable",name:{kind:"Name",value:"sendPreScreener"}}},{kind:"ObjectField",name:{kind:"Name",value:"mechanism"},value:{kind:"Variable",name:{kind:"Name",value:"mechanism"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lead"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DetailedLeadFragment"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:615,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:J}}},K=l=>{const o={};return l.filter(function(t){if(t.kind!=="FragmentDefinition")return!0;const d=t.name.value;return o[d]?!1:(o[d]=!0,!0)})};y.definitions=K(y.definitions.concat(Z.definitions));const ee=(l,o)=>{const t=(e,a)=>{if(e.kind==="FragmentSpread")a.add(e.name.value);else if(e.kind==="VariableDefinition"){const i=e.type;i.kind==="NamedType"&&a.add(i.name.value)}return e&&"selectionSet"in e&&e.selectionSet&&e.selectionSet.selections.forEach(i=>{t(i,a)}),e&&"variableDefinitions"in e&&e.variableDefinitions&&e.variableDefinitions.forEach(i=>{t(i,a)}),e&&"definitions"in e&&e.definitions&&e.definitions.forEach(i=>{t(i,a)}),a},d=e=>{const a={};return e.definitions.forEach(function(i){"name"in i&&i.name&&(a[i.name.value]=t(i,new Set))}),a},b=(e,a)=>{for(let i=0;i<e.definitions.length;i++){const r=e.definitions[i];if(r&&"name"in r&&r.name&&r.name.value==a)return r}},k=d(l),g=Object.assign({},l,{definitions:[b(l,o)]}),_=k[o]||new Set,p=new Set;let m=new Set;for(_.forEach(e=>{m.add(e)});m.size>0;){const e=m;m=new Set,e.forEach(a=>{p.has(a)||(p.add(a),(k[a]||new Set).forEach(r=>{m.add(r)}))})}return p.forEach(e=>{const a=b(l,e);a&&g.definitions.push(a)}),g};ee(y,"addLead");const ae="Y59Yz",ie="TcAsL",ne="vXPc6",te="hIDd-",se="_--oVf",le="nX4RB",de="fZzaL",re="_2Ppnx",s={container:ae,title:ie,text:ne,formGroup:te,name:se,phone:le,btnWrap:de,btn:re},oe=({open:l,onClose:o,selectedValue:t,segmentLocation:d,segmentLoadLocation:b,loadEventFired:k,onLoadEventFired:g})=>{w.useEffect(()=>{l&&!k&&(V("add_a_new_lead_modal loaded",{location:b}),g())},[l,k]);const{listings:_=[],loading:p}=Q({variables:{mode:Y.ROOTS_ONLY}}),[m,{loading:e}]=O(y),a=async v=>{const h={...X(v),listingId:v.listing_id};try{const u={...h,phone:H(v.phone),mechanism:"INVITE_TO_SHOWING"},f=await m({variables:u,refetchQueries:[{query:C},{query:q,variables:T().variables},{query:q,variables:T(location.search,!1)}],awaitRefetchQueries:!0});o(f?.data?.addLead?.lead),G("Lead added!")}catch(u){const f=A(u,"graphQLErrors[0].message")||"Something went wrong";M(f)}},i=()=>{d&&V("cancel clicked",{location:d}),o()},r=()=>{d&&V("submit clicked",{location:d})};return n.jsx($,{isOpen:!0,className:s.container,autoFocus:!1,children:n.jsxs(P,{loading:p||e,children:[n.jsx("h3",{id:"add-lead-modal",className:s.title,children:"Add a new lead!"}),n.jsx("p",{className:s.text,children:"Easily keep track of all the renters interested in your property."}),n.jsx(I,{onSubmit:a,subscription:{submitting:!0,values:!0},initialValues:{listing_id:t},children:({handleSubmit:v,submitting:h,values:u,form:f})=>n.jsxs("form",{onSubmit:v,children:[n.jsx(B,{label:"Property Interested In",properties:_,dataQaTags:{property:"properties-dropdown"},required:!0,lockPreSelectedFields:!0,selectedValue:t}),n.jsxs("div",{className:s.formGroup,children:[n.jsx(N,{label:"First Name",component:L,name:"first_name",id:"first_name",className:s.name,validate:S(x,F)}),n.jsx(N,{label:"Last Name",component:L,name:"last_name",id:"last_name",className:s.name,validate:S(x,F)})]}),n.jsx(N,{label:"Email",component:L,type:"email",name:"email",id:"email",validate:u.phone?E:S(R("Add an email or phone number"),E),parse:U}),n.jsx(W,{fieldName:"email",form:f,className:"mb-16"}),n.jsx(N,{label:"Phone",component:z,id:"phone",name:"phone",validate:u.email?D:S(R("Add an email or phone number"),D),className:s.phone}),n.jsxs("div",{className:s.btnWrap,children:[n.jsx(j,{type:"primary",variant:"outline",id:"close-add-lead-modal",className:s.btn,disabled:h,onClick:i,children:"Cancel"}),n.jsx(j,{type:"primary",htmlType:"submit",id:"add-lead-button",className:s.btn,loading:h,onClick:r,children:"Submit"})]})]})})]})})};oe.propTypes={open:c.bool.isRequired,onClose:c.func.isRequired,selectedValue:c.string,segmentLocation:c.string,segmentLoadLocation:c.string,loadEventFired:c.bool.isRequired,onLoadEventFired:c.func.isRequired};export{oe as A,y as _};
//# sourceMappingURL=AddNewLeadModal-Crz9YkrQ.js.map
