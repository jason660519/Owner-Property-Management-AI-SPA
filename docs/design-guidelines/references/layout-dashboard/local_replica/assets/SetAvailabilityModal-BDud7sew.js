import{v as G,j as e,at as j,as as ce,a4 as Q,ad as U,a9 as O,F as Y,B as F,P as i,r as g,k as q,J as _e,i as x,av as je,aC as z,w as E,ab as xe}from"./TownhouseColor--VjQBVqd.js";import{hA as De,n as Te,b$ as Fe,bi as Ae,ip as W,iq as we,d as $e,e as me,bk as Re,l as Me,o as Oe,aL as L,aR as ae,c1 as se,aW as Ve,dw as Ce}from"./main-dumNSXg9.js";import{i as Ye}from"./isNullEmptyOrUndefined-aX4MtJWb.js";import{f as Ee}from"./formatShowingTime-A0aZEubc.js";const qe=({address:s,unit:a,room_name:n,nickname:t}={})=>{const l=a?`, ${a}`:"",o=n?`, ${n} `:"";return`${`${t||s}`}${l}${o}`},Ie=`query getShowingAvailabilityForListing($listingId: String!) {
  getShowingAvailabilityForListing(listingId: $listingId) {
    id
    instructions
    showing_availability_slots {
      id
      start_at
      end_at
    }
  }
}
`,He={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getShowingAvailabilityForListing"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listingId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getShowingAvailabilityForListing"},arguments:[{kind:"Argument",name:{kind:"Name",value:"listingId"},value:{kind:"Variable",name:{kind:"Name",value:"listingId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"instructions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"showing_availability_slots"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"start_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"end_at"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:266,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Ie}}},ue=15,Pe={OPEN_HOUSE:"OPEN_HOUSE",APPOINTMENT:"APPOINTMENT"},Le=`mutation addAvailabilitySlots(
  $availability_id: String
  $availability_type: ShowingTypeEnum!
  $listing_id: String!
  $hours: [TimeSlotsInputType]
) {
  addAvailabilitySlots(
    input: {
      data: {
        availability_id: $availability_id
        availability_type: $availability_type
        listing_id: $listing_id
        hours: $hours
      }
    }
  ) {
    availabilitySlots {
      id
      availability_id
      availability_type
      end_at
      start_at
    }
  }
}
`,Be={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addAvailabilitySlots"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"availability_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"availability_type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ShowingTypeEnum"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listing_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hours"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TimeSlotsInputType"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addAvailabilitySlots"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"data"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"availability_id"},value:{kind:"Variable",name:{kind:"Name",value:"availability_id"}}},{kind:"ObjectField",name:{kind:"Name",value:"availability_type"},value:{kind:"Variable",name:{kind:"Name",value:"availability_type"}}},{kind:"ObjectField",name:{kind:"Name",value:"listing_id"},value:{kind:"Variable",name:{kind:"Name",value:"listing_id"}}},{kind:"ObjectField",name:{kind:"Name",value:"hours"},value:{kind:"Variable",name:{kind:"Name",value:"hours"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"availabilitySlots"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"end_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"start_at"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:525,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Le}}},Ue=`mutation removeAvailabilitySlot(
  $id: String!
  $listing_id: String!
  $availability_id: String!
) {
  removeAvailabilitySlot(
    input: {
      id: $id
      listing_id: $listing_id
      availability_id: $availability_id
    }
  ) {
    ok
    hasScheduledShowings
  }
}
`,ze={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeAvailabilitySlot"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listing_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"availability_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeAvailabilitySlot"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"listing_id"},value:{kind:"Variable",name:{kind:"Name",value:"listing_id"}}},{kind:"ObjectField",name:{kind:"Name",value:"availability_id"},value:{kind:"Variable",name:{kind:"Name",value:"availability_id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hasScheduledShowings"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:314,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Ue}}},We=`mutation setAvailabilityInstructions(
  $listing_id: String!
  $availability_id: String
  $instructions: String
) {
  setAvailabilityInstructions(
    input: {
      data: {
        listing_id: $listing_id
        availability_id: $availability_id
        instructions: $instructions
      }
    }
  ) {
    availability {
      id
      instructions
    }
  }
}
`,Ge={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"setAvailabilityInstructions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listing_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"availability_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instructions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setAvailabilityInstructions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"data"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"listing_id"},value:{kind:"Variable",name:{kind:"Name",value:"listing_id"}}},{kind:"ObjectField",name:{kind:"Name",value:"availability_id"},value:{kind:"Variable",name:{kind:"Name",value:"availability_id"}}},{kind:"ObjectField",name:{kind:"Name",value:"instructions"},value:{kind:"Variable",name:{kind:"Name",value:"instructions"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"availability"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"instructions"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:401,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:We}}},Z={refetchQueries:[{query:De}],awaitRefetchQueries:!0},Qe=()=>G(Be,Z),Ze=()=>G(Ge,Z),Je=()=>G(ze,Z),Xe="-BBPU",Ke="N-8RX",ei="-YTsO",ii="x1-Cx",ti="_6m4jd",ni="RiO-N",ai="zqRv5",si="uaQ0-",li="qCcxB",oi="_-7xch",_={modalHeader:Xe,listingAddress:Ke,form:ei,content:ii,title:ti,mobileTitle:ni,field:ai,buttonContainer:si,button:li,modalFooter:oi},ve=({instructions:s,onSubmit:a,listingAddress:n})=>e.jsxs(e.Fragment,{children:[e.jsx(j.Header,{className:_.modalHeader,children:e.jsx(ce,{className:_.listingAddress,children:n})}),e.jsx(Q,{onSubmit:a,initialValues:{instructions:s},subscription:{submitting:!0},children:({handleSubmit:t,submitting:l})=>e.jsxs("form",{onSubmit:t,className:_.form,children:[e.jsxs(j.Content,{className:_.content,children:[e.jsx(U,{className:_.title,children:"Showing instructions"}),e.jsx(U,{className:_.mobileTitle,children:"Showing instructions"}),e.jsx(O,{className:"mb-16",children:"We will show these instructions to the renter when they schedule a showing and in the reminders leading up to it."}),e.jsx(Y,{component:Te,as:"textarea",required:!1,rows:"2",className:_.field,name:"instructions",id:"instructions",label:"Showing Instructions",hint:"(Optional)"})]}),e.jsx(j.Footer,{className:_.modalFooter,children:e.jsx("div",{className:_.buttonContainer,children:e.jsx(F,{className:_.button,htmlType:"submit",loading:l,children:"Save"})})})]})})]});ve.propTypes={instructions:i.string,onSubmit:i.func.isRequired,listingAddress:i.string};const di="_--ku3",ri="YBMsW",ci="-sHXE",mi="lucux",ui="LsWGH",R={form:di,content:ri,buttonContainer:ci,button:mi,modalFooter:ui},ge=(s,a)=>{for(const n of a){if(n.id===s)return n;if(n.children_listings){const t=ge(s,n.children_listings);if(t)return{...n,...t}}}return null},be=({onNext:s,onClose:a,getAndSetListingData:n,listings:t,onSelectProperty:l})=>{const o=async r=>{const c=ge(r,t);c?.children_listings.length===0&&(await n(r,c),l&&l(c))};let d={};return t.length===1&&(d=Fe(t[0],"property_id")),g.useEffect(()=>{t.length===1&&o(t[0].id)},[t.length]),e.jsxs(e.Fragment,{children:[e.jsx(j.Header,{children:e.jsx(U,{children:"Which rental are you showing?"})}),e.jsx(Q,{onSubmit:s,initialValues:{...d},children:({handleSubmit:r})=>e.jsxs("form",{onSubmit:r,className:R.form,children:[e.jsx(j.Content,{className:R.content,children:e.jsx(Ae,{properties:t,onListingChange:o,required:!0})}),e.jsx(j.Footer,{className:R.modalFooter,children:e.jsxs("div",{className:R.buttonContainer,children:[e.jsx(F,{className:R.button,type:"outline",onClick:a,htmlType:"submit",children:"Cancel"}),e.jsx(F,{className:R.button,htmlType:"submit",children:"Continue"})]})})]})})]})};be.propTypes={onClose:i.func.isRequired,onNext:i.func.isRequired,getAndSetListingData:i.func.isRequired,listings:i.array.isRequired,onSelectProperty:i.func};const vi="_3PGxo",gi="_1DJU8",B={container:vi,select:gi},bi=W.LocaleUtils.getMonths(),ke=({date:s,fromDate:a,toDate:n,onChange:t})=>{a.setHours(0,0,0,0),n.setHours(0,0,0,0);const l=[];for(let o=a.getFullYear();o<=n.getFullYear();o+=1)l.push(o);return e.jsxs("div",{className:q("DayPicker-Caption",B.container),children:[e.jsx("select",{name:"month",onChange:o=>{t(new Date(s.getFullYear(),o.target.value))},value:s.getMonth(),className:B.select,children:bi.map((o,d)=>{const r=new Date(s.getTime());return r.setMonth(d),r.setDate(a.getDate()),d===11||r.getTime()>=a.getTime()?e.jsx("option",{value:d,children:o},o):null})}),e.jsx("select",{name:"year",onChange:o=>{t(new Date(o.target.value,s.getMonth()))},value:s.getFullYear(),className:B.select,children:l.map(o=>e.jsx("option",{value:o,children:o},o))})]})};ke.propTypes={fromDate:i.any,toDate:i.any,date:i.any,onChange:i.func};const ki="k-UNG",yi="C6Cmx",le={wrap:ki,container:yi},oe=(s,{fromDate:a,toDate:n})=>{let t=x(s,"MM/DD/YYYY"),l;return!s||!t.isValid()?t=new Date:(l=t.toDate(),t=t.toDate()),a.getTime()>t.getTime()?t=a:t.getTime()>n.getTime()&&(t=n),{month:t,selected:l}},J=_e.forwardRef(({value:s,fromDate:a,toDate:n,onChange:t,resetDatePickerField:l,...o},d)=>{const[r,c]=g.useState([]);g.useEffect(()=>{l&&c([])},[l]);const y=(v,{selected:k})=>{const p=r.slice();if(k){const f=p.findIndex($=>W.DateUtils.isSameDay($,v));p.splice(f,1)}else p.push(v);c(p),t(p)},S=oe(s,{fromDate:a,toDate:n}),{selected:h}=S,[u,N]=g.useState(S.month),b=g.useRef(!1);return g.useEffect(()=>{if(!b.current)return;b.current=!0;const v=oe(s,{fromDate:a,toDate:n});N(v.month)},[s,a,n]),e.jsxs("div",{ref:d,...o,className:le.wrap,children:[e.jsx(ke,{date:u,onChange:v=>{if(N(v),h){const k=new Date(v.getFullYear(),v.getMonth()+1,0).getDate();t(new Date(v.getFullYear(),v.getMonth(),Math.min(h.getDate(),k)))}},fromDate:a,toDate:n}),e.jsx("div",{onMouseDown:v=>v.preventDefault(),children:e.jsx(we,{month:u,fromMonth:a,toMonth:n,className:le.container,mode:"multiple",disabledDays:{before:a,after:n},onDayClick:y,modifiers:{selected:v=>r.some(k=>W.DateUtils.isSameDay(k,v))},captionElement:()=>null})})]})});J.propTypes={value:i.oneOfType([i.string,i.object]),fromDate:i.any,toDate:i.any,onChange:i.func,resetDatePickerField:i.bool};J.defaultProps={fromDate:new Date(1900,0,1),toDate:new Date(2100,0,1)};const pi="-PJGT",hi={error:pi},X=({input:s,id:a,label:n,meta:t,hint:l,fromDate:o,toDate:d,resetDatePickerField:r})=>{const c=$e(t),y=g.useRef();return e.jsxs("div",{ref:y,children:[e.jsxs("div",{children:[n?e.jsx(je,{htmlFor:a,hint:l,children:n}):null,e.jsx(J,{value:s.value,resetDatePickerField:r,onChange:S=>s.onChange(S.map(h=>x(h).format("MM/DD/YYYY"))),fromDate:o,toDate:d})]}),!!c&&e.jsx("span",{id:`${a}_errormsg`,className:hi.error,children:c})]})};X.propTypes={input:i.object,id:i.string,label:i.string,meta:i.object,hint:i.oneOfType([i.string,i.object]),fromDate:i.instanceOf(Date),toDate:i.instanceOf(Date),resetDatePickerField:i.bool};X.defaultProps={fromDate:new Date(1900,0,1),toDate:new Date(2100,0,1),meta:{},input:{}};const de="1970/01/01",Ni="1970/01/02",fi=6e4,re=s=>{const a=s?.start_time??"00:00",n=s?.skipFirstSlot??!1;let t=0,l=new Date(`${de} ${a}`),o;s?.end_time?o=new Date(`${de} ${s?.end_time}`):o=new Date(`${Ni} 00:00`);const d=[{label:"",value:""}];for(;l<o;){const r=l.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}).replace(" ",""),c=l.toTimeString().substring(0,5);n&&t===0||d.push({label:r,value:c}),t++,l=new Date(l.getTime()+ue*fi)}return d},Si="-UAnP",_i="sTCO4",ji="MceKf",xi="AQ0Jd",Di="HQo-i",Ti="-Gq9V",T={container:Si,title:_i,none:ji,day:xi,date:Di,slot:Ti},ye=({onAvailabilityRemoved:s,listing:a,loading:n})=>{const[t,{loading:l}]=Je(),[o,d]=g.useState(),r=a?.zip_tz||me,c=a?.showing_availability?.showing_availability_slots,y=c?.length,S=async u=>{try{d(u),await t({variables:{id:u,listing_id:a.id,availability_id:a?.showing_availability?.id}}),z("Availability Deleted"),s(a.id)}catch{E("An error has occurred")}finally{d(null)}},h=g.useMemo(()=>c?.reduce((u,N)=>{const b=x(N.start_at).tz(r).format("YYYY-MM-DD");return u[b]=u[b]||[],u[b].push(N),u},{}),[c]);return e.jsxs("div",{className:T.container,children:[e.jsx(O,{className:T.title,children:"Upcoming availability"}),e.jsxs("div",{className:T.times,children:[n&&e.jsx(F,{type:"secondary",variant:"ghost",loading:n}),!n&&y&&Object.entries(h).map(([u,N])=>e.jsxs("div",{className:T.day,children:[e.jsx("span",{className:T.date,children:x(u).format("dddd MMM D, YYYY")}),N.map(b=>e.jsxs("div",{className:T.slot,children:[e.jsx("div",{children:Ee(b,r)}),e.jsx(F,{iconProps:{className:T.deleteIcon},icon:"delete",variant:"ghost",disabled:l&&b.id===o,onClick:()=>S(b.id)})]},b.id))]},u)),!n&&!y&&e.jsx(O,{className:T.none,children:"None added"})]})]})};ye.propTypes={onAvailabilityRemoved:i.func.isRequired,listing:i.object,loading:i.bool};const Fi="_8FSZe",Ai="-S6wb",wi="WFyTE",$i="niY9y",Ri="suAUl",Mi="rCcRE",Oi="_1BDht",Vi="_95f5L",Ci="bG1Io",Yi="lyRyb",Ei="wwq6k",qi="_5ZEam",Ii="sChIE",Hi="XiNNj",Pi="_0dBX4",Li="_1WkhZ",Bi="HziMr",Ui="_1xgGZ",m={modalHeader:Fi,listingAddress:Ai,title:wi,description:$i,form:Ri,content:Mi,scheduleHolder:Oi,dateTimeWrapper:Vi,timeRangeWrapper:Ci,timeRange:Yi,field:Ei,selectField:qi,errorInput:Ii,errorMessage:Hi,saveButton:Pi,addAnotherTimeButton:Li,nextButton:Bi,modalFooter:Ui},pe=({onSubmit:s,onNext:a,isOverlappedAvailabilityTime:n,setIsOverlappedAvailabilityTime:t,listingAddress:l,listing:o,getAndSetListingData:d,hideInstructionsSteps:r,loading:c})=>{const y=Re(),[S,h]=g.useState(!y),[u,N]=g.useState(!1),b=o?.showing_availability?.showing_availability_slots?.length;return g.useEffect(()=>{u&&N(!1)},[u]),e.jsxs(e.Fragment,{children:[e.jsx(j.Header,{className:m.modalHeader,children:e.jsx(ce,{className:m.listingAddress,children:l})}),e.jsx(Q,{onSubmit:s,subscription:{submitting:!0,values:!0},children:({handleSubmit:v,form:k,submitting:p,values:f})=>e.jsxs("form",{onSubmit:async $=>{await v($)&&(k.restart(),N(!0),y&&h(!1))},className:m.form,children:[e.jsxs(j.Content,{className:m.content,children:[e.jsx(xe,{className:m.title,children:"When are you available?"}),e.jsxs(O,{className:m.description,children:["Renters can book in"," ",e.jsxs("strong",{children:[ue," minute time slots"]}),", up to 4 hours before, within the added ranges. You can select and add multiple dates at once."]}),e.jsxs("div",{className:m.scheduleHolder,children:[S?e.jsxs("div",{className:m.dateTimeWrapper,children:[e.jsx(Y,{component:X,fromDate:x().toDate(),name:"date",id:"date",validate:Me(Oe),resetDatePickerField:u}),e.jsx(L,{name:"date",children:()=>t(!1)}),e.jsxs("div",{className:m.timeRangeWrapper,children:[e.jsxs("div",{className:m.timeRange,children:[e.jsx(Y,{component:se,className:m.field,selectClassName:q(m.selectField,{[m.errorInput]:n}),label:"Start Time",name:"start_time",id:"start_time",options:re(),validate:ae}),e.jsx(L,{name:"start_time",children:()=>{t(!1)}}),e.jsx(Y,{component:se,className:m.field,selectClassName:q(m.selectField,{[m.errorInput]:n}),label:"End Time",options:re({start_time:f.start_time,skipFirstSlot:!0}),name:"end_time",id:"end_time",validate:ae}),e.jsx(L,{name:"end_time",children:()=>{t(!1)}})]}),n&&e.jsx(O,{color:"danger",weight:"semi",className:m.errorMessage,children:"Cannot overlap with existing availability"}),e.jsx(F,{className:m.saveButton,small:!0,type:"outline",loading:p,disabled:n,id:"add_time_range",htmlType:"submit",children:"Save"})]})]}):e.jsx(F,{icon:"plus",type:"secondary",onClick:()=>h(!0),className:m.addAnotherTimeButton,children:"Add Another Time Range"}),e.jsx(ye,{onAvailabilityRemoved:d,listing:o,loading:c})]})]}),e.jsx(j.Footer,{className:m.modalFooter,children:e.jsx(F,{className:m.nextButton,disabled:p||!b,onClick:a,children:r?"Done":"Continue"})})]})})]})};pe.propTypes={onSubmit:i.func.isRequired,onNext:i.func.isRequired,isOverlappedAvailabilityTime:i.bool.isRequired,setIsOverlappedAvailabilityTime:i.func.isRequired,listingAddress:i.string,listing:i.object,getAndSetListingData:i.func.isRequired,hideInstructionsSteps:i.bool,loading:i.bool};const zi="d-ZuT",Wi={container:zi},Gi=({open:s,onClose:a,onDone:n,className:t,listing:l,listings:o,leadDataAndShowModal:d,setLeadDataAndShowModal:r,hideInstructionsSteps:c,onSelectProperty:y})=>{const S=!!l?.id,h=Ve(),[u]=Qe(),[N]=Ze(),[b,{loading:v}]=Ce(He),[k,p]=g.useState(S?1:0),[f,$]=g.useState(l||{}),[K,I]=g.useState(!1),ee=f?.showing_availability,he=ee?.instructions,ie=f?.zip_tz||me,te=qe(f),H=()=>{k===1&&c||k===2?(n(),p(0)):p(k+1)},ne=()=>{a(),p(S?1:0),I(!1)},P=async(D,A={})=>{try{const V=await b({variables:{listingId:D},skip:!D,fetchPolicy:"network-only"});let M;const w={showing_availability:V?.data?.getShowingAvailabilityForListing||{}};d&&(d.length>1?r(d.map(C=>({...C,listing:{...C.listing,...w}}))):r({...d,listing:{...d.listing,...w}})),M=Ye(A)?{...f,...w}:{...A,...w},$({...M})}catch{E("An error has occurred")}},Ne=async D=>{try{const A=D.date.map(V=>{const M=`${V} ${D.start_time}`,w=`${V} ${D.end_time}`,C=x(M,"MM/DD/YYYY HH:mm"),Se=x(w,"MM/DD/YYYY HH:mm");return{start_at:C.isValid()?x.tz(M,"MM/DD/YYYY HH:mm",ie):null,end_at:Se.isValid()?x.tz(w,"MM/DD/YYYY HH:mm",ie):null}});return await u({variables:{availability_type:Pe.APPOINTMENT,listing_id:f?.id,hours:A}}),await P(f?.id),z("Time range added"),!0}catch(A){if(A.message==="Invalid Date Range: Overlapping slots are not allowed.")return I(!0);E(A.message||"An error has occurred")}},fe=async D=>{try{await N({variables:{listing_id:f?.id,availability_id:ee?.id,instructions:D.instructions}}),H(),z("Instructions saved")}catch{E("An error has occurred")}};return g.useEffect(()=>{l?.id&&!y&&p(1),l&&$(l)},[l?.id,y]),e.jsxs(j,{isOpen:s,onClose:ne,className:q(Wi.container,t),size:k===1?"xl":"sm",fullOnMobile:h,isDismissible:!h,children:[k===0&&(!l?.id||y)&&e.jsx(be,{onClose:ne,getAndSetListingData:P,onNext:H,listings:o||[],onSelectProperty:y}),k===1&&e.jsx(pe,{onSubmit:Ne,onNext:H,getAndSetListingData:P,isOverlappedAvailabilityTime:K,setIsOverlappedAvailabilityTime:I,listingAddress:te,listing:f,hideInstructionsSteps:c,loading:v}),!c&&k===2&&e.jsx(ve,{instructions:he,onSubmit:fe,listingAddress:te})]})};Gi.propTypes={open:i.bool.isRequired,onClose:i.func.isRequired,onDone:i.func,className:i.string,listing:i.object,listings:i.array,leadDataAndShowModal:i.object,setLeadDataAndShowModal:i.func,hideInstructionsSteps:i.bool,onSelectProperty:i.func};export{Gi as S,Je as a,qe as f,Ze as u};
//# sourceMappingURL=SetAvailabilityModal-BDud7sew.js.map
