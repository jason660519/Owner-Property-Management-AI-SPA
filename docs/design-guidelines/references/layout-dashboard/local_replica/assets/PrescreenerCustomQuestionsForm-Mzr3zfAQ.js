import{u as Z,G as Y,v as C,j as e,k as I,a5 as x,P as n,r as g,a4 as K,F as X,s as L}from"./TownhouseColor--VjQBVqd.js";import{Z as B,aP as ee,bz as ie,n as ne,l as te,o as se,aJ as M,ba as U,b1 as oe,b0 as W,ht as G}from"./main-dumNSXg9.js";import{_ as T}from"./getCustomPreScreenerQuestions-q6Ha4UZW.js";import{i as ae}from"./isLengthBetweenWithLimits-BGyQWJds.js";const re=`mutation createPrescreenerQuestionMutation($question: String!) {
  createPrescreenerQuestion(input: { question: $question }) {
    question {
      id
      question
    }
  }
}
`,le={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"createPrescreenerQuestionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"question"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createPrescreenerQuestion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"question"},value:{kind:"Variable",name:{kind:"Name",value:"question"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"question"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"question"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:216,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:re}}},de=`mutation deletePrescreenerQuestionMutation($id: String!) {
  deletePrescreenerQuestion(input: { id: $id }) {
    question {
      id
    }
  }
}
`,ue={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"deletePrescreenerQuestionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deletePrescreenerQuestion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"question"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:183,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:de}}},ce=`mutation updatePrescreenerQuestionMutation($question: String!, $id: String!) {
  updatePrescreenerQuestion(input: { question: $question, id: $id }) {
    question {
      id
      question
    }
  }
}
`,me={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updatePrescreenerQuestionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"question"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updatePrescreenerQuestion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"question"},value:{kind:"Variable",name:{kind:"Name",value:"question"}}},{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"question"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"question"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:239,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:ce}}},ze=()=>{const i=B(),{data:s,loading:l}=Z(T),d=Y(s,"customPreScreenerQuestions",[]),o=t=>{const r=t.readQuery({query:T});return JSON.parse(JSON.stringify(r))},N=(t,r)=>{t.writeQuery({query:T,data:r})},[u]=C(le),S=t=>{u({variables:{question:t.question},update:(r,{data:p})=>{const f=p.createPrescreenerQuestion.question,h=o(r);h.customPreScreenerQuestions.push(f),N(r,h)},optimisticResponse:{createPrescreenerQuestion:{question:{id:btoa("CustomPrescreenerQuestion:"+Math.random()),question:t.question}}}}).catch(()=>{i("Unable to add question")})},[c]=C(ue),m=t=>{c({variables:{id:t},update:r=>{const p=o(r);p.customPreScreenerQuestions=p.customPreScreenerQuestions.filter(f=>f.id!==t),N(r,p)},optimisticResponse:{deletePrescreenerQuestion:{question:{id:t}}}}).catch(()=>{i("Unable to delete question")})},[k]=C(me);return{customQuestions:d,addQuestion:S,removeQuestion:m,editQuestion:async({id:t,question:r})=>{await k({variables:{id:t,question:r},update:p=>{const f=o(p),h=f.customPreScreenerQuestions.findIndex(Q=>Q.id===t);f.customPreScreenerQuestions[h]={...f.customPreScreenerQuestions[h],...r},N(p,f)},optimisticResponse:{updatePrescreenerQuestion:{question:{id:t,...r}}}}).catch(()=>{i("Unable to update question")})},loadingQuestions:l}},ke="iZMK1",ve="_2URWY",ge="ZN-DB",pe="uTgQ8",fe="f871N",Ne="pu7E2",he="H1zL7",Se="-xwPS",be="SXVoQ",w={errorModal:ke,content:ve,icon:ge,iconWrapper:pe,title:fe,reason:Ne,btnWrap:he,disclaimer:Se,btn:be},D=({open:i,onEdit:s,onSave:l,className:d,reason:o})=>e.jsx(ee,{className:I(w.errorModal,d),open:i,onClose:l,disableOutsideClick:!0,children:e.jsxs("div",{className:w.content,children:[e.jsx("div",{className:w.iconWrapper,children:e.jsx(ie,{className:w.icon,halfFillColor:"#FF9250"})}),e.jsx("h1",{className:w.title,children:"Fair Housing Violation"}),e.jsx("p",{className:w.reason,children:o||"This question potentially violates the Fair Housing Act (FHA)."}),e.jsx("p",{className:w.disclaimer,children:"DISCLAIMER: TurboTenant is not responsible for questions that may violate the FHA. We encourage you to review local laws for the latest info."}),e.jsxs("div",{className:w.btnWrap,children:[e.jsx(x,{secondary:!0,className:w.btn,onClick:l,children:"Save Question"}),e.jsx(x,{className:w.btn,onClick:s,children:"Edit Question"})]})]})});D.propTypes={onSave:n.func,onEdit:n.func,open:n.bool.isRequired,className:n.string,reason:n.string};const j=(i="")=>{if(!i||typeof i!="string")return!1;const s=["Credit","CC","Debit","Card","Account","Bank","Routing","Social security","Social","SSN","Password","User name","Username","Bank login","id.me","id"];for(const l of s)if(new RegExp(`\\b${l.toLowerCase()}\\b`).test(i.toLowerCase()))return!0;return!1},qe=`mutation checkFairHousingViolation($question: String!) {
  checkFairHousingViolation(input: { question: $question }) {
    ok
    isValid
    reason
  }
}
`,we={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"checkFairHousingViolation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"question"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"checkFairHousingViolation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"question"},value:{kind:"Variable",name:{kind:"Name",value:"question"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ok"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isValid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reason"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:193,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:qe}}},$=()=>{const[i,s]=g.useState(null),[l]=C(we);return{showFairHousingRulesViolationModalData:i,setShowFairHousingRulesViolationModalData:s,checkIsQuestionViolatingFairHousingRules:async o=>{const u=(await l({variables:{question:o}})).data.checkFairHousingViolation;if(u.ok&&!u.isValid)return s({data:{question:o},reason:u.reason}),!0}}},ye="IAJ0k",Qe="MTUop",Fe="aYxdZ",xe="gxT5p",Re="_0AExh",je="_2U0Tz",Ve="m6Fz5",Ae="_3J4qj",Ce="aoedv",De="_6hicJ",y={form:ye,fieldHolder:Qe,field:Fe,textarea:xe,errorText:Re,remove:je,removeIcon:Ve,saveHolder:Ae,save:Ce,saveAddNew:De},A=255,V=({onSubmit:i,onDelete:s,initialValues:l,currentIndex:d,openAddNew:o,disableAddNew:N,deleteLoading:u,onSaveClicked:S})=>{const c=(m="")=>{const k=m.length>A;return e.jsxs("span",{className:I({[y.errorText]:k}),children:[m.length," / ",A," characters used",k&&` | ${A} maximum`]})};return e.jsx("div",{className:y.form,children:e.jsx(K,{onSubmit:i,initialValues:l,subscription:{values:!0,submitting:!0},children:({handleSubmit:m,invalid:k,submitting:b,values:t})=>e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:y.fieldHolder,children:[e.jsx(X,{validate:te(se,ae(0,A)),name:"question",className:y.field,component:ne,label:`Custom Question ${d}`,inputProps:{className:y.textarea},id:`custom-question-${d}`,as:"textarea",help:c,placeholder:""}),e.jsx(M,{className:y.remove,icon:U,iconProps:{className:y.removeIcon},loading:u,onClick:s})]}),e.jsxs("div",{className:y.saveHolder,children:[e.jsx(x,{disabled:k,secondary:!0,className:y.save,type:"submit",loading:b,onClick:S,children:"Save"}),!N&&e.jsx(x,{disabled:k,secondary:!0,className:y.saveAddNew,onClick:()=>o(t.question),type:"submit",loading:b,children:"Save & add another"})]})]})})})};V.propTypes={onSubmit:n.func.isRequired,onDelete:n.func.isRequired,initialValues:n.object,currentIndex:n.number.isRequired,openAddNew:n.func.isRequired,disableAddNew:n.bool,deleteLoading:n.bool,onSaveClicked:n.func};V.defaultProps={initialValues:{},disableAddNew:!1,deleteLoading:!1,onSaveClicked:()=>{}};const He="bchSm",Pe="JGApD",Te="x-lx0",_e="r5ZQN",Me="I3jjW",F={questionHolder:He,questionActions:Pe,questionLabel:Te,delete:"DdzzS",editIcon:_e,questionText:Me},H=({question:i,editQuestion:s,removeQuestion:l,currentIndex:d,openAddNew:o,disableAddNew:N,onSensitiveQuestion:u,onSaveClicked:S})=>{const[c,m]=g.useState(!1),[k,b]=g.useState(!1),{showFairHousingRulesViolationModalData:t,setShowFairHousingRulesViolationModalData:r,checkIsQuestionViolatingFairHousingRules:p}=$(),f=B(),h=g.useCallback(async()=>{try{b(!0),await l(i.id)}catch{f("Something went wrong please try again")}finally{m(!1),b(!1)}},[i.id,l]),Q=g.useCallback(async a=>{try{await s({id:i.id,question:a.question})}catch{f("Something went wrong please try again")}finally{m(!1)}},[i.id,s]);return c?e.jsxs(e.Fragment,{children:[e.jsx(V,{onSubmit:async(a,q,v)=>{if(j(a.question))return u(!0),v();await p(a.question)||Q(a)},onSaveClicked:S,onDelete:h,deleteLoading:k,initialValues:{question:i.question},currentIndex:d,openAddNew:o,disableAddNew:N}),!!t&&e.jsx(D,{open:!0,reason:t.reason,onSave:()=>{Q(t.data),r(null)},onEdit:()=>r(null)})]}):e.jsxs("div",{className:F.questionHolder,children:[e.jsxs("div",{className:F.questionActions,children:[e.jsxs("span",{className:F.questionLabel,children:["Custom Question ",d]}),e.jsx(M,{icon:oe,iconProps:{className:F.editIcon},onClick:()=>m(!0)}),e.jsx(M,{className:F.delete,icon:U,loading:k,onClick:h})]}),e.jsx("p",{className:F.questionText,children:i.question})]})};H.propTypes={question:n.shape({id:n.number.isRequired,question:n.string.isRequired}).isRequired,editQuestion:n.func.isRequired,removeQuestion:n.func.isRequired,currentIndex:n.number.isRequired,openAddNew:n.func.isRequired,disableAddNew:n.bool.isRequired,onSensitiveQuestion:n.func.isRequired,onSaveClicked:n.func};H.defaultProps={onSaveClicked:()=>{}};const $e="-DFD1",Oe={addNew:$e},O=4,J=({customQuestions:i,onSubmit:s,addNewByDefault:l})=>{const[d,o]=g.useState(!1),[N,u]=g.useState(!1),{showFairHousingRulesViolationModalData:S,setShowFairHousingRulesViolationModalData:c,checkIsQuestionViolatingFairHousingRules:m}=$();g.useEffect(()=>{N&&L("sensitive_info_custom_question_error",{location:"Custom Application Questions - Settings"})},[N]),g.useEffect(()=>{i.length===0&&l?o(!0):o(!1)},[i.length]);const k=d?1:0,b=i.length+k>=O,t=i.length>=O,r=a=>{j(a)||setTimeout(()=>{o(!0)})};let p=1;const f=g.useCallback(async({id:a,question:q})=>{await s(i.map((v,R)=>R===a?q:v))},[i,s]),h=g.useCallback(async({question:a})=>{await s([...i,a])},[i,s]),Q=g.useCallback(async a=>{await s(i.filter((q,v)=>v!==a))},[i,s]);return e.jsxs(e.Fragment,{children:[i.map((a,q)=>e.jsx(H,{editQuestion:f,removeQuestion:Q,question:{question:a,id:q},disableAddNew:!0,currentIndex:p++,openAddNew:r,onSensitiveQuestion:u},q)),!t&&e.jsxs(e.Fragment,{children:[d&&e.jsx(V,{onSubmit:async(a,q,v)=>{if(j(a.question))return u(!0),v();await m(a.question)||(h(a),o(!1))},openAddNew:r,disableAddNew:!0,currentIndex:p,onDelete:()=>o(!1)}),!b&&!d&&e.jsx(x,{className:Oe.addNew,icon:W,iconProps:{width:15,height:15},onClick:()=>o(!0),tertiary:!0,children:"Add Question"})]}),N&&e.jsx(G,{open:!0,title:"Question Not Allowed",description:"You seem to be asking for sensitive information. To protect you and renters, we do not allow custom questions like that.",buttonLabel:"Okay, got it",onClose:()=>u(!1)}),!!S&&e.jsx(D,{open:!0,reason:S.reason,onSave:()=>{o(!1),h(S.data),c(null)},onEdit:()=>c(null)})]})};J.propTypes={customQuestions:n.arrayOf(n.string.isRequired),onSubmit:n.func.isRequired,addNewByDefault:n.bool};J.defaultProps={customQuestions:[]};const Ee="gewj3",Ie="lCDNp",E={container:Ee,addNew:Ie},_=4,z=({customQuestions:i,addQuestion:s,editQuestion:l,removeQuestion:d,disableSaveAndAddNewByDefault:o,addNewByDefault:N,onSaveClicked:u})=>{const[S,c]=g.useState(!1),[m,k]=g.useState(!1);g.useEffect(()=>{i.length===0&&N?c(!0):c(!1)},[i.length]);const{showFairHousingRulesViolationModalData:b,setShowFairHousingRulesViolationModalData:t,checkIsQuestionViolatingFairHousingRules:r}=$();g.useEffect(()=>{m&&L("sensitive_info_custom_question_error",{location:"Custom Pre-screener Questions - Settings"})},[m]);const p=S?1:0,f=i.length+p>=_,h=i.length>=_,Q=i.length>=_-1||o,a=v=>{j(v)||setTimeout(()=>{c(!0)})};let q=1;return e.jsxs("div",{className:E.container,children:[i.map(v=>e.jsx(H,{editQuestion:l,removeQuestion:d,question:v,disableAddNew:f,currentIndex:q++,openAddNew:a,onSensitiveQuestion:k,onSaveClicked:u},v.id)),!h&&(S?e.jsx(V,{onSubmit:async(v,R,P)=>{if(j(v.question))return k(!0),P();await r(v.question)||(c(!1),s(v))},onSaveClicked:u,openAddNew:a,disableAddNew:Q,currentIndex:q,onDelete:()=>c(!1)}):e.jsx(x,{icon:W,iconProps:{width:15,height:15},onClick:()=>c(!0),className:E.addNew,tertiary:!0,children:"Add Question"})),m&&e.jsx(G,{open:!0,title:"Question Not Allowed",description:"You seem to be asking for sensitive information. To protect you and renters, we do not allow custom questions like that.",buttonLabel:"Okay, got it",onClose:()=>k(!1)}),!!b&&e.jsx(D,{open:!0,reason:b.reason,onSave:()=>{c(!1),s(b.data),t(null)},onEdit:()=>t(null)})]})};z.defaultProps={customQuestions:[],addQuestion:()=>{},editQuestion:()=>{},removeQuestion:()=>{},onSaveClicked:()=>{},disableSaveAndAddNewByDefault:!1,addNewByDefault:!1};z.propTypes={customQuestions:n.array,addQuestion:n.func,editQuestion:n.func,removeQuestion:n.func,disableSaveAndAddNewByDefault:n.bool,onSaveClicked:n.func,addNewByDefault:n.bool};export{J as C,z as P,ze as u};
//# sourceMappingURL=PrescreenerCustomQuestionsForm-Mzr3zfAQ.js.map
